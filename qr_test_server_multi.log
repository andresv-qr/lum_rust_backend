nohup: ignoring input
[2m2025-10-05T01:26:54.717660Z[0m [32m INFO[0m [2mlum_rust_ws::monitoring[0m[2m:[0m ðŸ” Monitoring system initialized
[2m2025-10-05T01:26:54.717693Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m ðŸ” Monitoring system initialized
[2m2025-10-05T01:26:54.717701Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m ðŸ”§ Creating optimized database pool with 50 max connections
[2m2025-10-05T01:26:54.854270Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m âœ… Database pool created successfully
[2m2025-10-05T01:26:54.854318Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m ðŸ”§ Creating optimized Redis client
[2m2025-10-05T01:26:54.854353Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m âœ… Redis client created successfully
[2m2025-10-05T01:26:54.904690Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::service[0m[2m:[0m ðŸš€ Initializing optimized hybrid QR service (2-level cascade)
[2m2025-10-05T01:26:54.904728Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::service[0m[2m:[0m ðŸ“Š Expected performance: 85% success with Rust (5-15ms), 12% with Python fallback (30-50ms)
[2m2025-10-05T01:26:54.904750Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ðŸš€ Initializing PerformanceManager with advanced configuration
[2m2025-10-05T01:26:54.904755Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ðŸ“Š QR Detection: 50 max concurrent
[2m2025-10-05T01:26:54.904759Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ðŸ“Š OCR Processing: 20 max concurrent
[2m2025-10-05T01:26:54.904763Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ðŸ“Š Webhook Processing: 100 max concurrent
[2m2025-10-05T01:26:54.904767Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ðŸ“Š API Requests: 200 max concurrent
[2m2025-10-05T01:26:54.904805Z[0m [32m INFO[0m [2mlum_rust_ws::webhook::deduplication[0m[2m:[0m ðŸ”„ MessageDeduplicator initialized with TTL: 300s, max_entries: 10000
[2m2025-10-05T01:26:54.904812Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ðŸ”¥ Starting performance warm-up process...
[2m2025-10-05T01:26:54.906013Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m âœ… Database connection verified
[2m2025-10-05T01:26:54.906333Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m âœ… Redis connection verified
[2m2025-10-05T01:26:54.906383Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ðŸ”¥ Performance warm-up completed
[2m2025-10-05T01:26:54.906392Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m ðŸš€ Application state initialized with optimized configuration
[2m2025-10-05T01:26:54.907406Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m listening on 0.0.0.0:8000
[2m2025-10-05T01:27:04.975342Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0muser1@example.com
[2m2025-10-05T01:27:04.976423Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ” Starting OPTIMIZED QR detection (Phase 1 & 2)
[2m2025-10-05T01:27:04.976450Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 1: Equalization + Otsu
[2m2025-10-05T01:27:05.007426Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 1280x1280
[2m2025-10-05T01:27:05.010909Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-05T01:27:05.050106Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… rxing SUCCESS with equalization+otsu in 73ms
[2m2025-10-05T01:27:05.050184Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detected: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR in 73ms via Preprocessed decoders [3mrequest_id[0m[2m=[0m566d2d4f-a17c-4cf8-8732-db7c5657e705 [3mdecoder[0m[2m=[0mrxing [3mlevel[0m[2m=[0m1 [3mtime_ms[0m[2m=[0m73
[2m2025-10-05T01:27:05.050211Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detection successful [3mrequest_id[0m[2m=[0m566d2d4f-a17c-4cf8-8732-db7c5657e705 [3mlevel[0m[2m=[0mrxing [3mprocessing_time_ms[0m[2m=[0m74
[2m2025-10-05T01:27:05.155659Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0muser1@example.com
[2m2025-10-05T01:27:05.156240Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ” Starting OPTIMIZED QR detection (Phase 1 & 2)
[2m2025-10-05T01:27:05.156267Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 1: Equalization + Otsu
[2m2025-10-05T01:27:05.172221Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 720x1280
[2m2025-10-05T01:27:05.173820Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-05T01:27:05.199803Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 2: RAW grayscale (no preprocessing)
[2m2025-10-05T01:27:05.238701Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 3: Only Otsu binarization
[2m2025-10-05T01:27:05.272401Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 4: Only histogram equalization
[2m2025-10-05T01:27:05.312307Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âš ï¸ LEVEL 1 FAILED: All preprocessing strategies failed
[2m2025-10-05T01:27:05.324703Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 720x1280
[2m2025-10-05T01:27:05.327108Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-05T01:27:05.327137Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ”„ Attempting rotation correction (90Â°, 180Â°, 270Â°)
[2m2025-10-05T01:27:05.415843Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âš ï¸ LEVEL 2 FAILED: Rotation correction did not help
[2m2025-10-05T01:27:05.415891Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸŒ LEVEL 3: Starting Python/OpenCV fallback...
[2m2025-10-05T01:27:05.415898Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Fallback API - Input: 110054 bytes, format: JPEG
[2m2025-10-05T01:27:05.460439Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸŒ Fallback API - Sending request to http://localhost:8008/qr/hybrid-fallback
[2m2025-10-05T01:27:05.461286Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âŒ Fallback API - Connection error: error sending request for url (http://localhost:8008/qr/hybrid-fallback)
[2m2025-10-05T01:27:05.461311Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ’¡ Fallback API - Check if Python/OpenCV service is running on port 8008
[2m2025-10-05T01:27:05.461687Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âŒ ALL LEVELS FAILED: No QR code found after 305ms
[2m2025-10-05T01:27:05.461703Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m Python fallback error: Fallback API connection error: error sending request for url (http://localhost:8008/qr/hybrid-fallback)
[2m2025-10-05T01:27:05.461708Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ’¡ Suggestion: Ensure QR code is clearly visible, well-lit, and not damaged
[2m2025-10-05T01:27:05.461715Z[0m [31mERROR[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âŒ QR detection failed [3mrequest_id[0m[2m=[0mafcad050-4a84-4d9a-8790-633952a5ebac [3merror[0m[2m=[0mQR detection failed: No QR code detected after trying all strategies (preprocessed decoders, rotation, Python fallback) [3mprocessing_time_ms[0m[2m=[0m305
[2m2025-10-05T01:27:05.526210Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0muser1@example.com
[2m2025-10-05T01:27:05.526412Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ” Starting OPTIMIZED QR detection (Phase 1 & 2)
[2m2025-10-05T01:27:05.526425Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 1: Equalization + Otsu
[2m2025-10-05T01:27:05.540551Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 720x1280
[2m2025-10-05T01:27:05.542634Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-05T01:27:05.583334Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… rxing SUCCESS with equalization+otsu in 56ms
[2m2025-10-05T01:27:05.583457Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detected: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR in 56ms via Preprocessed decoders [3mrequest_id[0m[2m=[0mf0887bf6-012a-4424-b267-aac3d163e9e8 [3mdecoder[0m[2m=[0mrxing [3mlevel[0m[2m=[0m1 [3mtime_ms[0m[2m=[0m56
[2m2025-10-05T01:27:05.583512Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detection successful [3mrequest_id[0m[2m=[0mf0887bf6-012a-4424-b267-aac3d163e9e8 [3mlevel[0m[2m=[0mrxing [3mprocessing_time_ms[0m[2m=[0m57
[2m2025-10-05T01:27:05.690470Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0muser1@example.com
[2m2025-10-05T01:27:05.690656Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ” Starting OPTIMIZED QR detection (Phase 1 & 2)
[2m2025-10-05T01:27:05.690672Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 1: Equalization + Otsu
[2m2025-10-05T01:27:05.704612Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 1280x720
[2m2025-10-05T01:27:05.706427Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-05T01:27:05.730614Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 2: RAW grayscale (no preprocessing)
[2m2025-10-05T01:27:05.765231Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… rqrr SUCCESS with RAW grayscale in 74ms
[2m2025-10-05T01:27:05.765269Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detected: http://felink.panamapac.com.pa/checker/scanner?cuf in 74ms via Preprocessed decoders [3mrequest_id[0m[2m=[0ma1ada9df-a590-4d9f-ad0d-35cf2d8317a7 [3mdecoder[0m[2m=[0mrqrr [3mlevel[0m[2m=[0m1 [3mtime_ms[0m[2m=[0m74
[2m2025-10-05T01:27:05.765284Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detection successful [3mrequest_id[0m[2m=[0ma1ada9df-a590-4d9f-ad0d-35cf2d8317a7 [3mlevel[0m[2m=[0mrqrr [3mprocessing_time_ms[0m[2m=[0m74
[2m2025-10-05T01:27:05.868836Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0muser1@example.com
[2m2025-10-05T01:27:05.869061Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ” Starting OPTIMIZED QR detection (Phase 1 & 2)
[2m2025-10-05T01:27:05.869077Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 1: Equalization + Otsu
[2m2025-10-05T01:27:05.884123Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 720x1280
[2m2025-10-05T01:27:05.885654Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-05T01:27:05.931383Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 2: RAW grayscale (no preprocessing)
[2m2025-10-05T01:27:05.969894Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 3: Only Otsu binarization
[2m2025-10-05T01:27:06.007841Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 4: Only histogram equalization
[2m2025-10-05T01:27:06.055463Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âš ï¸ LEVEL 1 FAILED: All preprocessing strategies failed
[2m2025-10-05T01:27:06.069759Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 720x1280
[2m2025-10-05T01:27:06.071266Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-05T01:27:06.071290Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ”„ Attempting rotation correction (90Â°, 180Â°, 270Â°)
[2m2025-10-05T01:27:06.153886Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âš ï¸ LEVEL 2 FAILED: Rotation correction did not help
[2m2025-10-05T01:27:06.153927Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸŒ LEVEL 3: Starting Python/OpenCV fallback...
[2m2025-10-05T01:27:06.153933Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Fallback API - Input: 149287 bytes, format: JPEG
[2m2025-10-05T01:27:06.198690Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸŒ Fallback API - Sending request to http://localhost:8008/qr/hybrid-fallback
[2m2025-10-05T01:27:06.199470Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âŒ Fallback API - Connection error: error sending request for url (http://localhost:8008/qr/hybrid-fallback)
[2m2025-10-05T01:27:06.199501Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ’¡ Fallback API - Check if Python/OpenCV service is running on port 8008
[2m2025-10-05T01:27:06.199974Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âŒ ALL LEVELS FAILED: No QR code found after 330ms
[2m2025-10-05T01:27:06.199994Z[0m [33m WARN[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m Python fallback error: Fallback API connection error: error sending request for url (http://localhost:8008/qr/hybrid-fallback)
[2m2025-10-05T01:27:06.200005Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ’¡ Suggestion: Ensure QR code is clearly visible, well-lit, and not damaged
[2m2025-10-05T01:27:06.200015Z[0m [31mERROR[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âŒ QR detection failed [3mrequest_id[0m[2m=[0m374bb409-e9d0-412f-8a5a-86a53cb0eea9 [3merror[0m[2m=[0mQR detection failed: No QR code detected after trying all strategies (preprocessed decoders, rotation, Python fallback) [3mprocessing_time_ms[0m[2m=[0m331
[2m2025-10-05T01:52:42.922423Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T01:52:42.922526Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T01:52:42.924418Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T01:52:43.875185Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T01:52:43.875252Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T01:52:43.875291Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-05T01:52:43.877330Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-05T01:58:39.239929Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T01:58:39.239992Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T01:58:39.240035Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T01:58:39.240071Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T01:58:39.240088Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-05T01:58:39.241696Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T01:58:39.242401Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-05T01:58:42.376297Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T01:58:42.376368Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T01:58:42.377985Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T02:04:22.056716Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:22.056800Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:22.056819Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-05T02:04:22.056865Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:22.056913Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:04:22.058446Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T02:04:22.058938Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-05T02:04:38.722737Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:38.722821Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:04:38.724441Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T02:04:51.277749Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:51.437526Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:51.696087Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:51.696178Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m51ec021b-6d72-42bd-a5cb-8ef5386b1b9f
[2m2025-10-05T02:04:51.696190Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 51ec021b-6d72-42bd-a5cb-8ef5386b1b9f: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-05T02:04:51.696199Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 51ec021b-6d72-42bd-a5cb-8ef5386b1b9f: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:51.700481Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 51ec021b-6d72-42bd-a5cb-8ef5386b1b9f: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-05T02:04:51.962301Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:51.962384Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3478c51c-bda0-4bba-9654-d5f9abdf2393
[2m2025-10-05T02:04:51.962392Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3478c51c-bda0-4bba-9654-d5f9abdf2393: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-05T02:04:51.962402Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3478c51c-bda0-4bba-9654-d5f9abdf2393: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:51.965773Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3478c51c-bda0-4bba-9654-d5f9abdf2393: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-05T02:04:51.970585Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:51.970629Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mf62b9ed4-4e8e-4476-b5c8-6cee22b5a9aa
[2m2025-10-05T02:04:51.970636Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f62b9ed4-4e8e-4476-b5c8-6cee22b5a9aa: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-05T02:04:51.970644Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f62b9ed4-4e8e-4476-b5c8-6cee22b5a9aa: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:51.973403Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f62b9ed4-4e8e-4476-b5c8-6cee22b5a9aa: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-05T02:04:52.160299Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.160396Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5ecc1dfc-139e-431c-bdd3-179fd776993c
[2m2025-10-05T02:04:52.160404Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5ecc1dfc-139e-431c-bdd3-179fd776993c: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-05T02:04:52.160413Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5ecc1dfc-139e-431c-bdd3-179fd776993c: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:04:52.160421Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5ecc1dfc-139e-431c-bdd3-179fd776993c: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.162110Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.162204Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma903592c-226c-4389-982d-667df7e6bd00
[2m2025-10-05T02:04:52.162214Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a903592c-226c-4389-982d-667df7e6bd00: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-05T02:04:52.162220Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a903592c-226c-4389-982d-667df7e6bd00: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:04:52.162226Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a903592c-226c-4389-982d-667df7e6bd00: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.164177Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5ecc1dfc-139e-431c-bdd3-179fd776993c: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-05T02:04:52.164468Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.164529Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m80203399-3e2b-408d-922f-7fbf181a8425
[2m2025-10-05T02:04:52.164539Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 80203399-3e2b-408d-922f-7fbf181a8425: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-05T02:04:52.164550Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 80203399-3e2b-408d-922f-7fbf181a8425: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:04:52.164561Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 80203399-3e2b-408d-922f-7fbf181a8425: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.168345Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a903592c-226c-4389-982d-667df7e6bd00: Retrieved 0 invoice details (total: 0) in 6ms with enhanced pagination
[2m2025-10-05T02:04:52.168764Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 80203399-3e2b-408d-922f-7fbf181a8425: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-05T02:04:52.299294Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.441071Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.636461Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.636542Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6dc0efac-edb4-42f6-964b-0bd6152ec9b9
[2m2025-10-05T02:04:52.636553Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6dc0efac-edb4-42f6-964b-0bd6152ec9b9: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-05T02:04:52.636563Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6dc0efac-edb4-42f6-964b-0bd6152ec9b9: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.637189Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.637239Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m8a0feea1-edec-473f-8743-913b1297b0d9
[2m2025-10-05T02:04:52.637246Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8a0feea1-edec-473f-8743-913b1297b0d9: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-05T02:04:52.637258Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8a0feea1-edec-473f-8743-913b1297b0d9: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.639744Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6dc0efac-edb4-42f6-964b-0bd6152ec9b9: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-05T02:04:52.640172Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.640243Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mcd2fbd5a-06f5-4669-9705-cf62bdf98794
[2m2025-10-05T02:04:52.640251Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd2fbd5a-06f5-4669-9705-cf62bdf98794: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-05T02:04:52.640263Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd2fbd5a-06f5-4669-9705-cf62bdf98794: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.641067Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8a0feea1-edec-473f-8743-913b1297b0d9: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-05T02:04:52.642313Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd2fbd5a-06f5-4669-9705-cf62bdf98794: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-05T02:04:52.819521Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.819561Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.819601Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m8f198427-e4db-45e8-8449-2a98bdf46118
[2m2025-10-05T02:04:52.819620Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8f198427-e4db-45e8-8449-2a98bdf46118: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-05T02:04:52.819627Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8f198427-e4db-45e8-8449-2a98bdf46118: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:04:52.819634Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8f198427-e4db-45e8-8449-2a98bdf46118: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.819601Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mc5bf2da6-98f4-4d19-8912-c89b81764b7e
[2m2025-10-05T02:04:52.819810Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5bf2da6-98f4-4d19-8912-c89b81764b7e: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-05T02:04:52.819818Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5bf2da6-98f4-4d19-8912-c89b81764b7e: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:04:52.819824Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5bf2da6-98f4-4d19-8912-c89b81764b7e: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.821699Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8f198427-e4db-45e8-8449-2a98bdf46118: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-05T02:04:52.822859Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:04:52.822938Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m7611f836-aa09-488d-8a90-e558b442dd59
[2m2025-10-05T02:04:52.822949Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7611f836-aa09-488d-8a90-e558b442dd59: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-05T02:04:52.822955Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7611f836-aa09-488d-8a90-e558b442dd59: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:04:52.822961Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7611f836-aa09-488d-8a90-e558b442dd59: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:04:52.823792Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5bf2da6-98f4-4d19-8912-c89b81764b7e: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-05T02:04:52.825133Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7611f836-aa09-488d-8a90-e558b442dd59: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-05T02:05:10.450953Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m ðŸ” Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-05T02:05:10.451039Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸš€ Starting unified authentication [3mrequest_id[0m[2m=[0m6d2b0887-8288-4747-82b1-d9cd7775ccb0 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6IjE3ZjBmMGYxNGU5Y2FmYTlhYjUxODAxNTBhZTcxNGM5ZmQxYjVjMjYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1mNnBkNzBkMDkxYXRuZ2kxdXRuYnZ0OGxrdTdhMnB2Ni5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA2MDYzOTM2NDI0NDM3NjIxMDgwIiwiZW1haWwiOiJhbmRyZXNmZWxpcGV2YWxlbmNpYWdAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJBbmRyZXMgVmFsZW5jaWEiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSk9Xd083eUdDWVA1OHB4ZFZCd2R6MGJudWtITHdwcjk0RklVbGNEckxHYnVrYUFBPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6IkFuZHJlcyIsImZhbWlseV9uYW1lIjoiVmFsZW5jaWEiLCJpYXQiOjE3NTk2Mjk0NjksImV4cCI6MTc1OTYzMzA2OX0.jRvXbOrB4ztTnEVHG2X9EFxurkbcmRA4mnb5u9k4acVBw6WKnLLxalARVuapdXETRJbt-X0vhOotujBLUOMJ-2BmfcZtB0Vo5rjStaA5nZf8M7qm9_IcqmCAeEWccDyLz7ix7RDsVaVV9uEQ4dl_gkM-hsGvtNakkidYAktEucEnD9gkoI1VEW80jCipvRgzfnhiGI--NuJ9JVOSCLRLD_5cdHOwQRdIm6IpChj0Hrgx4AEBhgcAC1Hoejh5VeQqWvtfMJ6XOmib17_ffiCntJvrVg5z0FXP694XQxs3I1-CY4eCsK3kYqykHRupXr8l4rINrM5ZVQwb4p0VIKINcg", access_token: None }
[2m2025-10-05T02:05:10.451074Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ”‘ Google authentication
[2m2025-10-05T02:05:10.455939Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ“ Auth event logged to database [3mrequest_id[0m[2m=[0m6d2b0887-8288-4747-82b1-d9cd7775ccb0 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-05T02:05:10.456005Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ðŸ” Starting Google ID token validation [3mrequest_id[0m[2m=[0maf8848b8-b706-4623-9da8-d39882e0d514
[2m2025-10-05T02:05:10.456527Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m âœ… Google ID token validated successfully [3mrequest_id[0m[2m=[0maf8848b8-b706-4623-9da8-d39882e0d514 [3muser_id[0m[2m=[0m106063936424437621080 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mname[0m[2m=[0mSome("Andres Valencia") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-05T02:05:10.461101Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m ðŸ”‘ Generated access token successfully [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mexpires_at[0m[2m=[0m2025-10-06 02:05:10.461088036 UTC
[2m2025-10-05T02:05:10.465606Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ“ Auth event logged to database [3mrequest_id[0m[2m=[0m6d2b0887-8288-4747-82b1-d9cd7775ccb0 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-05T02:05:10.465639Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m âœ… Authentication successful [3mrequest_id[0m[2m=[0m6d2b0887-8288-4747-82b1-d9cd7775ccb0 [3mexecution_time_ms[0m[2m=[0m14
[2m2025-10-05T02:05:10.892557Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:10.892630Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3689c991-f67f-446f-8e56-592ecab2a188
[2m2025-10-05T02:05:10.892639Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3689c991-f67f-446f-8e56-592ecab2a188: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-05T02:05:10.892651Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3689c991-f67f-446f-8e56-592ecab2a188: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:10.901025Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3689c991-f67f-446f-8e56-592ecab2a188: Retrieved 50 invoice headers (total: 337) in 8ms with enhanced filtering
[2m2025-10-05T02:05:10.913892Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:10.913932Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc7d16dcf-5dfe-4c13-9fbe-9550d17157b5
[2m2025-10-05T02:05:10.913939Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c7d16dcf-5dfe-4c13-9fbe-9550d17157b5: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-05T02:05:10.913947Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c7d16dcf-5dfe-4c13-9fbe-9550d17157b5: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:10.918067Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c7d16dcf-5dfe-4c13-9fbe-9550d17157b5: Retrieved 50 invoice headers (total: 337) in 4ms with enhanced filtering
[2m2025-10-05T02:05:10.967770Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:10.967824Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:10.967838Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-05T02:05:10.968335Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-05T02:05:11.011519Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:11.011573Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:05:11.012018Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-05T02:05:11.889507Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:11.889600Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mf4f8c63b-be61-4dc3-9c8f-9a873b30cda1
[2m2025-10-05T02:05:11.889609Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f4f8c63b-be61-4dc3-9c8f-9a873b30cda1: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-05T02:05:11.889620Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f4f8c63b-be61-4dc3-9c8f-9a873b30cda1: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:11.904460Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f4f8c63b-be61-4dc3-9c8f-9a873b30cda1: Retrieved 50 invoice headers (total: 337) in 14ms with enhanced filtering
[2m2025-10-05T02:05:13.631063Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:13.645344Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:13.857475Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:13.858857Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:14.922137Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:14.922235Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m003be7ed-aac8-46a0-ac37-2de14426c12f
[2m2025-10-05T02:05:14.922244Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 003be7ed-aac8-46a0-ac37-2de14426c12f: Processing headers for user 1 with limit 50 offset 150
[2m2025-10-05T02:05:14.922273Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 003be7ed-aac8-46a0-ac37-2de14426c12f: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:14.922377Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:14.922463Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mff017c8b-a057-4af2-bcce-afeb6161235c
[2m2025-10-05T02:05:14.922475Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ff017c8b-a057-4af2-bcce-afeb6161235c: Processing headers for user 1 with limit 50 offset 250
[2m2025-10-05T02:05:14.922487Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ff017c8b-a057-4af2-bcce-afeb6161235c: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:14.923554Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:14.923629Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3e596759-7f34-4db2-8a18-87711e89fb44
[2m2025-10-05T02:05:14.923637Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3e596759-7f34-4db2-8a18-87711e89fb44: Processing headers for user 1 with limit 50 offset 200
[2m2025-10-05T02:05:14.923662Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3e596759-7f34-4db2-8a18-87711e89fb44: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:14.927348Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 003be7ed-aac8-46a0-ac37-2de14426c12f: Retrieved 50 invoice headers (total: 337) in 5ms with enhanced filtering
[2m2025-10-05T02:05:14.928423Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ff017c8b-a057-4af2-bcce-afeb6161235c: Retrieved 50 invoice headers (total: 337) in 5ms with enhanced filtering
[2m2025-10-05T02:05:14.929767Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3e596759-7f34-4db2-8a18-87711e89fb44: Retrieved 50 invoice headers (total: 337) in 6ms with enhanced filtering
[2m2025-10-05T02:05:15.342598Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:15.342682Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6a4d3425-5694-439f-be1d-78cf7b71ebeb
[2m2025-10-05T02:05:15.342691Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a4d3425-5694-439f-be1d-78cf7b71ebeb: Processing headers for user 1 with limit 50 offset 400
[2m2025-10-05T02:05:15.342702Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a4d3425-5694-439f-be1d-78cf7b71ebeb: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:15.342912Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:15.342969Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mb9f264ad-1dbb-4969-877e-aade55198ba0
[2m2025-10-05T02:05:15.342977Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b9f264ad-1dbb-4969-877e-aade55198ba0: Processing headers for user 1 with limit 50 offset 300
[2m2025-10-05T02:05:15.342988Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b9f264ad-1dbb-4969-877e-aade55198ba0: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:15.346257Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:15.346417Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m9de33435-f4a9-44a7-8e6d-e8e6be0909d8
[2m2025-10-05T02:05:15.346430Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9de33435-f4a9-44a7-8e6d-e8e6be0909d8: Processing headers for user 1 with limit 50 offset 350
[2m2025-10-05T02:05:15.346439Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9de33435-f4a9-44a7-8e6d-e8e6be0909d8: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:15.347559Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a4d3425-5694-439f-be1d-78cf7b71ebeb: Retrieved 0 invoice headers (total: 337) in 4ms with enhanced filtering
[2m2025-10-05T02:05:15.350449Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9de33435-f4a9-44a7-8e6d-e8e6be0909d8: Retrieved 0 invoice headers (total: 337) in 4ms with enhanced filtering
[2m2025-10-05T02:05:15.351960Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b9f264ad-1dbb-4969-877e-aade55198ba0: Retrieved 37 invoice headers (total: 337) in 8ms with enhanced filtering
[2m2025-10-05T02:05:15.888518Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:15.888591Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m1158183e-6eaf-4706-a2c2-c5f92268bd24
[2m2025-10-05T02:05:15.888600Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1158183e-6eaf-4706-a2c2-c5f92268bd24: Processing headers for user 1 with limit 50 offset 550
[2m2025-10-05T02:05:15.888611Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1158183e-6eaf-4706-a2c2-c5f92268bd24: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:15.888953Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:15.888997Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0me2f31fbd-738c-46b1-a5bb-82d80c92f5f6
[2m2025-10-05T02:05:15.889003Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e2f31fbd-738c-46b1-a5bb-82d80c92f5f6: Processing headers for user 1 with limit 50 offset 450
[2m2025-10-05T02:05:15.889011Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e2f31fbd-738c-46b1-a5bb-82d80c92f5f6: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:15.889834Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:15.889915Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc287eeb9-139a-4bee-bdcc-1c59ed1a76c8
[2m2025-10-05T02:05:15.889924Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c287eeb9-139a-4bee-bdcc-1c59ed1a76c8: Processing headers for user 1 with limit 50 offset 500
[2m2025-10-05T02:05:15.889934Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c287eeb9-139a-4bee-bdcc-1c59ed1a76c8: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:15.893297Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1158183e-6eaf-4706-a2c2-c5f92268bd24: Retrieved 0 invoice headers (total: 337) in 4ms with enhanced filtering
[2m2025-10-05T02:05:15.893862Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e2f31fbd-738c-46b1-a5bb-82d80c92f5f6: Retrieved 0 invoice headers (total: 337) in 4ms with enhanced filtering
[2m2025-10-05T02:05:15.894478Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c287eeb9-139a-4bee-bdcc-1c59ed1a76c8: Retrieved 0 invoice headers (total: 337) in 4ms with enhanced filtering
[2m2025-10-05T02:05:16.142515Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:16.142604Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb5ecd23f-f014-49cb-aa3f-c42c682ca0fb
[2m2025-10-05T02:05:16.142613Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b5ecd23f-f014-49cb-aa3f-c42c682ca0fb: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-05T02:05:16.142621Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b5ecd23f-f014-49cb-aa3f-c42c682ca0fb: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:16.142640Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b5ecd23f-f014-49cb-aa3f-c42c682ca0fb: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:16.142793Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:16.142842Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m69ca55bc-9b4b-4d79-92e6-f93751c6ff34
[2m2025-10-05T02:05:16.142849Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69ca55bc-9b4b-4d79-92e6-f93751c6ff34: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-05T02:05:16.142856Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69ca55bc-9b4b-4d79-92e6-f93751c6ff34: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:16.142862Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69ca55bc-9b4b-4d79-92e6-f93751c6ff34: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:16.143512Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:16.143550Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0meb3afd53-9f77-442b-8418-e9ac9382a335
[2m2025-10-05T02:05:16.143557Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eb3afd53-9f77-442b-8418-e9ac9382a335: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-05T02:05:16.143563Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eb3afd53-9f77-442b-8418-e9ac9382a335: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:16.143569Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eb3afd53-9f77-442b-8418-e9ac9382a335: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:16.151072Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eb3afd53-9f77-442b-8418-e9ac9382a335: Retrieved 100 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-05T02:05:16.152141Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b5ecd23f-f014-49cb-aa3f-c42c682ca0fb: Retrieved 100 invoice details (total: 2526) in 9ms with enhanced pagination
[2m2025-10-05T02:05:16.152886Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69ca55bc-9b4b-4d79-92e6-f93751c6ff34: Retrieved 100 invoice details (total: 2526) in 10ms with enhanced pagination
[2m2025-10-05T02:05:16.769502Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:16.769610Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m2668505e-d84e-456a-8d6f-9d83f0e77af1
[2m2025-10-05T02:05:16.769625Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2668505e-d84e-456a-8d6f-9d83f0e77af1: Processing for user 1 with limit 100 offset 400 order_by date direction DESC
[2m2025-10-05T02:05:16.769636Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2668505e-d84e-456a-8d6f-9d83f0e77af1: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:16.769644Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2668505e-d84e-456a-8d6f-9d83f0e77af1: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:16.771324Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:16.771378Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m10edce05-4c15-4635-859f-8d42f82c5438
[2m2025-10-05T02:05:16.771388Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10edce05-4c15-4635-859f-8d42f82c5438: Processing for user 1 with limit 100 offset 500 order_by date direction DESC
[2m2025-10-05T02:05:16.771395Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10edce05-4c15-4635-859f-8d42f82c5438: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:16.771403Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10edce05-4c15-4635-859f-8d42f82c5438: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:16.771495Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:16.771524Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mad264d6d-22bd-4c2a-846a-1bcca640c019
[2m2025-10-05T02:05:16.771532Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ad264d6d-22bd-4c2a-846a-1bcca640c019: Processing for user 1 with limit 100 offset 300 order_by date direction DESC
[2m2025-10-05T02:05:16.771539Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ad264d6d-22bd-4c2a-846a-1bcca640c019: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:16.771551Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ad264d6d-22bd-4c2a-846a-1bcca640c019: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:16.776127Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2668505e-d84e-456a-8d6f-9d83f0e77af1: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-05T02:05:16.777647Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ad264d6d-22bd-4c2a-846a-1bcca640c019: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-05T02:05:16.779211Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10edce05-4c15-4635-859f-8d42f82c5438: Retrieved 100 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-05T02:05:17.306630Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:17.306711Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m91884e0d-3915-40a7-8ef7-4ef2c1ee2701
[2m2025-10-05T02:05:17.306719Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91884e0d-3915-40a7-8ef7-4ef2c1ee2701: Processing for user 1 with limit 100 offset 700 order_by date direction DESC
[2m2025-10-05T02:05:17.306727Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91884e0d-3915-40a7-8ef7-4ef2c1ee2701: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:17.306736Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91884e0d-3915-40a7-8ef7-4ef2c1ee2701: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:17.308068Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:17.308113Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m86d4e461-68e8-4f15-828f-fa92f2dc2fe7
[2m2025-10-05T02:05:17.308120Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 86d4e461-68e8-4f15-828f-fa92f2dc2fe7: Processing for user 1 with limit 100 offset 600 order_by date direction DESC
[2m2025-10-05T02:05:17.308126Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 86d4e461-68e8-4f15-828f-fa92f2dc2fe7: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:17.308132Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 86d4e461-68e8-4f15-828f-fa92f2dc2fe7: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:17.308235Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:17.308324Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m15a5ca53-3abb-4f10-9356-679dbce1810a
[2m2025-10-05T02:05:17.308372Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 15a5ca53-3abb-4f10-9356-679dbce1810a: Processing for user 1 with limit 100 offset 800 order_by date direction DESC
[2m2025-10-05T02:05:17.308385Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 15a5ca53-3abb-4f10-9356-679dbce1810a: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:17.308398Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 15a5ca53-3abb-4f10-9356-679dbce1810a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:17.311297Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91884e0d-3915-40a7-8ef7-4ef2c1ee2701: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-05T02:05:17.311918Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 86d4e461-68e8-4f15-828f-fa92f2dc2fe7: Retrieved 100 invoice details (total: 2526) in 3ms with enhanced pagination
[2m2025-10-05T02:05:17.314713Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 15a5ca53-3abb-4f10-9356-679dbce1810a: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-05T02:05:18.060793Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:18.060896Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m84f2966a-5fb5-46cc-bfc1-0c64fb9220e5
[2m2025-10-05T02:05:18.060905Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 84f2966a-5fb5-46cc-bfc1-0c64fb9220e5: Processing for user 1 with limit 100 offset 1000 order_by date direction DESC
[2m2025-10-05T02:05:18.060913Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 84f2966a-5fb5-46cc-bfc1-0c64fb9220e5: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:18.060920Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 84f2966a-5fb5-46cc-bfc1-0c64fb9220e5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:18.061807Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:18.061906Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mec533908-c96a-4b44-b7c9-a65ebcf4da28
[2m2025-10-05T02:05:18.061938Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ec533908-c96a-4b44-b7c9-a65ebcf4da28: Processing for user 1 with limit 100 offset 900 order_by date direction DESC
[2m2025-10-05T02:05:18.061945Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ec533908-c96a-4b44-b7c9-a65ebcf4da28: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:18.061953Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ec533908-c96a-4b44-b7c9-a65ebcf4da28: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:18.065523Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 84f2966a-5fb5-46cc-bfc1-0c64fb9220e5: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-05T02:05:18.066456Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ec533908-c96a-4b44-b7c9-a65ebcf4da28: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-05T02:05:18.067888Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:18.067932Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0275b97b-8e34-4fce-b82a-933548877eea
[2m2025-10-05T02:05:18.067939Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0275b97b-8e34-4fce-b82a-933548877eea: Processing for user 1 with limit 100 offset 1100 order_by date direction DESC
[2m2025-10-05T02:05:18.067945Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0275b97b-8e34-4fce-b82a-933548877eea: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:18.067951Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0275b97b-8e34-4fce-b82a-933548877eea: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:18.071965Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0275b97b-8e34-4fce-b82a-933548877eea: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-05T02:05:19.052628Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:19.052728Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mc3a91680-b326-471f-b958-a14f32f1af61
[2m2025-10-05T02:05:19.052741Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c3a91680-b326-471f-b958-a14f32f1af61: Processing for user 1 with limit 100 offset 1400 order_by date direction DESC
[2m2025-10-05T02:05:19.052752Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c3a91680-b326-471f-b958-a14f32f1af61: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:19.052762Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c3a91680-b326-471f-b958-a14f32f1af61: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:19.053105Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:19.053210Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb786a952-5738-4a78-8525-701b18bbc0ca
[2m2025-10-05T02:05:19.053235Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b786a952-5738-4a78-8525-701b18bbc0ca: Processing for user 1 with limit 100 offset 1200 order_by date direction DESC
[2m2025-10-05T02:05:19.053248Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b786a952-5738-4a78-8525-701b18bbc0ca: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:19.053261Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b786a952-5738-4a78-8525-701b18bbc0ca: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:19.053720Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:19.053756Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m3666dc3c-0dbd-4aae-a185-780f35597f36
[2m2025-10-05T02:05:19.053762Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3666dc3c-0dbd-4aae-a185-780f35597f36: Processing for user 1 with limit 100 offset 1300 order_by date direction DESC
[2m2025-10-05T02:05:19.053768Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3666dc3c-0dbd-4aae-a185-780f35597f36: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:19.053774Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3666dc3c-0dbd-4aae-a185-780f35597f36: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:19.060464Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3666dc3c-0dbd-4aae-a185-780f35597f36: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-05T02:05:19.061284Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c3a91680-b326-471f-b958-a14f32f1af61: Retrieved 100 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-05T02:05:19.064294Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b786a952-5738-4a78-8525-701b18bbc0ca: Retrieved 100 invoice details (total: 2526) in 11ms with enhanced pagination
[2m2025-10-05T02:05:20.082220Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:20.082293Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m196b8a98-293a-4792-9c74-b388f59abc3a
[2m2025-10-05T02:05:20.082303Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 196b8a98-293a-4792-9c74-b388f59abc3a: Processing for user 1 with limit 100 offset 1500 order_by date direction DESC
[2m2025-10-05T02:05:20.082311Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 196b8a98-293a-4792-9c74-b388f59abc3a: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:20.082329Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 196b8a98-293a-4792-9c74-b388f59abc3a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:20.082431Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:20.082482Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m2cfbdc0e-c94b-4057-985e-b731708cd279
[2m2025-10-05T02:05:20.082490Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2cfbdc0e-c94b-4057-985e-b731708cd279: Processing for user 1 with limit 100 offset 1700 order_by date direction DESC
[2m2025-10-05T02:05:20.082497Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2cfbdc0e-c94b-4057-985e-b731708cd279: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:20.082504Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2cfbdc0e-c94b-4057-985e-b731708cd279: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:20.082603Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:20.082627Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf3ca100b-b8a1-401c-9dd1-f8be7f6de798
[2m2025-10-05T02:05:20.082633Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3ca100b-b8a1-401c-9dd1-f8be7f6de798: Processing for user 1 with limit 100 offset 1600 order_by date direction DESC
[2m2025-10-05T02:05:20.082639Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3ca100b-b8a1-401c-9dd1-f8be7f6de798: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:20.082645Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3ca100b-b8a1-401c-9dd1-f8be7f6de798: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:20.090354Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 196b8a98-293a-4792-9c74-b388f59abc3a: Retrieved 100 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-05T02:05:20.094410Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3ca100b-b8a1-401c-9dd1-f8be7f6de798: Retrieved 100 invoice details (total: 2526) in 11ms with enhanced pagination
[2m2025-10-05T02:05:20.095513Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2cfbdc0e-c94b-4057-985e-b731708cd279: Retrieved 100 invoice details (total: 2526) in 13ms with enhanced pagination
[2m2025-10-05T02:05:21.592325Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:21.592423Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma7dc8ded-6b5f-405b-9ab5-5adb9e6cb31c
[2m2025-10-05T02:05:21.592431Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a7dc8ded-6b5f-405b-9ab5-5adb9e6cb31c: Processing for user 1 with limit 100 offset 1800 order_by date direction DESC
[2m2025-10-05T02:05:21.592438Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a7dc8ded-6b5f-405b-9ab5-5adb9e6cb31c: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:21.592448Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a7dc8ded-6b5f-405b-9ab5-5adb9e6cb31c: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:21.592490Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:21.592551Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mc2d88a51-3d52-4eda-9ff2-8fb566ea10dc
[2m2025-10-05T02:05:21.592559Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2d88a51-3d52-4eda-9ff2-8fb566ea10dc: Processing for user 1 with limit 100 offset 2000 order_by date direction DESC
[2m2025-10-05T02:05:21.592567Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2d88a51-3d52-4eda-9ff2-8fb566ea10dc: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:21.592575Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2d88a51-3d52-4eda-9ff2-8fb566ea10dc: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:21.593105Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:21.593271Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m307acfbc-f0cb-4dcf-8d63-d2e8fd0d70cf
[2m2025-10-05T02:05:21.593449Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 307acfbc-f0cb-4dcf-8d63-d2e8fd0d70cf: Processing for user 1 with limit 100 offset 1900 order_by date direction DESC
[2m2025-10-05T02:05:21.593463Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 307acfbc-f0cb-4dcf-8d63-d2e8fd0d70cf: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:21.593471Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 307acfbc-f0cb-4dcf-8d63-d2e8fd0d70cf: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:21.599659Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a7dc8ded-6b5f-405b-9ab5-5adb9e6cb31c: Retrieved 100 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-05T02:05:21.601807Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 307acfbc-f0cb-4dcf-8d63-d2e8fd0d70cf: Retrieved 100 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-05T02:05:21.603775Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2d88a51-3d52-4eda-9ff2-8fb566ea10dc: Retrieved 100 invoice details (total: 2526) in 11ms with enhanced pagination
[2m2025-10-05T02:05:22.990359Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:22.990435Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m55a52694-2441-4ea5-802b-5c00b73fd93a
[2m2025-10-05T02:05:22.990445Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 55a52694-2441-4ea5-802b-5c00b73fd93a: Processing for user 1 with limit 100 offset 2200 order_by date direction DESC
[2m2025-10-05T02:05:22.990454Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 55a52694-2441-4ea5-802b-5c00b73fd93a: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:22.990462Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 55a52694-2441-4ea5-802b-5c00b73fd93a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:22.993220Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:22.993261Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mbd8ee109-3e93-42dd-9720-38df5bdfb000
[2m2025-10-05T02:05:22.993269Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd8ee109-3e93-42dd-9720-38df5bdfb000: Processing for user 1 with limit 100 offset 2100 order_by date direction DESC
[2m2025-10-05T02:05:22.993279Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd8ee109-3e93-42dd-9720-38df5bdfb000: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:22.993293Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd8ee109-3e93-42dd-9720-38df5bdfb000: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:22.993486Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:22.993513Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0md9304b7d-5a05-4264-898e-1359a6dbe41d
[2m2025-10-05T02:05:22.993531Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d9304b7d-5a05-4264-898e-1359a6dbe41d: Processing for user 1 with limit 100 offset 2300 order_by date direction DESC
[2m2025-10-05T02:05:22.993537Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d9304b7d-5a05-4264-898e-1359a6dbe41d: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:22.993544Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d9304b7d-5a05-4264-898e-1359a6dbe41d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:22.996026Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 55a52694-2441-4ea5-802b-5c00b73fd93a: Retrieved 100 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-05T02:05:23.002916Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d9304b7d-5a05-4264-898e-1359a6dbe41d: Retrieved 100 invoice details (total: 2526) in 9ms with enhanced pagination
[2m2025-10-05T02:05:23.004430Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd8ee109-3e93-42dd-9720-38df5bdfb000: Retrieved 100 invoice details (total: 2526) in 11ms with enhanced pagination
[2m2025-10-05T02:05:23.993423Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:23.993496Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0med784941-d209-4984-beb7-6825c52a300d
[2m2025-10-05T02:05:23.993506Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ed784941-d209-4984-beb7-6825c52a300d: Processing for user 1 with limit 100 offset 2600 order_by date direction DESC
[2m2025-10-05T02:05:23.993517Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ed784941-d209-4984-beb7-6825c52a300d: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:23.993528Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ed784941-d209-4984-beb7-6825c52a300d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:23.995028Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:23.995083Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m8c24a5ac-c157-4ffe-b124-68918bd2ba1e
[2m2025-10-05T02:05:23.995090Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8c24a5ac-c157-4ffe-b124-68918bd2ba1e: Processing for user 1 with limit 100 offset 2500 order_by date direction DESC
[2m2025-10-05T02:05:23.995084Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:23.995163Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf6fcce33-7560-4398-9df3-32fd56c36a36
[2m2025-10-05T02:05:23.995197Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f6fcce33-7560-4398-9df3-32fd56c36a36: Processing for user 1 with limit 100 offset 2400 order_by date direction DESC
[2m2025-10-05T02:05:23.995205Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f6fcce33-7560-4398-9df3-32fd56c36a36: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:23.995213Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f6fcce33-7560-4398-9df3-32fd56c36a36: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:23.995096Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8c24a5ac-c157-4ffe-b124-68918bd2ba1e: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:23.995312Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8c24a5ac-c157-4ffe-b124-68918bd2ba1e: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:23.998743Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ed784941-d209-4984-beb7-6825c52a300d: Retrieved 0 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-05T02:05:24.000734Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8c24a5ac-c157-4ffe-b124-68918bd2ba1e: Retrieved 26 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-05T02:05:24.001269Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f6fcce33-7560-4398-9df3-32fd56c36a36: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-05T02:05:24.530845Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:24.530926Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf3408704-bce1-4ef7-b401-c1e886951201
[2m2025-10-05T02:05:24.530934Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3408704-bce1-4ef7-b401-c1e886951201: Processing for user 1 with limit 100 offset 2900 order_by date direction DESC
[2m2025-10-05T02:05:24.530941Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3408704-bce1-4ef7-b401-c1e886951201: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:24.530949Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3408704-bce1-4ef7-b401-c1e886951201: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:24.530957Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:24.531024Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma3cffe13-483e-4a2b-9281-b789b62833dc
[2m2025-10-05T02:05:24.531031Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a3cffe13-483e-4a2b-9281-b789b62833dc: Processing for user 1 with limit 100 offset 2700 order_by date direction DESC
[2m2025-10-05T02:05:24.531038Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a3cffe13-483e-4a2b-9281-b789b62833dc: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:24.531046Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a3cffe13-483e-4a2b-9281-b789b62833dc: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:24.531099Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:24.531122Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma0d735c3-228f-454b-838f-35072fd5192a
[2m2025-10-05T02:05:24.531127Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a0d735c3-228f-454b-838f-35072fd5192a: Processing for user 1 with limit 100 offset 2800 order_by date direction DESC
[2m2025-10-05T02:05:24.531133Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a0d735c3-228f-454b-838f-35072fd5192a: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:24.531139Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a0d735c3-228f-454b-838f-35072fd5192a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:24.539015Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3408704-bce1-4ef7-b401-c1e886951201: Retrieved 0 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-05T02:05:24.539766Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a3cffe13-483e-4a2b-9281-b789b62833dc: Retrieved 0 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-05T02:05:24.540394Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a0d735c3-228f-454b-838f-35072fd5192a: Retrieved 0 invoice details (total: 2526) in 9ms with enhanced pagination
[2m2025-10-05T02:05:25.911534Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:25.911609Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0maf01d73c-0302-4227-9d70-0d82d38982ff
[2m2025-10-05T02:05:25.911618Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request af01d73c-0302-4227-9d70-0d82d38982ff: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-05T02:05:25.911628Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request af01d73c-0302-4227-9d70-0d82d38982ff: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:25.912123Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:25.912219Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m2db1d56b-06d9-4e9b-8c9b-c8d83d59f840
[2m2025-10-05T02:05:25.912237Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2db1d56b-06d9-4e9b-8c9b-c8d83d59f840: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-05T02:05:25.912249Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2db1d56b-06d9-4e9b-8c9b-c8d83d59f840: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:25.912865Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:25.912905Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc7ead542-e452-45d4-9492-2afafab047bf
[2m2025-10-05T02:05:25.912912Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c7ead542-e452-45d4-9492-2afafab047bf: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-05T02:05:25.912920Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c7ead542-e452-45d4-9492-2afafab047bf: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:25.913967Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2db1d56b-06d9-4e9b-8c9b-c8d83d59f840: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-05T02:05:25.914571Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request af01d73c-0302-4227-9d70-0d82d38982ff: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-05T02:05:25.915103Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c7ead542-e452-45d4-9492-2afafab047bf: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-05T02:05:26.109732Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:26.109936Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5e4d3b3d-dcf2-4626-83c2-4beb8c0c976c
[2m2025-10-05T02:05:26.109961Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5e4d3b3d-dcf2-4626-83c2-4beb8c0c976c: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-05T02:05:26.109970Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5e4d3b3d-dcf2-4626-83c2-4beb8c0c976c: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:26.109977Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5e4d3b3d-dcf2-4626-83c2-4beb8c0c976c: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:26.109936Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:26.110281Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m20222d0c-4001-4bde-b692-d3620900ab4d
[2m2025-10-05T02:05:26.110292Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 20222d0c-4001-4bde-b692-d3620900ab4d: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-05T02:05:26.110298Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 20222d0c-4001-4bde-b692-d3620900ab4d: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:26.110317Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 20222d0c-4001-4bde-b692-d3620900ab4d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:26.111636Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5e4d3b3d-dcf2-4626-83c2-4beb8c0c976c: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-05T02:05:26.111838Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:26.111879Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me0a51de8-619c-485b-8975-74452cc5bea9
[2m2025-10-05T02:05:26.111888Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0a51de8-619c-485b-8975-74452cc5bea9: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-05T02:05:26.111894Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0a51de8-619c-485b-8975-74452cc5bea9: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:05:26.111901Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0a51de8-619c-485b-8975-74452cc5bea9: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:05:26.112984Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 20222d0c-4001-4bde-b692-d3620900ab4d: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-05T02:05:26.114337Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0a51de8-619c-485b-8975-74452cc5bea9: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-05T02:05:30.687487Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:05:30.892624Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:24:21.815066Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:24:21.815136Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:24:21.815175Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-05T02:24:21.817616Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-05T02:24:23.288766Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:24:23.288870Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0maea58364-fa6e-4092-be7a-ee937b42792a
[2m2025-10-05T02:24:23.288880Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aea58364-fa6e-4092-be7a-ee937b42792a: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-05T02:24:23.288893Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aea58364-fa6e-4092-be7a-ee937b42792a: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:24:23.292863Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aea58364-fa6e-4092-be7a-ee937b42792a: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-05T02:25:43.237051Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:43.237199Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:25:43.238886Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T02:25:47.735130Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:47.735253Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:47.735282Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ“‹ Fetching user issuers for user_id: 1 [35539008-5dcb-4e25-b241-12777b0b2c6e]
[2m2025-10-05T02:25:47.735300Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ” Cache key: user_issuers_list_1_100_0_no_date_filter [35539008-5dcb-4e25-b241-12777b0b2c6e]
[2m2025-10-05T02:25:47.742231Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:47.742272Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:47.742291Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ“‹ Fetching user issuers for user_id: 1 [b48dd57b-d76f-4130-8cfd-9d92a3302f84]
[2m2025-10-05T02:25:47.742299Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ” Cache key: user_issuers_list_1_100_0_no_date_filter [b48dd57b-d76f-4130-8cfd-9d92a3302f84]
[2m2025-10-05T02:25:47.742811Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m âœ… Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 7ms [35539008-5dcb-4e25-b241-12777b0b2c6e]
[2m2025-10-05T02:25:47.748572Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m âœ… Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 6ms [b48dd57b-d76f-4130-8cfd-9d92a3302f84]
[2m2025-10-05T02:25:48.357749Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:48.357819Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:48.357873Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ›’ Fetching user products for user_id: 1 [f23bf4c5-d466-4de4-aa82-c9abab50c051]
[2m2025-10-05T02:25:48.357883Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ” Cache key: user_products_list_1_20_0_no_date_filter [f23bf4c5-d466-4de4-aa82-c9abab50c051]
[2m2025-10-05T02:25:48.375837Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m âœ… Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 17ms [f23bf4c5-d466-4de4-aa82-c9abab50c051]
[2m2025-10-05T02:25:48.679513Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:48.679568Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:25:48.679588Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ›’ Fetching user products for user_id: 1 [f7ff5650-a6ee-49f3-843a-7a2dcb59186b]
[2m2025-10-05T02:25:48.679597Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ” Cache key: user_products_list_1_20_0_no_date_filter [f7ff5650-a6ee-49f3-843a-7a2dcb59186b]
[2m2025-10-05T02:25:48.696129Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m âœ… Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 16ms [f7ff5650-a6ee-49f3-843a-7a2dcb59186b]
[2m2025-10-05T02:26:40.050266Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:40.050323Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:40.050341Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-05T02:26:40.051984Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-05T02:26:41.647843Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:41.647905Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:26:41.648887Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-05T02:26:42.471583Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:42.471708Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6a86c47b-1f98-47c8-bad6-183b7f71c711
[2m2025-10-05T02:26:42.471718Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a86c47b-1f98-47c8-bad6-183b7f71c711: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-05T02:26:42.471727Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a86c47b-1f98-47c8-bad6-183b7f71c711: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:26:42.472536Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:42.472585Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m321cf536-91e6-4b8c-b1d7-60fd30cb3b9a
[2m2025-10-05T02:26:42.472592Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 321cf536-91e6-4b8c-b1d7-60fd30cb3b9a: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-05T02:26:42.472599Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 321cf536-91e6-4b8c-b1d7-60fd30cb3b9a: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:26:42.474976Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 321cf536-91e6-4b8c-b1d7-60fd30cb3b9a: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-05T02:26:42.475000Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a86c47b-1f98-47c8-bad6-183b7f71c711: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-05T02:26:43.273807Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:43.273889Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mea38e378-e98b-4304-82b2-a8e79eb1758a
[2m2025-10-05T02:26:43.273897Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ea38e378-e98b-4304-82b2-a8e79eb1758a: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-05T02:26:43.273908Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ea38e378-e98b-4304-82b2-a8e79eb1758a: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:26:43.276163Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ea38e378-e98b-4304-82b2-a8e79eb1758a: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-05T02:26:44.059916Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:44.059984Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma9edf78f-5552-4e22-8a20-e1dc15123283
[2m2025-10-05T02:26:44.059992Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a9edf78f-5552-4e22-8a20-e1dc15123283: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-05T02:26:44.060000Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a9edf78f-5552-4e22-8a20-e1dc15123283: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:26:44.060007Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a9edf78f-5552-4e22-8a20-e1dc15123283: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:26:44.061812Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:44.061862Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m6ced49ff-daf9-4017-8255-f9632d56a05d
[2m2025-10-05T02:26:44.061882Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ced49ff-daf9-4017-8255-f9632d56a05d: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-05T02:26:44.061889Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ced49ff-daf9-4017-8255-f9632d56a05d: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:26:44.061895Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ced49ff-daf9-4017-8255-f9632d56a05d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:26:44.061928Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:26:44.061984Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma78e1131-b89c-43f3-adb1-269d005159ec
[2m2025-10-05T02:26:44.061992Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a78e1131-b89c-43f3-adb1-269d005159ec: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-05T02:26:44.062001Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a78e1131-b89c-43f3-adb1-269d005159ec: Querying details for user 1 with enhanced filters
[2m2025-10-05T02:26:44.062009Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a78e1131-b89c-43f3-adb1-269d005159ec: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-05T02:26:44.063442Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a9edf78f-5552-4e22-8a20-e1dc15123283: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-05T02:26:44.064896Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a78e1131-b89c-43f3-adb1-269d005159ec: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-05T02:26:44.065327Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ced49ff-daf9-4017-8255-f9632d56a05d: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-05T02:27:53.605858Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:27:53.605921Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:27:53.607137Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T02:33:23.473643Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:33:23.476037Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:33:23.473799Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:33:23.476303Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:33:23.476324Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-05T02:33:23.477920Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T02:33:23.478382Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-05T02:33:27.329387Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:33:27.329457Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-05T02:33:27.331111Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-05T02:33:31.241675Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:33:31.360938Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:33:31.411241Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-05T02:33:31.414483Z[0m [31mERROR[0m [2mlum_rust_ws::api::gamification_v4[0m[2m:[0m Failed to track action: Database(PgDatabaseError { severity: Error, code: "23514", message: "no partition of relation \"fact_user_activity_log\" found for row", detail: Some("Partition key of the failing row contains (created_at) = (2025-10-05 02:33:31.41233+00)."), hint: None, position: None, where: Some("SQL statement \"INSERT INTO gamification.fact_user_activity_log (\n        user_id, activity_type, activity_data, created_at\n    ) VALUES (\n        p_user_id, p_action_type, \n        jsonb_build_object(\n            'channel', p_channel,\n            'metadata', p_metadata,\n            'timestamp', NOW()\n        ),\n        NOW()\n    )\"\nPL/pgSQL function gamification.track_user_action(integer,character varying,character varying,jsonb) line 13 at SQL statement"), schema: Some("gamification"), table: Some("fact_user_activity_log"), column: None, data_type: None, constraint: None, file: Some("execPartition.c"), line: Some(328), routine: Some("ExecFindPartition") })
[2m2025-10-05T02:33:31.414546Z[0m [31mERROR[0m [2mtower_http::trace::on_failure[0m[2m:[0m response failed [3mclassification[0m[2m=[0mStatus code: 500 Internal Server Error [3mlatency[0m[2m=[0m3 ms
[2m2025-10-05T02:40:11.701543Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 4063d3c7-5f07-4564-a6e8-954a279400e0: Root endpoint accessed
[2m2025-10-05T04:06:08.456528Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request f66bdcf9-27fb-49f4-9a36-36ccc4336971: Root endpoint accessed
[2m2025-10-05T07:43:11.580589Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T09:11:39.295833Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request b248c57b-a960-4a9c-bd4e-3416d1699d4a: Root endpoint accessed
[2m2025-10-05T09:11:39.439192Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T09:16:24.036929Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 4390470f-4c41-46a8-9e65-63920815309b: Root endpoint accessed
[2m2025-10-05T10:26:26.811579Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request ad33272e-2242-4973-b498-c222af0f2a55: Root endpoint accessed
[2m2025-10-05T11:01:35.386177Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 3c618f5d-c5a2-433a-a944-05ba5c6556c8: Root endpoint accessed
[2m2025-10-05T11:52:20.722687Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 548ffaa8-2cd8-4f60-adb7-133f86153f03: Root endpoint accessed
[2m2025-10-05T11:52:22.471914Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T11:53:15.403659Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request ef03fcf6-3c3a-4676-a122-7a84877bdcfc: Root endpoint accessed
[2m2025-10-05T11:57:03.299675Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request c76ac289-b371-4e24-9817-ca1895e7cb14: Root endpoint accessed
[2m2025-10-05T11:57:27.178496Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T11:57:31.572811Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request f2751076-69c4-4029-9505-22124ac994c6: Root endpoint accessed
[2m2025-10-05T11:57:34.360426Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T13:15:58.880802Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request e684a648-dc25-4348-bcac-c45e247718d6: Root endpoint accessed
[2m2025-10-05T13:38:42.023898Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 8f7b6976-58ee-4755-a79d-de11b9f20a71: Root endpoint accessed
[2m2025-10-05T15:07:17.260082Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 88374ccc-53dc-4e81-86bf-ca741bcc929d: Root endpoint accessed
[2m2025-10-05T17:53:48.699370Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 4e3eb74b-ec43-421b-8f4f-c3684e90b715: Root endpoint accessed
[2m2025-10-05T17:53:49.005758Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T17:53:51.182567Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 331afd19-4f5c-4ff2-ad17-8a38c6d9a086: Root endpoint accessed
[2m2025-10-05T17:53:51.430410Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T17:53:51.430446Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T17:53:51.483569Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request acd3c2cc-60c4-4b5c-a17a-2b60c3310634: Root endpoint accessed
[2m2025-10-05T17:53:51.685398Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 72979111-f566-4b4e-ae8f-b43657aa17ee: Root endpoint accessed
[2m2025-10-05T17:53:51.895063Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T17:53:52.097133Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T17:54:11.479218Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request d7f28e8a-cd45-4b76-b017-03d333c0556e: Root endpoint accessed
[2m2025-10-05T18:11:28.436971Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c991c376-8d65-4fd0-ab8b-a4326a6792ef: Checking email existence: andrescarriela@gmail.com
[2m2025-10-05T18:11:28.437322Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c991c376-8d65-4fd0-ab8b-a4326a6792ef: Querying database for email: andrescarriela@gmail.com
[2m2025-10-05T18:11:28.439806Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c991c376-8d65-4fd0-ab8b-a4326a6792ef: Found existing user with ID: 2
[2m2025-10-05T18:11:28.439836Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c991c376-8d65-4fd0-ab8b-a4326a6792ef: Email andrescarriela@gmail.com exists with password: true
[2m2025-10-05T18:11:42.151133Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m ðŸ” Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-05T18:11:42.151226Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸš€ Starting unified authentication [3mrequest_id[0m[2m=[0m3695857d-a93a-4dbe-b041-becd6de8a6aa [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-05T18:11:42.151241Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ”‘ Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-05T18:11:42.157000Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ“ Auth event logged to database [3mrequest_id[0m[2m=[0m3695857d-a93a-4dbe-b041-becd6de8a6aa [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-05T18:11:42.432234Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m ðŸ”‘ Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-06 18:11:42.432208913 UTC
[2m2025-10-05T18:11:42.437738Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ“ Auth event logged to database [3mrequest_id[0m[2m=[0m3695857d-a93a-4dbe-b041-becd6de8a6aa [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-05T18:11:42.437757Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m âœ… Authentication successful [3mrequest_id[0m[2m=[0m3695857d-a93a-4dbe-b041-becd6de8a6aa [3mexecution_time_ms[0m[2m=[0m286
[2m2025-10-05T19:46:17.997533Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request c3514b7c-0256-4520-85aa-b469bc948b43: Root endpoint accessed
[2m2025-10-05T21:22:21.159250Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 0c9f212c-f6b5-4b4c-8322-601bae29f168: Root endpoint accessed
[2m2025-10-05T22:22:44.138569Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T22:22:44.145880Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T22:22:44.148567Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T22:22:44.149532Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T22:22:44.158577Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request e651f10a-eaa7-4a68-82c1-8ef43b7fa5c0: Root endpoint accessed
[2m2025-10-05T22:22:44.159871Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T22:22:44.164582Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T22:22:44.167834Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T22:22:44.168196Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-05T23:47:37.248420Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 63a9db02-76a5-4c47-a616-6856bf62ce38: Root endpoint accessed
[2m2025-10-06T01:10:23.320362Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request ba507509-1497-4827-9ea6-701bb6176389: Root endpoint accessed
[2m2025-10-06T01:12:33.870641Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 48008914-dc45-41da-9579-787c814e72da: Root endpoint accessed
[2m2025-10-06T01:30:15.882511Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:15.882980Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:15.882999Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T01:30:15.886376Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 3ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T01:30:17.076188Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:17.076405Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:30:17.078051Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T01:30:17.606634Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:17.606714Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mf9b67950-c634-400d-95d8-55036790826b
[2m2025-10-06T01:30:17.606723Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f9b67950-c634-400d-95d8-55036790826b: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-06T01:30:17.606751Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f9b67950-c634-400d-95d8-55036790826b: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:30:17.610589Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f9b67950-c634-400d-95d8-55036790826b: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-06T01:30:17.903422Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:17.903496Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m4236f508-a1c7-4f0b-a2e3-2366f339ac2d
[2m2025-10-06T01:30:17.903503Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4236f508-a1c7-4f0b-a2e3-2366f339ac2d: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-06T01:30:17.903513Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4236f508-a1c7-4f0b-a2e3-2366f339ac2d: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:30:17.907447Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4236f508-a1c7-4f0b-a2e3-2366f339ac2d: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-06T01:30:17.909004Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:17.909059Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m8cf3d8c2-4273-427b-bfe9-4ef4d38e08ed
[2m2025-10-06T01:30:17.909067Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8cf3d8c2-4273-427b-bfe9-4ef4d38e08ed: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-06T01:30:17.909078Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8cf3d8c2-4273-427b-bfe9-4ef4d38e08ed: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:30:17.912018Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8cf3d8c2-4273-427b-bfe9-4ef4d38e08ed: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-06T01:30:18.094117Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:18.094265Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m573101fc-222c-4332-9fc5-ecd60488a039
[2m2025-10-06T01:30:18.094308Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 573101fc-222c-4332-9fc5-ecd60488a039: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-06T01:30:18.094321Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 573101fc-222c-4332-9fc5-ecd60488a039: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:30:18.094333Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 573101fc-222c-4332-9fc5-ecd60488a039: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:30:18.100091Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 573101fc-222c-4332-9fc5-ecd60488a039: Retrieved 0 invoice details (total: 0) in 5ms with enhanced pagination
[2m2025-10-06T01:30:18.100200Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:18.100291Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:18.100344Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m8107307a-7a43-4142-8d1f-5c320cc09ca0
[2m2025-10-06T01:30:18.100345Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0meafd1bad-0fa6-41bf-b702-9d62fc08ab06
[2m2025-10-06T01:30:18.100360Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eafd1bad-0fa6-41bf-b702-9d62fc08ab06: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-06T01:30:18.100369Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eafd1bad-0fa6-41bf-b702-9d62fc08ab06: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:30:18.100380Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eafd1bad-0fa6-41bf-b702-9d62fc08ab06: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:30:18.100352Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8107307a-7a43-4142-8d1f-5c320cc09ca0: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-06T01:30:18.100617Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8107307a-7a43-4142-8d1f-5c320cc09ca0: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:30:18.100746Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8107307a-7a43-4142-8d1f-5c320cc09ca0: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:30:18.105208Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eafd1bad-0fa6-41bf-b702-9d62fc08ab06: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-06T01:30:18.106789Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8107307a-7a43-4142-8d1f-5c320cc09ca0: Retrieved 0 invoice details (total: 0) in 6ms with enhanced pagination
[2m2025-10-06T01:30:24.102801Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:24.102875Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:24.102894Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T01:30:24.104487Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T01:30:39.417515Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:39.417585Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:30:39.418755Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T01:30:41.246383Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:41.246454Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:41.246479Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-06T01:30:41.252453Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 5ms for user_id: 1 - 20 items
[2m2025-10-06T01:30:41.526912Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:41.526977Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:41.526978Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:41.527018Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:41.526998Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-06T01:30:41.527033Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-06T01:30:41.531346Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 4ms for user_id: 1 - 20 items
[2m2025-10-06T01:30:41.531738Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 4ms for user_id: 1 - 20 items
[2m2025-10-06T01:30:41.551625Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:41.551679Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:30:41.552089Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-06T01:30:56.496232Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:56.657755Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:56.695826Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:30:56.698181Z[0m [31mERROR[0m [2mlum_rust_ws::api::gamification_v4[0m[2m:[0m Failed to track action: Database(PgDatabaseError { severity: Error, code: "23514", message: "no partition of relation \"fact_user_activity_log\" found for row", detail: Some("Partition key of the failing row contains (created_at) = (2025-10-06 01:30:56.696558+00)."), hint: None, position: None, where: Some("SQL statement \"INSERT INTO gamification.fact_user_activity_log (\n        user_id, activity_type, activity_data, created_at\n    ) VALUES (\n        p_user_id, p_action_type, \n        jsonb_build_object(\n            'channel', p_channel,\n            'metadata', p_metadata,\n            'timestamp', NOW()\n        ),\n        NOW()\n    )\"\nPL/pgSQL function gamification.track_user_action(integer,character varying,character varying,jsonb) line 13 at SQL statement"), schema: Some("gamification"), table: Some("fact_user_activity_log"), column: None, data_type: None, constraint: None, file: Some("execPartition.c"), line: Some(328), routine: Some("ExecFindPartition") })
[2m2025-10-06T01:30:56.698241Z[0m [31mERROR[0m [2mtower_http::trace::on_failure[0m[2m:[0m response failed [3mclassification[0m[2m=[0mStatus code: 500 Internal Server Error [3mlatency[0m[2m=[0m2 ms
[2m2025-10-06T01:36:34.083824Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:36:34.083912Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:36:34.083938Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T01:36:34.084617Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T01:36:34.090459Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:36:34.090517Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:36:34.091428Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-06T01:40:24.029109Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:24.029232Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:24.029254Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T01:40:24.031928Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T01:40:25.099450Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:25.099520Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:40:25.101189Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T01:40:25.621065Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:25.621239Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mf8904759-d7e6-43da-95c9-6e2664a2dc60
[2m2025-10-06T01:40:25.621255Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f8904759-d7e6-43da-95c9-6e2664a2dc60: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-06T01:40:25.621276Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f8904759-d7e6-43da-95c9-6e2664a2dc60: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:40:25.624641Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f8904759-d7e6-43da-95c9-6e2664a2dc60: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-06T01:40:25.902645Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:25.902722Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0ma5ddb51c-9140-4b7e-a39f-6568c0e7a4b5
[2m2025-10-06T01:40:25.902730Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a5ddb51c-9140-4b7e-a39f-6568c0e7a4b5: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-06T01:40:25.902749Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a5ddb51c-9140-4b7e-a39f-6568c0e7a4b5: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:40:25.907405Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a5ddb51c-9140-4b7e-a39f-6568c0e7a4b5: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-06T01:40:25.926735Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:25.926778Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6d168ea7-db60-4327-8dce-958ed17dcc1b
[2m2025-10-06T01:40:25.926785Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6d168ea7-db60-4327-8dce-958ed17dcc1b: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-06T01:40:25.926792Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6d168ea7-db60-4327-8dce-958ed17dcc1b: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:40:25.930234Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6d168ea7-db60-4327-8dce-958ed17dcc1b: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-06T01:40:26.096485Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:26.096540Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m9ef3704b-563e-40a5-8990-56a8c3e0a014
[2m2025-10-06T01:40:26.096548Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9ef3704b-563e-40a5-8990-56a8c3e0a014: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-06T01:40:26.096554Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9ef3704b-563e-40a5-8990-56a8c3e0a014: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:40:26.096573Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9ef3704b-563e-40a5-8990-56a8c3e0a014: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:40:26.097892Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:26.097968Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mcfe4d6a5-9fe6-488c-9a92-c2983278db6b
[2m2025-10-06T01:40:26.097977Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cfe4d6a5-9fe6-488c-9a92-c2983278db6b: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-06T01:40:26.097985Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cfe4d6a5-9fe6-488c-9a92-c2983278db6b: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:40:26.097993Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cfe4d6a5-9fe6-488c-9a92-c2983278db6b: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:40:26.098584Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9ef3704b-563e-40a5-8990-56a8c3e0a014: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-06T01:40:26.101029Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cfe4d6a5-9fe6-488c-9a92-c2983278db6b: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-06T01:40:26.105007Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:40:26.105082Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0a28af7d-cf8c-47b3-97cf-a5c0bc5231b1
[2m2025-10-06T01:40:26.105094Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0a28af7d-cf8c-47b3-97cf-a5c0bc5231b1: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-06T01:40:26.105104Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0a28af7d-cf8c-47b3-97cf-a5c0bc5231b1: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:40:26.105116Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0a28af7d-cf8c-47b3-97cf-a5c0bc5231b1: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:40:26.107669Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0a28af7d-cf8c-47b3-97cf-a5c0bc5231b1: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-06T01:45:13.052765Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:13.052848Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:13.052873Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T01:45:13.054541Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T01:45:14.048111Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:14.048247Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:45:14.049536Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T01:45:14.365373Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:14.365513Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6a63405d-a9de-48e9-a3f7-5e567c6eacdf
[2m2025-10-06T01:45:14.365529Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a63405d-a9de-48e9-a3f7-5e567c6eacdf: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-06T01:45:14.365554Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a63405d-a9de-48e9-a3f7-5e567c6eacdf: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:45:14.368371Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a63405d-a9de-48e9-a3f7-5e567c6eacdf: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-06T01:45:14.662492Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:14.662580Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0md1c83ee7-ba33-4088-8ff7-95388847c720
[2m2025-10-06T01:45:14.662591Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d1c83ee7-ba33-4088-8ff7-95388847c720: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-06T01:45:14.662622Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d1c83ee7-ba33-4088-8ff7-95388847c720: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:45:14.665280Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d1c83ee7-ba33-4088-8ff7-95388847c720: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-06T01:45:14.676388Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:14.676444Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mb1ba77db-5b4c-4751-af04-89d795e120d4
[2m2025-10-06T01:45:14.676452Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b1ba77db-5b4c-4751-af04-89d795e120d4: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-06T01:45:14.676461Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b1ba77db-5b4c-4751-af04-89d795e120d4: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:45:14.678634Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b1ba77db-5b4c-4751-af04-89d795e120d4: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-06T01:45:14.819896Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:14.819984Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0d24a4dc-d33e-4ea5-8090-0ba0c403dbe1
[2m2025-10-06T01:45:14.819992Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0d24a4dc-d33e-4ea5-8090-0ba0c403dbe1: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-06T01:45:14.820000Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0d24a4dc-d33e-4ea5-8090-0ba0c403dbe1: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:45:14.820012Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0d24a4dc-d33e-4ea5-8090-0ba0c403dbe1: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:45:14.821783Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0d24a4dc-d33e-4ea5-8090-0ba0c403dbe1: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-06T01:45:14.826101Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:14.826169Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb85998e4-c118-41e2-9da9-d027de45fa3a
[2m2025-10-06T01:45:14.826178Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b85998e4-c118-41e2-9da9-d027de45fa3a: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-06T01:45:14.826185Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b85998e4-c118-41e2-9da9-d027de45fa3a: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:45:14.826191Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b85998e4-c118-41e2-9da9-d027de45fa3a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:45:14.828522Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b85998e4-c118-41e2-9da9-d027de45fa3a: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-06T01:45:14.828916Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:45:14.828953Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m9bf0e4b8-29a0-4c41-8e36-86c465413edd
[2m2025-10-06T01:45:14.828960Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9bf0e4b8-29a0-4c41-8e36-86c465413edd: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-06T01:45:14.828966Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9bf0e4b8-29a0-4c41-8e36-86c465413edd: Querying details for user 1 with enhanced filters
[2m2025-10-06T01:45:14.828972Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9bf0e4b8-29a0-4c41-8e36-86c465413edd: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T01:45:14.830858Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9bf0e4b8-29a0-4c41-8e36-86c465413edd: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-06T01:51:29.867409Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:51:29.867486Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:51:29.868302Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-06T01:51:29.879505Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:51:29.879527Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:51:29.879538Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T01:51:29.880064Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T01:51:38.381685Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:51:47.810920Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:52:03.027309Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:56:50.968780Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:56:50.968887Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T01:56:50.970684Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T01:56:50.979249Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:56:50.979274Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:56:50.979286Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T01:56:50.981330Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T01:57:03.614115Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T01:57:19.822488Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:01:00.031875Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:01:00.031934Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T02:01:00.033533Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T02:01:00.037521Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:01:00.037546Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:01:00.037558Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T02:01:00.039280Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T02:01:18.815945Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:01:19.189002Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ” Starting OPTIMIZED QR detection (Phase 1 & 2)
[2m2025-10-06T02:01:19.189034Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Strategy 1: Equalization + Otsu
[2m2025-10-06T02:01:19.195436Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ðŸ“Š Preprocessing: Image size 608x1080
[2m2025-10-06T02:01:19.197189Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… Preprocessing complete - simple equalization + Otsu binarization
[2m2025-10-06T02:01:19.222275Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m âœ… rxing SUCCESS with equalization+otsu in 33ms
[2m2025-10-06T02:01:19.222299Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detected: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR in 33ms via Preprocessed decoders [3mrequest_id[0m[2m=[0m04719627-f873-4594-8843-6b870547a243 [3mdecoder[0m[2m=[0mrxing [3mlevel[0m[2m=[0m1 [3mtime_ms[0m[2m=[0m33
[2m2025-10-06T02:01:19.222308Z[0m [32m INFO[0m [2mlum_rust_ws::api::qr_v4[0m[2m:[0m âœ… QR detection successful [3mrequest_id[0m[2m=[0m04719627-f873-4594-8843-6b870547a243 [3mlevel[0m[2m=[0mrxing [3mprocessing_time_ms[0m[2m=[0m406
[2m2025-10-06T02:11:58.772407Z[0m [31mERROR[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m JWT validation failed: ExpiredSignature
[2m2025-10-06T02:12:14.016987Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m ðŸ” Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-06T02:12:14.017062Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸš€ Starting unified authentication [3mrequest_id[0m[2m=[0m9e62ffec-8cb3-401f-9bf1-6a970b2ff7b1 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6IjE3ZjBmMGYxNGU5Y2FmYTlhYjUxODAxNTBhZTcxNGM5ZmQxYjVjMjYiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1mNnBkNzBkMDkxYXRuZ2kxdXRuYnZ0OGxrdTdhMnB2Ni5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA2MDYzOTM2NDI0NDM3NjIxMDgwIiwiZW1haWwiOiJhbmRyZXNmZWxpcGV2YWxlbmNpYWdAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJBbmRyZXMgVmFsZW5jaWEiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSk9Xd083eUdDWVA1OHB4ZFZCd2R6MGJudWtITHdwcjk0RklVbGNEckxHYnVrYUFBPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6IkFuZHJlcyIsImZhbWlseV9uYW1lIjoiVmFsZW5jaWEiLCJpYXQiOjE3NTk3MTQyMTIsImV4cCI6MTc1OTcxNzgxMn0.cW1TGOI3ITTgO-iH6cYnsO5uV9-m5B_Lkb65LeRX_5RWsGS0pFsahFHZ-dRwlDAsEjsCPNt9c5xdlM8qO-5LWTlE6iMeUUCOzAqqfy-uQBHuaINmnghdJej0IFwqGru2kaaungfVMfUbi7_CIdvjyE8UwWZ8xKGcNDValVVOwtIxEON35fYGbhrozvkTIjrrshRMzwXIES-4F4cVicPBCq1qi3bmrNJZCf-oUZ-FE-47L9VS6_DNLMLua-Ascz6yQ2RVbpKTBE2yAGeY8I0JalBxIYE-9nGxvXmQLZv7ud_6robWH73fy5Gd2eA4MCulFfxyi2_ShLpbVyiX821LMw", access_token: None }
[2m2025-10-06T02:12:14.017111Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ”‘ Google authentication
[2m2025-10-06T02:12:14.022738Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ“ Auth event logged to database [3mrequest_id[0m[2m=[0m9e62ffec-8cb3-401f-9bf1-6a970b2ff7b1 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-06T02:12:14.022771Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ðŸ” Starting Google ID token validation [3mrequest_id[0m[2m=[0m6df36ad8-179f-4806-87f7-79f3f4a13dfb
[2m2025-10-06T02:12:14.047568Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m âœ… Google certificates fetched successfully [3mrequest_id[0m[2m=[0m6df36ad8-179f-4806-87f7-79f3f4a13dfb [3mcert_count[0m[2m=[0m2
[2m2025-10-06T02:12:14.048029Z[0m [32m INFO[0m [2mlum_rust_ws::services::redis_service[0m[2m:[0m ðŸ”‘ Redis key set with TTL [3mkey[0m[2m=[0mauth:google:certificates [3mttl[0m[2m=[0m86400
[2m2025-10-06T02:12:14.048055Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ðŸ’¾ Google certificates cached [3mrequest_id[0m[2m=[0m6df36ad8-179f-4806-87f7-79f3f4a13dfb [3mttl_hours[0m[2m=[0m24
[2m2025-10-06T02:12:14.048128Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m âœ… Google ID token validated successfully [3mrequest_id[0m[2m=[0m6df36ad8-179f-4806-87f7-79f3f4a13dfb [3muser_id[0m[2m=[0m106063936424437621080 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mname[0m[2m=[0mSome("Andres Valencia") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m25
[2m2025-10-06T02:12:14.053433Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m ðŸ”‘ Generated access token successfully [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mexpires_at[0m[2m=[0m2025-10-07 02:12:14.053419021 UTC
[2m2025-10-06T02:12:14.057583Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ðŸ“ Auth event logged to database [3mrequest_id[0m[2m=[0m9e62ffec-8cb3-401f-9bf1-6a970b2ff7b1 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-06T02:12:14.057615Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m âœ… Authentication successful [3mrequest_id[0m[2m=[0m9e62ffec-8cb3-401f-9bf1-6a970b2ff7b1 [3mexecution_time_ms[0m[2m=[0m40
[2m2025-10-06T02:12:14.731012Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:14.731074Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:14.731091Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T02:12:14.733316Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T02:12:14.735971Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:14.736026Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T02:12:14.737474Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T02:12:18.437675Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:18.437741Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:18.437764Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ“‹ Fetching user issuers for user_id: 1 [42e239df-d05a-4e1e-b7cf-8b4886c28fa9]
[2m2025-10-06T02:12:18.437772Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ” Cache key: user_issuers_list_1_100_0_no_date_filter [42e239df-d05a-4e1e-b7cf-8b4886c28fa9]
[2m2025-10-06T02:12:18.445331Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m âœ… Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 7ms [42e239df-d05a-4e1e-b7cf-8b4886c28fa9]
[2m2025-10-06T02:12:18.450170Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:18.450209Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:18.450229Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ“‹ Fetching user issuers for user_id: 1 [6d337913-1105-4cff-ad79-355eb56bea48]
[2m2025-10-06T02:12:18.450237Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ðŸ” Cache key: user_issuers_list_1_100_0_no_date_filter [6d337913-1105-4cff-ad79-355eb56bea48]
[2m2025-10-06T02:12:18.456063Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m âœ… Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 5ms [6d337913-1105-4cff-ad79-355eb56bea48]
[2m2025-10-06T02:12:19.141377Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:19.141441Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:19.141460Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ›’ Fetching user products for user_id: 1 [beb0ffdd-f1ea-4510-9b37-26e7d869d6cd]
[2m2025-10-06T02:12:19.141468Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ” Cache key: user_products_list_1_20_0_no_date_filter [beb0ffdd-f1ea-4510-9b37-26e7d869d6cd]
[2m2025-10-06T02:12:19.154581Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m âœ… Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 13ms [beb0ffdd-f1ea-4510-9b37-26e7d869d6cd]
[2m2025-10-06T02:12:19.578041Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:19.578109Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:19.578130Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ›’ Fetching user products for user_id: 1 [25a6f24c-e82e-42e5-a34d-3ca252ea2338]
[2m2025-10-06T02:12:19.578204Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ðŸ” Cache key: user_products_list_1_20_0_no_date_filter [25a6f24c-e82e-42e5-a34d-3ca252ea2338]
[2m2025-10-06T02:12:19.592562Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m âœ… Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 14ms [25a6f24c-e82e-42e5-a34d-3ca252ea2338]
[2m2025-10-06T02:12:19.771703Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:19.771784Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc760056f-4f43-4bf2-915a-088984b30f58
[2m2025-10-06T02:12:19.771792Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c760056f-4f43-4bf2-915a-088984b30f58: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-06T02:12:19.771804Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c760056f-4f43-4bf2-915a-088984b30f58: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:19.788602Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c760056f-4f43-4bf2-915a-088984b30f58: Retrieved 50 invoice headers (total: 337) in 16ms with enhanced filtering
[2m2025-10-06T02:12:20.076929Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:20.077001Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m63b83c62-750f-4ebd-b83b-97f82ca3bcd5
[2m2025-10-06T02:12:20.077009Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 63b83c62-750f-4ebd-b83b-97f82ca3bcd5: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-06T02:12:20.077019Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 63b83c62-750f-4ebd-b83b-97f82ca3bcd5: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:20.084833Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:20.084908Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m2d77a6a7-c0ca-43b2-a2b3-76b9a5ba4191
[2m2025-10-06T02:12:20.084916Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2d77a6a7-c0ca-43b2-a2b3-76b9a5ba4191: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-06T02:12:20.084924Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2d77a6a7-c0ca-43b2-a2b3-76b9a5ba4191: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:20.086426Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 63b83c62-750f-4ebd-b83b-97f82ca3bcd5: Retrieved 50 invoice headers (total: 337) in 9ms with enhanced filtering
[2m2025-10-06T02:12:20.093294Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2d77a6a7-c0ca-43b2-a2b3-76b9a5ba4191: Retrieved 50 invoice headers (total: 337) in 8ms with enhanced filtering
[2m2025-10-06T02:12:28.505763Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:28.505846Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m2bde08f9-7645-46b5-b574-cb2cefe9f476
[2m2025-10-06T02:12:28.505855Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2bde08f9-7645-46b5-b574-cb2cefe9f476: Processing headers for user 1 with limit 50 offset 150
[2m2025-10-06T02:12:28.505894Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2bde08f9-7645-46b5-b574-cb2cefe9f476: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:28.511412Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2bde08f9-7645-46b5-b574-cb2cefe9f476: Retrieved 50 invoice headers (total: 337) in 5ms with enhanced filtering
[2m2025-10-06T02:12:28.839940Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:28.840022Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0md51b6f4c-c0b9-462e-aba8-3e3334c3ef2c
[2m2025-10-06T02:12:28.840030Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d51b6f4c-c0b9-462e-aba8-3e3334c3ef2c: Processing headers for user 1 with limit 50 offset 200
[2m2025-10-06T02:12:28.840047Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d51b6f4c-c0b9-462e-aba8-3e3334c3ef2c: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:28.845519Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d51b6f4c-c0b9-462e-aba8-3e3334c3ef2c: Retrieved 50 invoice headers (total: 337) in 5ms with enhanced filtering
[2m2025-10-06T02:12:28.855057Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:28.855135Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc937b4c2-e9b6-4428-85fa-0e8b63a6ff1f
[2m2025-10-06T02:12:28.855182Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c937b4c2-e9b6-4428-85fa-0e8b63a6ff1f: Processing headers for user 1 with limit 50 offset 250
[2m2025-10-06T02:12:28.855207Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c937b4c2-e9b6-4428-85fa-0e8b63a6ff1f: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:28.860434Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c937b4c2-e9b6-4428-85fa-0e8b63a6ff1f: Retrieved 50 invoice headers (total: 337) in 5ms with enhanced filtering
[2m2025-10-06T02:12:29.328477Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.328565Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.328628Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m30e7e5df-2bed-42e8-9e06-9d89542f206d
[2m2025-10-06T02:12:29.328637Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30e7e5df-2bed-42e8-9e06-9d89542f206d: Processing headers for user 1 with limit 50 offset 300
[2m2025-10-06T02:12:29.328647Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mf113da20-5979-48be-b1b8-2083165debef
[2m2025-10-06T02:12:29.328647Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30e7e5df-2bed-42e8-9e06-9d89542f206d: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.328655Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f113da20-5979-48be-b1b8-2083165debef: Processing headers for user 1 with limit 50 offset 350
[2m2025-10-06T02:12:29.328696Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f113da20-5979-48be-b1b8-2083165debef: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.330135Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.330189Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m33c0d418-6002-4703-b0af-11beb38d4c1a
[2m2025-10-06T02:12:29.330198Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 33c0d418-6002-4703-b0af-11beb38d4c1a: Processing headers for user 1 with limit 50 offset 400
[2m2025-10-06T02:12:29.330205Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 33c0d418-6002-4703-b0af-11beb38d4c1a: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.334280Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f113da20-5979-48be-b1b8-2083165debef: Retrieved 0 invoice headers (total: 337) in 5ms with enhanced filtering
[2m2025-10-06T02:12:29.338362Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30e7e5df-2bed-42e8-9e06-9d89542f206d: Retrieved 37 invoice headers (total: 337) in 9ms with enhanced filtering
[2m2025-10-06T02:12:29.339165Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 33c0d418-6002-4703-b0af-11beb38d4c1a: Retrieved 0 invoice headers (total: 337) in 8ms with enhanced filtering
[2m2025-10-06T02:12:29.678084Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.678215Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mad5004c4-14c3-4145-b827-b14564bbf346
[2m2025-10-06T02:12:29.678228Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ad5004c4-14c3-4145-b827-b14564bbf346: Processing headers for user 1 with limit 50 offset 450
[2m2025-10-06T02:12:29.678240Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ad5004c4-14c3-4145-b827-b14564bbf346: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.683234Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ad5004c4-14c3-4145-b827-b14564bbf346: Retrieved 0 invoice headers (total: 337) in 5ms with enhanced filtering
[2m2025-10-06T02:12:29.684698Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.684740Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mec927f74-c49d-4d27-b9f8-71c4258d28d8
[2m2025-10-06T02:12:29.684748Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ec927f74-c49d-4d27-b9f8-71c4258d28d8: Processing headers for user 1 with limit 50 offset 500
[2m2025-10-06T02:12:29.684755Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ec927f74-c49d-4d27-b9f8-71c4258d28d8: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.686331Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.686415Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mca39ead2-955a-4596-9fad-3092b88f9d6d
[2m2025-10-06T02:12:29.686429Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ca39ead2-955a-4596-9fad-3092b88f9d6d: Processing headers for user 1 with limit 50 offset 550
[2m2025-10-06T02:12:29.686441Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ca39ead2-955a-4596-9fad-3092b88f9d6d: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.688043Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ec927f74-c49d-4d27-b9f8-71c4258d28d8: Retrieved 0 invoice headers (total: 337) in 3ms with enhanced filtering
[2m2025-10-06T02:12:29.690059Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ca39ead2-955a-4596-9fad-3092b88f9d6d: Retrieved 0 invoice headers (total: 337) in 3ms with enhanced filtering
[2m2025-10-06T02:12:29.903532Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.903611Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mcbc02d8f-3535-451c-b0d2-58004c3c2ecd
[2m2025-10-06T02:12:29.903619Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cbc02d8f-3535-451c-b0d2-58004c3c2ecd: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-06T02:12:29.903627Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cbc02d8f-3535-451c-b0d2-58004c3c2ecd: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:29.903640Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cbc02d8f-3535-451c-b0d2-58004c3c2ecd: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.904856Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.904921Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m10db7ccd-6e2e-4715-986a-52230f2696ce
[2m2025-10-06T02:12:29.904928Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10db7ccd-6e2e-4715-986a-52230f2696ce: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-06T02:12:29.904934Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10db7ccd-6e2e-4715-986a-52230f2696ce: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:29.904941Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10db7ccd-6e2e-4715-986a-52230f2696ce: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.909433Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cbc02d8f-3535-451c-b0d2-58004c3c2ecd: Retrieved 100 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-06T02:12:29.911271Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:29.911368Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0md60ad881-43cf-4931-bfb7-ccbdc04e68ab
[2m2025-10-06T02:12:29.911414Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d60ad881-43cf-4931-bfb7-ccbdc04e68ab: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-06T02:12:29.911453Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d60ad881-43cf-4931-bfb7-ccbdc04e68ab: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:29.911477Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10db7ccd-6e2e-4715-986a-52230f2696ce: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-06T02:12:29.911485Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d60ad881-43cf-4931-bfb7-ccbdc04e68ab: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:29.915736Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d60ad881-43cf-4931-bfb7-ccbdc04e68ab: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:30.534134Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:30.534230Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m799f7d3c-7232-4347-a119-0234d35a3588
[2m2025-10-06T02:12:30.534251Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 799f7d3c-7232-4347-a119-0234d35a3588: Processing for user 1 with limit 100 offset 400 order_by date direction DESC
[2m2025-10-06T02:12:30.534260Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 799f7d3c-7232-4347-a119-0234d35a3588: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:30.534267Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 799f7d3c-7232-4347-a119-0234d35a3588: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:30.537359Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:30.537402Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m1bf676c9-4a5f-421e-8b00-36facf89779d
[2m2025-10-06T02:12:30.537409Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1bf676c9-4a5f-421e-8b00-36facf89779d: Processing for user 1 with limit 100 offset 500 order_by date direction DESC
[2m2025-10-06T02:12:30.537415Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1bf676c9-4a5f-421e-8b00-36facf89779d: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:30.537421Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1bf676c9-4a5f-421e-8b00-36facf89779d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:30.540582Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 799f7d3c-7232-4347-a119-0234d35a3588: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-06T02:12:30.541482Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:30.541527Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m308fb387-a756-45d5-bb94-c12af8620479
[2m2025-10-06T02:12:30.541534Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 308fb387-a756-45d5-bb94-c12af8620479: Processing for user 1 with limit 100 offset 300 order_by date direction DESC
[2m2025-10-06T02:12:30.541540Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 308fb387-a756-45d5-bb94-c12af8620479: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:30.541546Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 308fb387-a756-45d5-bb94-c12af8620479: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:30.541694Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1bf676c9-4a5f-421e-8b00-36facf89779d: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:30.546301Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 308fb387-a756-45d5-bb94-c12af8620479: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:31.072093Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:31.072284Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:31.072310Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m43e3d370-c57e-4673-9c3d-0a88d8e175ae
[2m2025-10-06T02:12:31.072388Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0f4c070c-6e6c-4dbe-b2e3-d0d9326083bf
[2m2025-10-06T02:12:31.072390Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 43e3d370-c57e-4673-9c3d-0a88d8e175ae: Processing for user 1 with limit 100 offset 700 order_by date direction DESC
[2m2025-10-06T02:12:31.072398Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0f4c070c-6e6c-4dbe-b2e3-d0d9326083bf: Processing for user 1 with limit 100 offset 600 order_by date direction DESC
[2m2025-10-06T02:12:31.072404Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 43e3d370-c57e-4673-9c3d-0a88d8e175ae: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:31.072409Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0f4c070c-6e6c-4dbe-b2e3-d0d9326083bf: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:31.072417Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 43e3d370-c57e-4673-9c3d-0a88d8e175ae: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:31.072424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0f4c070c-6e6c-4dbe-b2e3-d0d9326083bf: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:31.075070Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:31.075116Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mdf6b9bfd-2d60-4ab7-80ad-d7be54eee8b6
[2m2025-10-06T02:12:31.075123Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request df6b9bfd-2d60-4ab7-80ad-d7be54eee8b6: Processing for user 1 with limit 100 offset 800 order_by date direction DESC
[2m2025-10-06T02:12:31.075130Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request df6b9bfd-2d60-4ab7-80ad-d7be54eee8b6: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:31.075165Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request df6b9bfd-2d60-4ab7-80ad-d7be54eee8b6: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:31.077205Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 43e3d370-c57e-4673-9c3d-0a88d8e175ae: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:31.078449Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0f4c070c-6e6c-4dbe-b2e3-d0d9326083bf: Retrieved 100 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-06T02:12:31.079293Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request df6b9bfd-2d60-4ab7-80ad-d7be54eee8b6: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:31.668892Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:31.668964Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m53a145c5-6027-48b8-8a7a-7b5be04c80a0
[2m2025-10-06T02:12:31.668975Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 53a145c5-6027-48b8-8a7a-7b5be04c80a0: Processing for user 1 with limit 100 offset 900 order_by date direction DESC
[2m2025-10-06T02:12:31.668985Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 53a145c5-6027-48b8-8a7a-7b5be04c80a0: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:31.668997Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 53a145c5-6027-48b8-8a7a-7b5be04c80a0: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:31.673240Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 53a145c5-6027-48b8-8a7a-7b5be04c80a0: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:31.676567Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:31.676619Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0md57db465-1572-497f-82d2-c0d6763e5f66
[2m2025-10-06T02:12:31.676629Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d57db465-1572-497f-82d2-c0d6763e5f66: Processing for user 1 with limit 100 offset 1000 order_by date direction DESC
[2m2025-10-06T02:12:31.676638Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d57db465-1572-497f-82d2-c0d6763e5f66: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:31.676647Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d57db465-1572-497f-82d2-c0d6763e5f66: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:31.678228Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:31.678272Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mae5b32c6-1646-4f72-8e39-2700f9c366d9
[2m2025-10-06T02:12:31.678281Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae5b32c6-1646-4f72-8e39-2700f9c366d9: Processing for user 1 with limit 100 offset 1100 order_by date direction DESC
[2m2025-10-06T02:12:31.678288Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae5b32c6-1646-4f72-8e39-2700f9c366d9: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:31.678296Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae5b32c6-1646-4f72-8e39-2700f9c366d9: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:31.680513Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d57db465-1572-497f-82d2-c0d6763e5f66: Retrieved 100 invoice details (total: 2526) in 3ms with enhanced pagination
[2m2025-10-06T02:12:31.685562Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae5b32c6-1646-4f72-8e39-2700f9c366d9: Retrieved 100 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-06T02:12:32.406317Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:32.406376Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:32.406400Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0fa6f4ee-0b69-409e-9e8d-cd4411864b23
[2m2025-10-06T02:12:32.406408Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0fa6f4ee-0b69-409e-9e8d-cd4411864b23: Processing for user 1 with limit 100 offset 1200 order_by date direction DESC
[2m2025-10-06T02:12:32.406410Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma6d8f8c8-5031-4765-8eb4-7148db69b774
[2m2025-10-06T02:12:32.406416Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0fa6f4ee-0b69-409e-9e8d-cd4411864b23: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:32.406418Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a6d8f8c8-5031-4765-8eb4-7148db69b774: Processing for user 1 with limit 100 offset 1300 order_by date direction DESC
[2m2025-10-06T02:12:32.406424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a6d8f8c8-5031-4765-8eb4-7148db69b774: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:32.406424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0fa6f4ee-0b69-409e-9e8d-cd4411864b23: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:32.406431Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a6d8f8c8-5031-4765-8eb4-7148db69b774: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:32.407658Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:32.407835Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma62e0415-069d-4e29-bfe1-1dce5ece44c3
[2m2025-10-06T02:12:32.407914Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a62e0415-069d-4e29-bfe1-1dce5ece44c3: Processing for user 1 with limit 100 offset 1400 order_by date direction DESC
[2m2025-10-06T02:12:32.407925Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a62e0415-069d-4e29-bfe1-1dce5ece44c3: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:32.407933Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a62e0415-069d-4e29-bfe1-1dce5ece44c3: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:32.413417Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a6d8f8c8-5031-4765-8eb4-7148db69b774: Retrieved 100 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-06T02:12:32.415127Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0fa6f4ee-0b69-409e-9e8d-cd4411864b23: Retrieved 100 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-06T02:12:32.415240Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a62e0415-069d-4e29-bfe1-1dce5ece44c3: Retrieved 100 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-06T02:12:33.107431Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:33.107491Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:33.107512Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m64d208c3-897f-49b7-8b98-1c934d16e906
[2m2025-10-06T02:12:33.107520Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64d208c3-897f-49b7-8b98-1c934d16e906: Processing for user 1 with limit 100 offset 1600 order_by date direction DESC
[2m2025-10-06T02:12:33.107524Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m4c81114e-7f38-4541-98c1-37a96a5c24e9
[2m2025-10-06T02:12:33.107528Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64d208c3-897f-49b7-8b98-1c934d16e906: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:33.107560Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64d208c3-897f-49b7-8b98-1c934d16e906: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:33.107531Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4c81114e-7f38-4541-98c1-37a96a5c24e9: Processing for user 1 with limit 100 offset 1500 order_by date direction DESC
[2m2025-10-06T02:12:33.107746Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4c81114e-7f38-4541-98c1-37a96a5c24e9: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:33.107856Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4c81114e-7f38-4541-98c1-37a96a5c24e9: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:33.110826Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:33.110893Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m30212196-4b71-4790-9c9b-2dbf20281f3e
[2m2025-10-06T02:12:33.110900Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30212196-4b71-4790-9c9b-2dbf20281f3e: Processing for user 1 with limit 100 offset 1700 order_by date direction DESC
[2m2025-10-06T02:12:33.110906Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30212196-4b71-4790-9c9b-2dbf20281f3e: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:33.110912Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30212196-4b71-4790-9c9b-2dbf20281f3e: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:33.116232Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4c81114e-7f38-4541-98c1-37a96a5c24e9: Retrieved 100 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-06T02:12:33.117184Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64d208c3-897f-49b7-8b98-1c934d16e906: Retrieved 100 invoice details (total: 2526) in 9ms with enhanced pagination
[2m2025-10-06T02:12:33.118621Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30212196-4b71-4790-9c9b-2dbf20281f3e: Retrieved 100 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-06T02:12:33.745702Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:33.745774Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m96869af3-44b4-431c-9047-bc6e53544e09
[2m2025-10-06T02:12:33.745796Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96869af3-44b4-431c-9047-bc6e53544e09: Processing for user 1 with limit 100 offset 1800 order_by date direction DESC
[2m2025-10-06T02:12:33.745804Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96869af3-44b4-431c-9047-bc6e53544e09: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:33.745812Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96869af3-44b4-431c-9047-bc6e53544e09: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:33.750749Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96869af3-44b4-431c-9047-bc6e53544e09: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:33.752488Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:33.752528Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m189e9325-7f00-46d4-8b6f-dcb785288ae7
[2m2025-10-06T02:12:33.752534Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 189e9325-7f00-46d4-8b6f-dcb785288ae7: Processing for user 1 with limit 100 offset 1900 order_by date direction DESC
[2m2025-10-06T02:12:33.752540Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 189e9325-7f00-46d4-8b6f-dcb785288ae7: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:33.752546Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 189e9325-7f00-46d4-8b6f-dcb785288ae7: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:33.755382Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:33.755425Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m07f88ece-a06a-472f-8b1c-9b96fd161e58
[2m2025-10-06T02:12:33.755433Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 07f88ece-a06a-472f-8b1c-9b96fd161e58: Processing for user 1 with limit 100 offset 2000 order_by date direction DESC
[2m2025-10-06T02:12:33.755439Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 07f88ece-a06a-472f-8b1c-9b96fd161e58: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:33.755445Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 07f88ece-a06a-472f-8b1c-9b96fd161e58: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:33.757494Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 189e9325-7f00-46d4-8b6f-dcb785288ae7: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:33.760030Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 07f88ece-a06a-472f-8b1c-9b96fd161e58: Retrieved 100 invoice details (total: 2526) in 4ms with enhanced pagination
[2m2025-10-06T02:12:34.387650Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:34.387719Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mc5280793-2ab8-4b83-a5d6-7aca71f0abfc
[2m2025-10-06T02:12:34.387729Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5280793-2ab8-4b83-a5d6-7aca71f0abfc: Processing for user 1 with limit 100 offset 2300 order_by date direction DESC
[2m2025-10-06T02:12:34.387744Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5280793-2ab8-4b83-a5d6-7aca71f0abfc: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:34.387758Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5280793-2ab8-4b83-a5d6-7aca71f0abfc: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:34.391426Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:34.391467Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5d076162-d650-4fca-86e1-31132a48751d
[2m2025-10-06T02:12:34.391473Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5d076162-d650-4fca-86e1-31132a48751d: Processing for user 1 with limit 100 offset 2200 order_by date direction DESC
[2m2025-10-06T02:12:34.391479Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5d076162-d650-4fca-86e1-31132a48751d: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:34.391485Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5d076162-d650-4fca-86e1-31132a48751d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:34.391587Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:34.391617Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m82ca559d-5a04-4e63-a354-b2726e8a2df8
[2m2025-10-06T02:12:34.391623Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82ca559d-5a04-4e63-a354-b2726e8a2df8: Processing for user 1 with limit 100 offset 2100 order_by date direction DESC
[2m2025-10-06T02:12:34.391628Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82ca559d-5a04-4e63-a354-b2726e8a2df8: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:34.391646Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82ca559d-5a04-4e63-a354-b2726e8a2df8: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:34.393339Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c5280793-2ab8-4b83-a5d6-7aca71f0abfc: Retrieved 100 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-06T02:12:34.397397Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82ca559d-5a04-4e63-a354-b2726e8a2df8: Retrieved 100 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-06T02:12:34.399640Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5d076162-d650-4fca-86e1-31132a48751d: Retrieved 100 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-06T02:12:34.993812Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:34.993905Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m6ca12f7b-1a48-4632-bd4e-32d4bfc83819
[2m2025-10-06T02:12:34.993916Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ca12f7b-1a48-4632-bd4e-32d4bfc83819: Processing for user 1 with limit 100 offset 2400 order_by date direction DESC
[2m2025-10-06T02:12:34.993926Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ca12f7b-1a48-4632-bd4e-32d4bfc83819: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:34.993936Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ca12f7b-1a48-4632-bd4e-32d4bfc83819: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:34.995138Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:34.995208Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf0081c30-f98d-499c-b7e8-8e1b92866574
[2m2025-10-06T02:12:34.995224Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f0081c30-f98d-499c-b7e8-8e1b92866574: Processing for user 1 with limit 100 offset 2600 order_by date direction DESC
[2m2025-10-06T02:12:34.995236Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f0081c30-f98d-499c-b7e8-8e1b92866574: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:34.995247Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f0081c30-f98d-499c-b7e8-8e1b92866574: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:34.999033Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6ca12f7b-1a48-4632-bd4e-32d4bfc83819: Retrieved 100 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-06T02:12:34.999713Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:34.999756Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m91f6500b-0132-41dc-9b92-cb3af74aca9d
[2m2025-10-06T02:12:34.999763Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91f6500b-0132-41dc-9b92-cb3af74aca9d: Processing for user 1 with limit 100 offset 2500 order_by date direction DESC
[2m2025-10-06T02:12:34.999769Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91f6500b-0132-41dc-9b92-cb3af74aca9d: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:34.999775Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91f6500b-0132-41dc-9b92-cb3af74aca9d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:35.002016Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f0081c30-f98d-499c-b7e8-8e1b92866574: Retrieved 0 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-06T02:12:35.006259Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91f6500b-0132-41dc-9b92-cb3af74aca9d: Retrieved 26 invoice details (total: 2526) in 6ms with enhanced pagination
[2m2025-10-06T02:12:35.564017Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:35.564102Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m870a44ba-3f87-4e0a-b228-e71fcd27f01e
[2m2025-10-06T02:12:35.564111Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 870a44ba-3f87-4e0a-b228-e71fcd27f01e: Processing for user 1 with limit 100 offset 2700 order_by date direction DESC
[2m2025-10-06T02:12:35.564119Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 870a44ba-3f87-4e0a-b228-e71fcd27f01e: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:35.564129Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 870a44ba-3f87-4e0a-b228-e71fcd27f01e: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:35.569344Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 870a44ba-3f87-4e0a-b228-e71fcd27f01e: Retrieved 0 invoice details (total: 2526) in 5ms with enhanced pagination
[2m2025-10-06T02:12:35.571947Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:35.571991Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m30229daa-d670-44a7-a6e9-daea0f3f5dd4
[2m2025-10-06T02:12:35.572010Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30229daa-d670-44a7-a6e9-daea0f3f5dd4: Processing for user 1 with limit 100 offset 2800 order_by date direction DESC
[2m2025-10-06T02:12:35.572017Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30229daa-d670-44a7-a6e9-daea0f3f5dd4: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:35.572024Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30229daa-d670-44a7-a6e9-daea0f3f5dd4: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:35.573577Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:35.573623Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m12483dc7-fe3b-467e-99aa-73528a07485d
[2m2025-10-06T02:12:35.573630Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 12483dc7-fe3b-467e-99aa-73528a07485d: Processing for user 1 with limit 100 offset 2900 order_by date direction DESC
[2m2025-10-06T02:12:35.573642Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 12483dc7-fe3b-467e-99aa-73528a07485d: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:35.573649Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 12483dc7-fe3b-467e-99aa-73528a07485d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:35.580378Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30229daa-d670-44a7-a6e9-daea0f3f5dd4: Retrieved 0 invoice details (total: 2526) in 8ms with enhanced pagination
[2m2025-10-06T02:12:35.581450Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 12483dc7-fe3b-467e-99aa-73528a07485d: Retrieved 0 invoice details (total: 2526) in 7ms with enhanced pagination
[2m2025-10-06T02:12:36.790211Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:36.790296Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0maad6eff4-f4c8-424f-8951-8b387b8ff88a
[2m2025-10-06T02:12:36.790305Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aad6eff4-f4c8-424f-8951-8b387b8ff88a: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-06T02:12:36.790318Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aad6eff4-f4c8-424f-8951-8b387b8ff88a: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:36.791792Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aad6eff4-f4c8-424f-8951-8b387b8ff88a: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-06T02:12:36.795556Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:36.795604Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mcd8d576d-6ec3-4764-a98b-facb77967bf5
[2m2025-10-06T02:12:36.795613Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd8d576d-6ec3-4764-a98b-facb77967bf5: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-06T02:12:36.795623Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd8d576d-6ec3-4764-a98b-facb77967bf5: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:36.796679Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd8d576d-6ec3-4764-a98b-facb77967bf5: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-06T02:12:36.797656Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:36.797726Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mb760e0e2-ffcd-41a2-8a9c-2fbd59658e32
[2m2025-10-06T02:12:36.797734Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b760e0e2-ffcd-41a2-8a9c-2fbd59658e32: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-06T02:12:36.797745Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b760e0e2-ffcd-41a2-8a9c-2fbd59658e32: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:36.798777Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b760e0e2-ffcd-41a2-8a9c-2fbd59658e32: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-06T02:12:36.992234Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:36.992328Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me1b88183-eeca-4a5a-9274-840e2d395e6d
[2m2025-10-06T02:12:36.992341Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1b88183-eeca-4a5a-9274-840e2d395e6d: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-06T02:12:36.992351Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1b88183-eeca-4a5a-9274-840e2d395e6d: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:36.992362Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1b88183-eeca-4a5a-9274-840e2d395e6d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:36.992376Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:36.992444Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m96ae2446-e145-4fb4-98d8-2810f47f955e
[2m2025-10-06T02:12:36.992463Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96ae2446-e145-4fb4-98d8-2810f47f955e: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-06T02:12:36.992471Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96ae2446-e145-4fb4-98d8-2810f47f955e: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:36.992479Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96ae2446-e145-4fb4-98d8-2810f47f955e: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:36.994403Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T02:12:36.994473Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0edad84a-3f57-4447-841a-ef6185194181
[2m2025-10-06T02:12:36.994482Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0edad84a-3f57-4447-841a-ef6185194181: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-06T02:12:36.994489Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0edad84a-3f57-4447-841a-ef6185194181: Querying details for user 1 with enhanced filters
[2m2025-10-06T02:12:36.994521Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0edad84a-3f57-4447-841a-ef6185194181: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T02:12:36.994632Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1b88183-eeca-4a5a-9274-840e2d395e6d: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-06T02:12:36.994901Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 96ae2446-e145-4fb4-98d8-2810f47f955e: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-06T02:12:36.996491Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0edad84a-3f57-4447-841a-ef6185194181: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-06T02:39:19.532334Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 08f32676-8944-42ff-a995-f99f21ab6a13: Root endpoint accessed
[2m2025-10-06T04:47:18.798626Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 9e8f7159-6300-4a63-9ded-065271fbccf4: Root endpoint accessed
[2m2025-10-06T04:47:19.084213Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-06T09:08:37.248168Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request ea3f516d-f84c-49d9-89e1-7548c79269ea: Root endpoint accessed
[2m2025-10-06T09:09:03.987137Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-06T09:09:09.296193Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 0cdd4e5e-09fd-41dc-bcee-94e329574402: Root endpoint accessed
[2m2025-10-06T09:09:12.491606Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-06T09:26:02.455655Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 877c7e1c-23eb-49f1-82b2-441485f148db: Root endpoint accessed
[2m2025-10-06T09:26:35.347401Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 40d76d9e-29b2-43bd-8344-874b927dce37: Root endpoint accessed
[2m2025-10-06T09:26:36.131657Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-06T09:26:43.647185Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 72e8d29c-5f67-45f1-9218-179f5f97822a: Root endpoint accessed
[2m2025-10-06T10:35:21.512732Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:21.512824Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:21.512841Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T10:35:21.515351Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T10:35:22.382667Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:22.382744Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T10:35:22.384284Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T10:35:22.885897Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:22.885988Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3b6efddd-4be5-4710-9256-c0cbdd0ae668
[2m2025-10-06T10:35:22.885996Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3b6efddd-4be5-4710-9256-c0cbdd0ae668: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-06T10:35:22.886007Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3b6efddd-4be5-4710-9256-c0cbdd0ae668: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T10:35:22.889491Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3b6efddd-4be5-4710-9256-c0cbdd0ae668: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-06T10:35:23.248554Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:23.248647Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m97ff1633-ad4e-4900-ac43-aa1ecbd62e71
[2m2025-10-06T10:35:23.248655Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 97ff1633-ad4e-4900-ac43-aa1ecbd62e71: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-06T10:35:23.248666Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 97ff1633-ad4e-4900-ac43-aa1ecbd62e71: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T10:35:23.250596Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:23.250708Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m322325cb-94c2-4dc8-9653-ccecdaaaa2a7
[2m2025-10-06T10:35:23.250718Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 322325cb-94c2-4dc8-9653-ccecdaaaa2a7: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-06T10:35:23.250732Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 322325cb-94c2-4dc8-9653-ccecdaaaa2a7: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T10:35:23.252757Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 97ff1633-ad4e-4900-ac43-aa1ecbd62e71: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-06T10:35:23.255353Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 322325cb-94c2-4dc8-9653-ccecdaaaa2a7: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-06T10:35:23.444323Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:23.444390Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m8d13bf6e-5975-465f-89f0-938c87579e3a
[2m2025-10-06T10:35:23.444412Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8d13bf6e-5975-465f-89f0-938c87579e3a: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-06T10:35:23.444420Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8d13bf6e-5975-465f-89f0-938c87579e3a: Querying details for user 1 with enhanced filters
[2m2025-10-06T10:35:23.444429Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8d13bf6e-5975-465f-89f0-938c87579e3a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T10:35:23.445416Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:23.445507Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m3dc6deaa-abdd-45e7-ae0b-43284b339596
[2m2025-10-06T10:35:23.445525Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3dc6deaa-abdd-45e7-ae0b-43284b339596: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-06T10:35:23.445545Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3dc6deaa-abdd-45e7-ae0b-43284b339596: Querying details for user 1 with enhanced filters
[2m2025-10-06T10:35:23.445580Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3dc6deaa-abdd-45e7-ae0b-43284b339596: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T10:35:23.445506Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:23.445826Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf25314a1-5f71-440c-9506-5279d5e5b3bb
[2m2025-10-06T10:35:23.445835Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f25314a1-5f71-440c-9506-5279d5e5b3bb: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-06T10:35:23.445841Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f25314a1-5f71-440c-9506-5279d5e5b3bb: Querying details for user 1 with enhanced filters
[2m2025-10-06T10:35:23.445848Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f25314a1-5f71-440c-9506-5279d5e5b3bb: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T10:35:23.448569Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 8d13bf6e-5975-465f-89f0-938c87579e3a: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-06T10:35:23.449783Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3dc6deaa-abdd-45e7-ae0b-43284b339596: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-06T10:35:23.451533Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f25314a1-5f71-440c-9506-5279d5e5b3bb: Retrieved 0 invoice details (total: 0) in 5ms with enhanced pagination
[2m2025-10-06T10:35:24.544963Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:24.545028Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T10:35:24.546262Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T10:35:34.393977Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:34.394040Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:34.394061Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-06T10:35:34.398223Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 4ms for user_id: 1 - 20 items
[2m2025-10-06T10:35:34.420216Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:34.420268Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:34.420290Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-06T10:35:34.424277Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 3ms for user_id: 1 - 20 items
[2m2025-10-06T10:35:34.446735Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:34.446835Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T10:35:34.446745Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:34.446997Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:34.447024Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-06T10:35:34.447925Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T10:35:34.452033Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 5ms for user_id: 1 - 20 items
[2m2025-10-06T10:35:54.196343Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:54.196427Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:54.196461Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-06T10:35:54.199208Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 2ms for user_id: 1 - 20 items
[2m2025-10-06T10:35:54.483823Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:35:54.483914Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T10:35:54.484978Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T10:36:07.504745Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:36:07.504825Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T10:36:07.505408Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-06T10:36:09.877215Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:36:09.877284Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T10:36:09.878250Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-06T10:36:14.265368Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:36:14.265436Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T10:36:14.266088Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 295 LÃ¼mis
[2m2025-10-06T10:37:39.377920Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:37:39.377997Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T10:37:39.378017Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T10:37:39.378912Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T11:33:17.851327Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 83ae12ba-dff4-4b62-bca3-de185a3cfe1d: Root endpoint accessed
[2m2025-10-06T11:33:21.158453Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request f17d8beb-6fbf-440a-bcc4-bbf6a9abe96e: Root endpoint accessed
[2m2025-10-06T11:33:21.459766Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-06T11:33:25.141608Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 3dfcc329-21e7-433e-b66e-231357304b9f: Root endpoint accessed
[2m2025-10-06T11:48:51.287325Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:51.287433Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:51.287484Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-06T11:48:51.289752Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-06T11:48:52.566307Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:52.566365Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-06T11:48:52.568090Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 295 LÃ¼mis
[2m2025-10-06T11:48:53.098359Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:53.098462Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mefa67354-44b0-42bd-a16b-fcddfb0ad934
[2m2025-10-06T11:48:53.098471Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request efa67354-44b0-42bd-a16b-fcddfb0ad934: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-06T11:48:53.098483Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request efa67354-44b0-42bd-a16b-fcddfb0ad934: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T11:48:53.102540Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request efa67354-44b0-42bd-a16b-fcddfb0ad934: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-06T11:48:53.413472Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:53.413550Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m0ac58bc6-d209-419c-ad2a-ffad14a4ab7b
[2m2025-10-06T11:48:53.413558Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0ac58bc6-d209-419c-ad2a-ffad14a4ab7b: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-06T11:48:53.413568Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0ac58bc6-d209-419c-ad2a-ffad14a4ab7b: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T11:48:53.417143Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0ac58bc6-d209-419c-ad2a-ffad14a4ab7b: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-06T11:48:53.419843Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:53.419888Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m98f33d4b-53f7-4f5d-9979-f93413a4a4a4
[2m2025-10-06T11:48:53.419895Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 98f33d4b-53f7-4f5d-9979-f93413a4a4a4: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-06T11:48:53.419906Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 98f33d4b-53f7-4f5d-9979-f93413a4a4a4: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            '' as issuer_ruc,
            '' as issuer_dv,
            '' as issuer_address,
            '' as issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T11:48:53.422967Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 98f33d4b-53f7-4f5d-9979-f93413a4a4a4: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-06T11:48:53.591996Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:53.592078Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mda962e13-1a58-4813-93fa-9fae15650504
[2m2025-10-06T11:48:53.592088Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request da962e13-1a58-4813-93fa-9fae15650504: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-06T11:48:53.592110Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request da962e13-1a58-4813-93fa-9fae15650504: Querying details for user 1 with enhanced filters
[2m2025-10-06T11:48:53.592118Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request da962e13-1a58-4813-93fa-9fae15650504: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T11:48:53.592356Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:53.592438Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m194527a3-096a-4918-ac1f-a0c81025096d
[2m2025-10-06T11:48:53.592451Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 194527a3-096a-4918-ac1f-a0c81025096d: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-06T11:48:53.592462Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 194527a3-096a-4918-ac1f-a0c81025096d: Querying details for user 1 with enhanced filters
[2m2025-10-06T11:48:53.592475Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 194527a3-096a-4918-ac1f-a0c81025096d: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T11:48:53.594230Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:53.594319Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m98563888-45ac-47f0-b37e-e2cbef25ef05
[2m2025-10-06T11:48:53.594374Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 98563888-45ac-47f0-b37e-e2cbef25ef05: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-06T11:48:53.594476Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 98563888-45ac-47f0-b37e-e2cbef25ef05: Querying details for user 1 with enhanced filters
[2m2025-10-06T11:48:53.594546Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 98563888-45ac-47f0-b37e-e2cbef25ef05: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-06T11:48:53.597599Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 194527a3-096a-4918-ac1f-a0c81025096d: Retrieved 0 invoice details (total: 0) in 5ms with enhanced pagination
[2m2025-10-06T11:48:53.599350Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request da962e13-1a58-4813-93fa-9fae15650504: Retrieved 0 invoice details (total: 0) in 7ms with enhanced pagination
[2m2025-10-06T11:48:53.601395Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 98563888-45ac-47f0-b37e-e2cbef25ef05: Retrieved 0 invoice details (total: 0) in 7ms with enhanced pagination
[2m2025-10-06T11:48:57.157214Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:57.157317Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 1: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU
[2m2025-10-06T11:48:57.157330Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU
[2m2025-10-06T11:48:57.157341Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU
[2m2025-10-06T11:48:58.137125Z[0m [31mERROR[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Failed to fetch HTML: HTTP error: 500 Internal Server Error
[2m2025-10-06T11:48:58.137203Z[0m [33m WARN[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Scraping failed for URL 'https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU', not persisting: Failed to fetch HTML: HTTP error: 500 Internal Server Error
[2m2025-10-06T11:48:59.549013Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m ðŸ” JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-06T11:48:59.549102Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 1: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU
[2m2025-10-06T11:48:59.549114Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU
[2m2025-10-06T11:48:59.549143Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU
[2m2025-10-06T11:48:59.922774Z[0m [31mERROR[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Failed to fetch HTML: HTTP error: 500 Internal Server Error
[2m2025-10-06T11:48:59.922839Z[0m [33m WARN[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Scraping failed for URL 'https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE0120000155726213-2-2022-2200042025100200000779040010117836161820&iAmb=1&digestValue=XfYmkZ1DaZfyQ5YJL9wBkKu8enYs9YiMahgPXohCpfA=&jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTU1NzI2MjEzLTItMjAyMi0yMjAwMDQyMDI1MTAwMjAwMDAwNzc5MDQwMDEwMTE3ODM2MTYxODIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IlhmWW1rWjFEYVpmeVE1WUpMOXdCa0t1OGVuWXM5WWlNYWhnUFhvaENwZkE9In0.pmebfIt3zamE8bCR1ENboIhH443gZUg_2GpCMK14vzU', not persisting: Failed to fetch HTML: HTTP error: 500 Internal Server Error
[2m2025-10-06T11:50:40.147419Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m signal received, starting graceful shutdown
