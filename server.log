nohup: ignoring input
[2m2025-10-08T19:11:02.730445Z[0m [32m INFO[0m [2mlum_rust_ws::monitoring[0m[2m:[0m üîç Monitoring system initialized
[2m2025-10-08T19:11:02.730489Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m üîç Monitoring system initialized
[2m2025-10-08T19:11:02.730502Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m üîß Creating optimized database pool with 50 max connections
[2m2025-10-08T19:11:03.086903Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m ‚úÖ Database pool created successfully
[2m2025-10-08T19:11:03.086958Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m üîß Creating optimized Redis client
[2m2025-10-08T19:11:03.086992Z[0m [32m INFO[0m [2mlum_rust_ws::optimization[0m[2m:[0m ‚úÖ Redis client created successfully
[2m2025-10-08T19:11:03.142656Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::service[0m[2m:[0m üöÄ Initializing optimized hybrid QR service (2-level cascade)
[2m2025-10-08T19:11:03.142872Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::service[0m[2m:[0m üìä Expected performance: 85% success with Rust (5-15ms), 12% with Python fallback (30-50ms)
[2m2025-10-08T19:11:03.142972Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m üöÄ Initializing PerformanceManager with advanced configuration
[2m2025-10-08T19:11:03.143045Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m üìä QR Detection: 50 max concurrent
[2m2025-10-08T19:11:03.143108Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m üìä OCR Processing: 20 max concurrent
[2m2025-10-08T19:11:03.143205Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m üìä Webhook Processing: 100 max concurrent
[2m2025-10-08T19:11:03.143277Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m üìä API Requests: 200 max concurrent
[2m2025-10-08T19:11:03.143411Z[0m [32m INFO[0m [2mlum_rust_ws::webhook::deduplication[0m[2m:[0m üîÑ MessageDeduplicator initialized with TTL: 300s, max_entries: 10000
[2m2025-10-08T19:11:03.143530Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m üî• Starting performance warm-up process...
[2m2025-10-08T19:11:03.145460Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ‚úÖ Database connection verified
[2m2025-10-08T19:11:03.145909Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m ‚úÖ Redis connection verified
[2m2025-10-08T19:11:03.146072Z[0m [32m INFO[0m [2mlum_rust_ws::shared::performance[0m[2m:[0m üî• Performance warm-up completed
[2m2025-10-08T19:11:03.146197Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m üöÄ Application state initialized with optimized configuration
[2m2025-10-08T19:11:03.146288Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::rust_qreader[0m[2m:[0m üîß Initializing RustQReader with ONNX: "models/qreader_detector_small.onnx"
[2m2025-10-08T19:11:03.160617Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Session Options {  execution_mode:0 execution_order:DEFAULT enable_profiling:0 optimized_model_filepath:"" enable_mem_pattern:1 enable_mem_reuse:1 enable_cpu_mem_arena:1 profile_file_prefix:onnxruntime_profile_ session_logid: session_log_severity_level:-1 session_log_verbosity_level:0 max_num_graph_transformation_steps:10 graph_optimization_level:3 intra_op_param:OrtThreadPoolParams { thread_pool_size: 0 auto_set_affinity: 0 allow_spinning: 1 dynamic_block_base_: 0 stack_size: 0 affinity_str:  set_denormal_as_zero: 0 } inter_op_param:OrtThreadPoolParams { thread_pool_size: 0 auto_set_affinity: 0 allow_spinning: 1 dynamic_block_base_: 0 stack_size: 0 affinity_str:  set_denormal_as_zero: 0 } use_per_session_threads:1 thread_pool_allow_spinning:1 use_deterministic_compute:0 ep_selection_policy:0 config_options: {  } }
[2m2025-10-08T19:11:03.160757Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Flush-to-zero and denormal-as-zero are off
[2m2025-10-08T19:11:03.160862Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Creating and using per session threadpools since use_per_session_threads_ is true
[2m2025-10-08T19:11:03.160962Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Dynamic block base set to 0
[2m2025-10-08T19:11:03.239847Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Initializing session.
[2m2025-10-08T19:11:03.239896Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Adding default CPU execution provider.
[2m2025-10-08T19:11:03.239929Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Creating BFCArena for Cpu with following configs: initial_chunk_size_bytes: 1048576 max_dead_bytes_per_chunk: 134217728 initial_growth_chunk_size_bytes: 2097152 max_power_of_two_extend_bytes: 1073741824 memory limit: 18446744073709551615 arena_extend_strategy: 0
[2m2025-10-08T19:11:03.242225Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m This model does not have any local functions defined. AOT Inlining is not performed
[2m2025-10-08T19:11:03.242383Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EnsureUniqueDQForNodeUnit modified: 0 with status: OK
[2m2025-10-08T19:11:03.242594Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level1_RuleBasedTransformer modified: 1 with status: OK
[2m2025-10-08T19:11:03.244539Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Constant_61_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244569Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.18/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244577Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.12/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244584Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.4/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244596Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.2/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244603Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.6/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244608Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.8/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244614Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.15/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244620Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.21/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.244774Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DoubleQDQPairsRemover modified: 0 with status: OK
[2m2025-10-08T19:11:03.245126Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total shared scalar initializer count: 92
[2m2025-10-08T19:11:03.245166Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConstantSharing modified: 1 with status: OK
[2m2025-10-08T19:11:03.247399Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer CommonSubexpressionElimination modified: 1 with status: OK
[2m2025-10-08T19:11:03.249417Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConstantFolding modified: 1 with status: OK
[2m2025-10-08T19:11:03.251085Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Split_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.251112Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Split_output_1'. It is no longer used by any node.
[2m2025-10-08T19:11:03.251129Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Constant_14_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.251135Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Split_output_2'. It is no longer used by any node.
[2m2025-10-08T19:11:03.251286Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulAddFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.251421Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/dfl/Reshape_output_0
[2m2025-10-08T19:11:03.251445Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_18_output_0
[2m2025-10-08T19:11:03.251454Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_19_output_0
[2m2025-10-08T19:11:03.251464Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_13_output_0
[2m2025-10-08T19:11:03.251473Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_14_output_0
[2m2025-10-08T19:11:03.251482Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_8_output_0
[2m2025-10-08T19:11:03.251507Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_9_output_0
[2m2025-10-08T19:11:03.251516Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total fused reshape node count: 7
[2m2025-10-08T19:11:03.251521Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ReshapeFusion modified: 1 with status: OK
[2m2025-10-08T19:11:03.253139Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/dfl/Constant_3_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.253230Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FreeDimensionOverrideTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.253242Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.253251Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.253387Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQPropagationTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.253525Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer WeightBiasQuantization modified: 0 with status: OK
[2m2025-10-08T19:11:03.253622Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EnsureUniqueDQForNodeUnit modified: 0 with status: OK
[2m2025-10-08T19:11:03.253703Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer RocmBlasAltImpl modified: 0 with status: OK
[2m2025-10-08T19:11:03.254079Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer TransposeOptimizer modified: 0 with status: OK
[2m2025-10-08T19:11:03.254238Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level1_RuleBasedTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.254325Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DoubleQDQPairsRemover modified: 0 with status: OK
[2m2025-10-08T19:11:03.254664Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer CommonSubexpressionElimination modified: 0 with status: OK
[2m2025-10-08T19:11:03.254825Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConstantFolding modified: 0 with status: OK
[2m2025-10-08T19:11:03.254907Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulAddFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.254998Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ReshapeFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.255013Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FreeDimensionOverrideTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.255019Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.255024Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.255113Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQPropagationTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.255239Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer WeightBiasQuantization modified: 0 with status: OK
[2m2025-10-08T19:11:03.255329Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EnsureUniqueDQForNodeUnit modified: 0 with status: OK
[2m2025-10-08T19:11:03.255410Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer RocmBlasAltImpl modified: 0 with status: OK
[2m2025-10-08T19:11:03.256129Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level2_RuleBasedTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.256556Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer TransposeOptimizer_CPUExecutionProvider modified: 0 with status: OK
[2m2025-10-08T19:11:03.256655Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQS8ToU8Transformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.256871Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQSelectorActionTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.256955Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GemmActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257040Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulIntegerToFloatFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257121Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DynamicQuantizeMatMulFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257248Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257338Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.257461Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.257581Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SimplifiedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257670Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer AttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257752Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EmbedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257767Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherSliceToSplitFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257853Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherToSliceFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.257937Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatmulTransposeFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.258066Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.258168Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GroupQueryAttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.258260Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SkipLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.258358Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FastGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.258662Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QuickGeluFusion modified: 1 with status: OK
[2m2025-10-08T19:11:03.260379Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasSoftmaxFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.260468Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasDropoutFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.260573Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulScaleFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.260672Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.260780Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulNBitsFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.260876Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQFinalCleanupTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.260950Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level2_RuleBasedTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.261028Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQS8ToU8Transformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.261201Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQSelectorActionTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.261320Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GemmActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.261403Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulIntegerToFloatFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.261481Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DynamicQuantizeMatMulFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.261598Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.261672Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.261740Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.261868Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SimplifiedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.261939Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer AttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262010Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EmbedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262023Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherSliceToSplitFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262084Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherToSliceFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262171Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatmulTransposeFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262248Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262308Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GroupQueryAttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262388Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SkipLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262459Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FastGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262531Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QuickGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262595Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasSoftmaxFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262655Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasDropoutFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262725Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulScaleFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262783Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262889Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulNBitsFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.262959Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQFinalCleanupTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.320551Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NchwcTransformer modified: 1 with status: OK
[2m2025-10-08T19:11:03.324325Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1144'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324356Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1210'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324367Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1198'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324374Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1207'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324379Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1258'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324385Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1228'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324390Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1168'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324394Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1156'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324400Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1141'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324405Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1132'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324411Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1138'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324415Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1267'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324423Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1090'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324432Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1162'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324440Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.1.2.bias'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324450Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv4.2.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324459Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1189'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324465Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1192'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324470Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1177'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324476Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1240'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324481Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv4.1.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324487Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1153'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324492Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1135'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324497Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1096'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324503Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1147'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324541Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1099'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324551Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv4.0.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324557Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1123'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324563Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.dfl.conv.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324569Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1186'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324574Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1120'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324579Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1180'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324584Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.1.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324590Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1102'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324596Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.0.2.bias'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324603Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1225'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324612Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1255'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324635Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.0.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324644Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1159'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324650Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1231'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324656Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1081'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324661Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1111'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324667Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1078'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324672Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.2.2.bias'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324678Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1129'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324684Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1093'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324689Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1204'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324696Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv2.0.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324705Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1165'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324714Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1213'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324735Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1105'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324787Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1108'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324799Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1126'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324820Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv2.2.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324829Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1084'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324838Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1234'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324846Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1246'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324854Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1150'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324860Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1219'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324865Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1243'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324870Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1201'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324875Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1252'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324880Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1261'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324886Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1264'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324891Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1075'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324897Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1270'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324902Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1237'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324911Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1183'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324920Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.2.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324944Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1174'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324951Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1171'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324958Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1249'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324963Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1117'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324968Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1216'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324973Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1222'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324979Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1114'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324984Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1087'. It is no longer used by any node.
[2m2025-10-08T19:11:03.324989Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1195'. It is no longer used by any node.
[2m2025-10-08T19:11:03.325014Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv2.1.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.330470Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NhwcTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.330643Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvAddActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.330763Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NchwcTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.331071Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NhwcTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.331242Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvAddActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.331611Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer RemoveDuplicateCastTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.331631Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer CastFloat16Transformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.331641Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MemcpyTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.332644Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Use DeviceBasedPartition as default
[2m2025-10-08T19:11:03.361566Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Saving initialized tensors.
[2m2025-10-08T19:11:03.361642Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:0 (requested) num_bytes: 256 (actual) rounded_bytes:256
[2m2025-10-08T19:11:03.361652Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 1048576 bytes.
[2m2025-10-08T19:11:03.361658Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 1048576
[2m2025-10-08T19:11:03.361664Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d5a4b3ac0 to 0x585d5a5b3ac0
[2m2025-10-08T19:11:03.361743Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:0 (requested) num_bytes: 256 (actual) rounded_bytes:256
[2m2025-10-08T19:11:03.361777Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 2097152 bytes.
[2m2025-10-08T19:11:03.361788Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 3145728
[2m2025-10-08T19:11:03.361794Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d5a5b3b00 to 0x585d5a7b3b00
[2m2025-10-08T19:11:03.362938Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:1 (requested) num_bytes: 512 (actual) rounded_bytes:512
[2m2025-10-08T19:11:03.362966Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 4194304 bytes.
[2m2025-10-08T19:11:03.362973Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 7340032
[2m2025-10-08T19:11:03.362978Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d5a7b3b40 to 0x585d5abb3b40
[2m2025-10-08T19:11:03.365389Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:0 (requested) num_bytes: 32 (actual) rounded_bytes:256
[2m2025-10-08T19:11:03.365429Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 8388608 bytes.
[2m2025-10-08T19:11:03.365436Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 15728640
[2m2025-10-08T19:11:03.365441Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x76862cbf7040 to 0x76862d3f7040
[2m2025-10-08T19:11:03.369959Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:12 (requested) num_bytes: 1572864 (actual) rounded_bytes:1572864
[2m2025-10-08T19:11:03.369992Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 16777216 bytes.
[2m2025-10-08T19:11:03.370007Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 32505856
[2m2025-10-08T19:11:03.370012Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x76860afff040 to 0x76860bfff040
[2m2025-10-08T19:11:03.379281Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:14 (requested) num_bytes: 4718592 (actual) rounded_bytes:4718592
[2m2025-10-08T19:11:03.379318Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 33554432 bytes.
[2m2025-10-08T19:11:03.379326Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 66060288
[2m2025-10-08T19:11:03.379332Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x768608ffe040 to 0x76860affe040
[2m2025-10-08T19:11:03.391472Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Done saving initialized tensors
[2m2025-10-08T19:11:03.392687Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Session successfully initialized.
[2m2025-10-08T19:11:03.392740Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::rust_qreader[0m[2m:[0m ‚úÖ RustQReader ONNX session initialized for Small model
[2m2025-10-08T19:11:03.392748Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ‚úÖ ONNX Small model initialized successfully
[2m2025-10-08T19:11:03.392760Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::rust_qreader[0m[2m:[0m üîß Initializing RustQReader with ONNX: "models/qreader_detector_medium.onnx"
[2m2025-10-08T19:11:03.392787Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Session Options {  execution_mode:0 execution_order:DEFAULT enable_profiling:0 optimized_model_filepath:"" enable_mem_pattern:1 enable_mem_reuse:1 enable_cpu_mem_arena:1 profile_file_prefix:onnxruntime_profile_ session_logid: session_log_severity_level:-1 session_log_verbosity_level:0 max_num_graph_transformation_steps:10 graph_optimization_level:3 intra_op_param:OrtThreadPoolParams { thread_pool_size: 0 auto_set_affinity: 0 allow_spinning: 1 dynamic_block_base_: 0 stack_size: 0 affinity_str:  set_denormal_as_zero: 0 } inter_op_param:OrtThreadPoolParams { thread_pool_size: 0 auto_set_affinity: 0 allow_spinning: 1 dynamic_block_base_: 0 stack_size: 0 affinity_str:  set_denormal_as_zero: 0 } use_per_session_threads:1 thread_pool_allow_spinning:1 use_deterministic_compute:0 ep_selection_policy:0 config_options: {  } }
[2m2025-10-08T19:11:03.392823Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Creating and using per session threadpools since use_per_session_threads_ is true
[2m2025-10-08T19:11:03.392833Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Dynamic block base set to 0
[2m2025-10-08T19:11:03.478820Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Initializing session.
[2m2025-10-08T19:11:03.478921Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Adding default CPU execution provider.
[2m2025-10-08T19:11:03.478964Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Creating BFCArena for Cpu with following configs: initial_chunk_size_bytes: 1048576 max_dead_bytes_per_chunk: 134217728 initial_growth_chunk_size_bytes: 2097152 max_power_of_two_extend_bytes: 1073741824 memory limit: 18446744073709551615 arena_extend_strategy: 0
[2m2025-10-08T19:11:03.479086Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m This model does not have any local functions defined. AOT Inlining is not performed
[2m2025-10-08T19:11:03.479234Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EnsureUniqueDQForNodeUnit modified: 0 with status: OK
[2m2025-10-08T19:11:03.479466Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level1_RuleBasedTransformer modified: 1 with status: OK
[2m2025-10-08T19:11:03.481565Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Constant_61_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481586Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.8/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481605Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.12/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481610Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.6/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481622Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.4/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481627Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.18/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481637Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.2/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481645Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.15/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481650Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.21/Constant_4_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.481834Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DoubleQDQPairsRemover modified: 0 with status: OK
[2m2025-10-08T19:11:03.482343Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total shared scalar initializer count: 92
[2m2025-10-08T19:11:03.482429Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConstantSharing modified: 1 with status: OK
[2m2025-10-08T19:11:03.485088Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer CommonSubexpressionElimination modified: 1 with status: OK
[2m2025-10-08T19:11:03.487480Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConstantFolding modified: 1 with status: OK
[2m2025-10-08T19:11:03.489429Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Split_output_2'. It is no longer used by any node.
[2m2025-10-08T19:11:03.489455Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Split_output_1'. It is no longer used by any node.
[2m2025-10-08T19:11:03.489463Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Constant_14_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.489476Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/Split_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.489637Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulAddFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.489753Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/dfl/Reshape_output_0
[2m2025-10-08T19:11:03.489793Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_18_output_0
[2m2025-10-08T19:11:03.489828Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_19_output_0
[2m2025-10-08T19:11:03.489838Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_13_output_0
[2m2025-10-08T19:11:03.489847Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_14_output_0
[2m2025-10-08T19:11:03.489855Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_8_output_0
[2m2025-10-08T19:11:03.489869Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Fused reshape node: /model.22/Reshape_9_output_0
[2m2025-10-08T19:11:03.489878Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total fused reshape node count: 7
[2m2025-10-08T19:11:03.489888Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ReshapeFusion modified: 1 with status: OK
[2m2025-10-08T19:11:03.492200Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer '/model.22/dfl/Constant_3_output_0'. It is no longer used by any node.
[2m2025-10-08T19:11:03.492300Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FreeDimensionOverrideTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.492321Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.492328Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.492473Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQPropagationTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.492636Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer WeightBiasQuantization modified: 0 with status: OK
[2m2025-10-08T19:11:03.492762Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EnsureUniqueDQForNodeUnit modified: 0 with status: OK
[2m2025-10-08T19:11:03.492928Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer RocmBlasAltImpl modified: 0 with status: OK
[2m2025-10-08T19:11:03.493416Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer TransposeOptimizer modified: 0 with status: OK
[2m2025-10-08T19:11:03.493585Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level1_RuleBasedTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.493679Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DoubleQDQPairsRemover modified: 0 with status: OK
[2m2025-10-08T19:11:03.494184Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer CommonSubexpressionElimination modified: 0 with status: OK
[2m2025-10-08T19:11:03.494359Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConstantFolding modified: 0 with status: OK
[2m2025-10-08T19:11:03.494454Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulAddFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.494555Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ReshapeFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.494570Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FreeDimensionOverrideTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.494575Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.494580Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL1 modified: 0 with status: OK
[2m2025-10-08T19:11:03.494682Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQPropagationTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.494798Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer WeightBiasQuantization modified: 0 with status: OK
[2m2025-10-08T19:11:03.494902Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EnsureUniqueDQForNodeUnit modified: 0 with status: OK
[2m2025-10-08T19:11:03.494991Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer RocmBlasAltImpl modified: 0 with status: OK
[2m2025-10-08T19:11:03.495834Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level2_RuleBasedTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.496398Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer TransposeOptimizer_CPUExecutionProvider modified: 0 with status: OK
[2m2025-10-08T19:11:03.496548Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQS8ToU8Transformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.496794Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQSelectorActionTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.496902Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GemmActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497017Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulIntegerToFloatFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497138Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DynamicQuantizeMatMulFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497309Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497412Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.497503Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.497594Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SimplifiedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497683Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer AttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497771Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EmbedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497785Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherSliceToSplitFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497882Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherToSliceFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.497978Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatmulTransposeFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.498114Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.498240Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GroupQueryAttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.498338Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SkipLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.498450Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FastGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.498824Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QuickGeluFusion modified: 1 with status: OK
[2m2025-10-08T19:11:03.501019Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasSoftmaxFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.501123Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasDropoutFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.501237Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulScaleFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.501319Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.501422Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulNBitsFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.501505Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQFinalCleanupTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.501583Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer Level2_RuleBasedTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.501664Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQS8ToU8Transformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.501851Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQSelectorActionTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.501929Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GemmActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502011Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulIntegerToFloatFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502085Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer DynamicQuantizeMatMulFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502238Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502325Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GeluFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.502422Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer LayerNormFusionL2 modified: 0 with status: OK
[2m2025-10-08T19:11:03.502519Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SimplifiedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502602Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer AttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502676Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer EmbedLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502690Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherSliceToSplitFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502758Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GatherToSliceFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502844Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatmulTransposeFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502922Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.502999Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer GroupQueryAttentionFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503070Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer SkipLayerNormFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503170Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer FastGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503264Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QuickGeluFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503344Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasSoftmaxFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503420Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer BiasDropoutFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503508Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulScaleFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503590Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503693Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MatMulNBitsFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.503776Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer QDQFinalCleanupTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.634113Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NchwcTransformer modified: 1 with status: OK
[2m2025-10-08T19:11:03.637896Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1320'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637925Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1437'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637932Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1431'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637937Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1425'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637942Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1479'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637947Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1419'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637952Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1401'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637957Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1281'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637973Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1434'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637978Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1395'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637984Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.2.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637989Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1371'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637994Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1389'. It is no longer used by any node.
[2m2025-10-08T19:11:03.637999Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1386'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638004Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1380'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638008Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1413'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638013Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1290'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638018Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1365'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638024Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1368'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638029Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1359'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638034Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1404'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638039Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1356'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638044Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1350'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638049Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1341'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638054Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv2.1.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638060Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1392'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638064Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1485'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638070Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.dfl.conv.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638077Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv4.1.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638082Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1284'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638087Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1377'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638093Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1293'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638098Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.0.2.bias'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638125Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1302'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638143Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1311'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638171Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1317'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638183Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.1.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638227Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1347'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638233Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1515'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638238Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv2.2.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638245Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1374'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638250Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.0.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638255Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1329'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638261Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.2.2.bias'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638266Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1323'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638271Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1443'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638276Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1296'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638282Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1422'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638288Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1299'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638293Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1512'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638299Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1416'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638304Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1353'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638310Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1308'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638315Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1461'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638320Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1314'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638326Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1287'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638331Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1305'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638336Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1326'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638342Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1527'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638347Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv2.0.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638352Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1335'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638364Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv4.0.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638369Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1440'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638375Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1509'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638380Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1446'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638386Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1449'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638391Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1428'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638395Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1455'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638400Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1458'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638406Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1464'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638411Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1467'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638418Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1470'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638424Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv4.2.2.weight'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638429Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1362'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638434Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1473'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638441Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1476'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638446Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1482'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638451Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1338'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638456Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1488'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638461Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1344'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638467Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1491'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638472Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1383'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638477Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1497'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638482Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1332'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638488Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1500'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638494Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1494'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638499Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1503'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638508Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1506'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638514Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1518'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638520Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1521'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638525Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1524'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638530Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1530'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638536Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1533'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638542Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'model.22.cv3.1.2.bias'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638547Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1536'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638553Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1452'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638558Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1398'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638563Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1410'. It is no longer used by any node.
[2m2025-10-08T19:11:03.638569Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Removing initializer 'onnx::Conv_1407'. It is no longer used by any node.
[2m2025-10-08T19:11:03.639788Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NhwcTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.640038Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvAddActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.640223Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NchwcTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.640586Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer NhwcTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.640803Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer ConvAddActivationFusion modified: 0 with status: OK
[2m2025-10-08T19:11:03.641325Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer RemoveDuplicateCastTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.641350Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer CastFloat16Transformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.641361Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m GraphTransformer MemcpyTransformer modified: 0 with status: OK
[2m2025-10-08T19:11:03.642485Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Use DeviceBasedPartition as default
[2m2025-10-08T19:11:03.684356Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Saving initialized tensors.
[2m2025-10-08T19:11:03.684425Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:1 (requested) num_bytes: 768 (actual) rounded_bytes:768
[2m2025-10-08T19:11:03.684435Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 1048576 bytes.
[2m2025-10-08T19:11:03.684441Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 1048576
[2m2025-10-08T19:11:03.684447Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d58c739c0 to 0x585d58d739c0
[2m2025-10-08T19:11:03.684464Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:13 (requested) num_bytes: 2985984 (actual) rounded_bytes:2985984
[2m2025-10-08T19:11:03.684471Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 4194304 bytes.
[2m2025-10-08T19:11:03.684485Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 5242880
[2m2025-10-08T19:11:03.684490Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d578d38c0 to 0x585d57cd38c0
[2m2025-10-08T19:11:03.684866Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:12 (requested) num_bytes: 1327104 (actual) rounded_bytes:1327104
[2m2025-10-08T19:11:03.684890Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 4194304 bytes.
[2m2025-10-08T19:11:03.684895Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 9437184
[2m2025-10-08T19:11:03.684899Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d59313a40 to 0x585d59713a40
[2m2025-10-08T19:11:03.685255Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:13 (requested) num_bytes: 2985984 (actual) rounded_bytes:2985984
[2m2025-10-08T19:11:03.685283Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 8388608 bytes.
[2m2025-10-08T19:11:03.685288Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 17825792
[2m2025-10-08T19:11:03.685293Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d59713a80 to 0x585d59f13a80
[2m2025-10-08T19:11:03.686322Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:14 (requested) num_bytes: 5308416 (actual) rounded_bytes:5308416
[2m2025-10-08T19:11:03.686349Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 16777216 bytes.
[2m2025-10-08T19:11:03.686354Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 34603008
[2m2025-10-08T19:11:03.686382Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d5abb3b80 to 0x585d5bbb3b80
[2m2025-10-08T19:11:03.688451Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:13 (requested) num_bytes: 2985984 (actual) rounded_bytes:2985984
[2m2025-10-08T19:11:03.688474Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 33554432 bytes.
[2m2025-10-08T19:11:03.688479Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 68157440
[2m2025-10-08T19:11:03.688484Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x585d5bbb3bc0 to 0x585d5dbb3bc0
[2m2025-10-08T19:11:03.692580Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extending BFCArena for Cpu. bin_num:13 (requested) num_bytes: 2985984 (actual) rounded_bytes:2985984
[2m2025-10-08T19:11:03.692626Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Extended allocation by 67108864 bytes.
[2m2025-10-08T19:11:03.692632Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Total allocated bytes: 135266304
[2m2025-10-08T19:11:03.692638Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Allocated memory at 0x7685f3fff040 to 0x7685f7fff040
[2m2025-10-08T19:11:03.722617Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Done saving initialized tensors
[2m2025-10-08T19:11:03.724419Z[0m [32m INFO[0m [2mort::logging[0m[2m:[0m Session successfully initialized.
[2m2025-10-08T19:11:03.724488Z[0m [32m INFO[0m [2mlum_rust_ws::domains::qr::rust_qreader[0m[2m:[0m ‚úÖ RustQReader ONNX session initialized for Medium model
[2m2025-10-08T19:11:03.724501Z[0m [32m INFO[0m [2mlum_rust_ws::processing::qr_detection[0m[2m:[0m ‚úÖ ONNX Medium model initialized successfully
[2m2025-10-08T19:11:03.724509Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m ü§ñ ONNX ML models initialized for enhanced QR detection
[2m2025-10-08T19:11:03.725699Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m listening on 0.0.0.0:8000
[2m2025-10-08T19:11:28.382442Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:11:28.382535Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T19:11:28.390987Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 8ms: 296 L√ºmis
[2m2025-10-08T19:12:08.174021Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:08.174086Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:08.174115Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T19:12:08.176425Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T19:12:08.913345Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:08.913417Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T19:12:08.915179Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T19:12:09.401421Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:09.401606Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m399f8d62-2e96-4c71-8c9b-9de404eb4da2
[2m2025-10-08T19:12:09.401632Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 399f8d62-2e96-4c71-8c9b-9de404eb4da2: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T19:12:09.401657Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 399f8d62-2e96-4c71-8c9b-9de404eb4da2: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:12:09.407266Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 399f8d62-2e96-4c71-8c9b-9de404eb4da2: Retrieved 0 invoice headers (total: 0) in 5ms with enhanced filtering
[2m2025-10-08T19:12:09.668683Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:09.668771Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mb78e6b5f-06dd-4543-bf5b-63d0ae8d9d45
[2m2025-10-08T19:12:09.668795Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b78e6b5f-06dd-4543-bf5b-63d0ae8d9d45: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T19:12:09.668808Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b78e6b5f-06dd-4543-bf5b-63d0ae8d9d45: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:12:09.673319Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b78e6b5f-06dd-4543-bf5b-63d0ae8d9d45: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-08T19:12:09.685259Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:09.685356Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mb2067616-331e-4957-be43-b0f3265195a9
[2m2025-10-08T19:12:09.685410Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b2067616-331e-4957-be43-b0f3265195a9: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T19:12:09.685508Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b2067616-331e-4957-be43-b0f3265195a9: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:12:09.688743Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b2067616-331e-4957-be43-b0f3265195a9: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T19:12:09.855063Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:09.855131Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5826281e-f6f7-42f3-8841-6c1b13fa0da4
[2m2025-10-08T19:12:09.855138Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5826281e-f6f7-42f3-8841-6c1b13fa0da4: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T19:12:09.855173Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5826281e-f6f7-42f3-8841-6c1b13fa0da4: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:12:09.855185Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5826281e-f6f7-42f3-8841-6c1b13fa0da4: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:12:09.859126Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5826281e-f6f7-42f3-8841-6c1b13fa0da4: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-08T19:12:09.868009Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:09.868082Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m7d63da40-c579-46af-adb0-539476d4a734
[2m2025-10-08T19:12:09.868091Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7d63da40-c579-46af-adb0-539476d4a734: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T19:12:09.868098Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7d63da40-c579-46af-adb0-539476d4a734: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:12:09.868106Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7d63da40-c579-46af-adb0-539476d4a734: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:12:09.869537Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:09.869582Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m1f02bee2-34f9-4e75-a7d4-ad449f18cbd8
[2m2025-10-08T19:12:09.869589Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f02bee2-34f9-4e75-a7d4-ad449f18cbd8: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T19:12:09.869595Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f02bee2-34f9-4e75-a7d4-ad449f18cbd8: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:12:09.869601Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f02bee2-34f9-4e75-a7d4-ad449f18cbd8: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:12:09.871132Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7d63da40-c579-46af-adb0-539476d4a734: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-08T19:12:09.873012Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f02bee2-34f9-4e75-a7d4-ad449f18cbd8: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-08T19:12:21.629483Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:21.629551Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:21.629587Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üìã Fetching user issuers for user_id: 1 [b4a9b3a5-5bcd-4ac8-a09f-d87ea0f7e9ce]
[2m2025-10-08T19:12:21.629596Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üîç Cache key: user_issuers_list_1_100_0_no_date_filter [b4a9b3a5-5bcd-4ac8-a09f-d87ea0f7e9ce]
[2m2025-10-08T19:12:21.634287Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ‚úÖ Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 4ms [b4a9b3a5-5bcd-4ac8-a09f-d87ea0f7e9ce]
[2m2025-10-08T19:12:21.637467Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:21.637543Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:21.637585Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üìã Fetching user issuers for user_id: 1 [a0816643-448c-4d56-9b7b-36464bcc9ee0]
[2m2025-10-08T19:12:21.637607Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üîç Cache key: user_issuers_list_1_100_0_no_date_filter [a0816643-448c-4d56-9b7b-36464bcc9ee0]
[2m2025-10-08T19:12:21.643201Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ‚úÖ Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 5ms [a0816643-448c-4d56-9b7b-36464bcc9ee0]
[2m2025-10-08T19:12:22.014609Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:22.014666Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:22.014690Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üõí Fetching user products for user_id: 1 [2106d55b-1a7f-4a42-bd5f-33537e271e38]
[2m2025-10-08T19:12:22.014700Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üîç Cache key: user_products_list_1_20_0_no_date_filter [2106d55b-1a7f-4a42-bd5f-33537e271e38]
[2m2025-10-08T19:12:22.027455Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ‚úÖ Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 12ms [2106d55b-1a7f-4a42-bd5f-33537e271e38]
[2m2025-10-08T19:12:22.123341Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:22.123409Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:12:22.123429Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üõí Fetching user products for user_id: 1 [a393e9db-01bb-4c39-b2a9-17394f93a6a5]
[2m2025-10-08T19:12:22.123438Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üîç Cache key: user_products_list_1_20_0_no_date_filter [a393e9db-01bb-4c39-b2a9-17394f93a6a5]
[2m2025-10-08T19:12:22.139482Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ‚úÖ Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 16ms [a393e9db-01bb-4c39-b2a9-17394f93a6a5]
[2m2025-10-08T19:13:23.593089Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:23.593183Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:23.593205Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T19:13:23.594539Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T19:13:24.164463Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:24.164531Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T19:13:24.165721Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T19:13:24.709668Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:24.709750Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc4292b50-ba8a-41ca-a0b6-228731296b50
[2m2025-10-08T19:13:24.709760Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c4292b50-ba8a-41ca-a0b6-228731296b50: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T19:13:24.709773Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c4292b50-ba8a-41ca-a0b6-228731296b50: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:13:24.712555Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c4292b50-ba8a-41ca-a0b6-228731296b50: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-08T19:13:25.033499Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:25.033619Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mbe637a88-1de6-41e8-85a0-edb1bea02c9d
[2m2025-10-08T19:13:25.033628Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request be637a88-1de6-41e8-85a0-edb1bea02c9d: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T19:13:25.033642Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request be637a88-1de6-41e8-85a0-edb1bea02c9d: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:13:25.036713Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request be637a88-1de6-41e8-85a0-edb1bea02c9d: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T19:13:25.060219Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:25.060269Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m50aa6561-3a20-4912-92d4-f281e3125749
[2m2025-10-08T19:13:25.060277Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 50aa6561-3a20-4912-92d4-f281e3125749: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T19:13:25.060285Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 50aa6561-3a20-4912-92d4-f281e3125749: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:13:25.062322Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 50aa6561-3a20-4912-92d4-f281e3125749: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-08T19:13:25.217038Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:25.217108Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m23117cd3-a005-4cb2-aafd-7ba59cba0906
[2m2025-10-08T19:13:25.217116Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 23117cd3-a005-4cb2-aafd-7ba59cba0906: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T19:13:25.217123Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 23117cd3-a005-4cb2-aafd-7ba59cba0906: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:13:25.217131Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 23117cd3-a005-4cb2-aafd-7ba59cba0906: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:13:25.218578Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:25.218622Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me6851a30-90c7-4ebe-b434-44accf4923b6
[2m2025-10-08T19:13:25.218628Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e6851a30-90c7-4ebe-b434-44accf4923b6: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T19:13:25.218634Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e6851a30-90c7-4ebe-b434-44accf4923b6: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:13:25.218639Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e6851a30-90c7-4ebe-b434-44accf4923b6: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:13:25.218758Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 23117cd3-a005-4cb2-aafd-7ba59cba0906: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T19:13:25.220067Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e6851a30-90c7-4ebe-b434-44accf4923b6: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T19:13:25.225261Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:13:25.225311Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m1f3f38b6-eb7b-4132-bef6-5e46bff8a14c
[2m2025-10-08T19:13:25.225317Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f3f38b6-eb7b-4132-bef6-5e46bff8a14c: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T19:13:25.225323Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f3f38b6-eb7b-4132-bef6-5e46bff8a14c: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:13:25.225329Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f3f38b6-eb7b-4132-bef6-5e46bff8a14c: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:13:25.226980Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1f3f38b6-eb7b-4132-bef6-5e46bff8a14c: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T19:19:51.681480Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:51.681563Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:51.681584Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T19:19:51.683178Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T19:19:52.490094Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:52.490199Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T19:19:52.491616Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T19:19:52.973538Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:52.973629Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m9a387173-1ad8-4f9d-b353-d80d2906b771
[2m2025-10-08T19:19:52.973644Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9a387173-1ad8-4f9d-b353-d80d2906b771: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T19:19:52.973668Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9a387173-1ad8-4f9d-b353-d80d2906b771: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:19:52.977142Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9a387173-1ad8-4f9d-b353-d80d2906b771: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T19:19:53.334579Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:53.334692Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6cdb8985-7d64-4b33-ba76-ed85d6dcb9a5
[2m2025-10-08T19:19:53.334703Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6cdb8985-7d64-4b33-ba76-ed85d6dcb9a5: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T19:19:53.334715Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6cdb8985-7d64-4b33-ba76-ed85d6dcb9a5: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:19:53.338506Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6cdb8985-7d64-4b33-ba76-ed85d6dcb9a5: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T19:19:53.344496Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:53.344578Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m58597b4f-cae4-44b5-859d-f7ec290c4a7e
[2m2025-10-08T19:19:53.344588Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 58597b4f-cae4-44b5-859d-f7ec290c4a7e: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T19:19:53.344599Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 58597b4f-cae4-44b5-859d-f7ec290c4a7e: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:19:53.346258Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 58597b4f-cae4-44b5-859d-f7ec290c4a7e: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T19:19:53.518975Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:53.519065Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m6e5cf9a1-2b62-4080-83eb-e30c749a5651
[2m2025-10-08T19:19:53.519078Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6e5cf9a1-2b62-4080-83eb-e30c749a5651: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T19:19:53.519087Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6e5cf9a1-2b62-4080-83eb-e30c749a5651: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:19:53.519095Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6e5cf9a1-2b62-4080-83eb-e30c749a5651: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:19:53.519325Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:53.519462Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m2b8f0c8f-5ce6-4c97-a105-15263e1d4b44
[2m2025-10-08T19:19:53.519505Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2b8f0c8f-5ce6-4c97-a105-15263e1d4b44: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T19:19:53.519522Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2b8f0c8f-5ce6-4c97-a105-15263e1d4b44: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:19:53.519536Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2b8f0c8f-5ce6-4c97-a105-15263e1d4b44: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:19:53.524169Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6e5cf9a1-2b62-4080-83eb-e30c749a5651: Retrieved 0 invoice details (total: 0) in 5ms with enhanced pagination
[2m2025-10-08T19:19:53.524614Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2b8f0c8f-5ce6-4c97-a105-15263e1d4b44: Retrieved 0 invoice details (total: 0) in 5ms with enhanced pagination
[2m2025-10-08T19:19:53.526170Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:19:53.526261Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf1f1a990-3ea8-44e7-8c03-71e9d9ad9a53
[2m2025-10-08T19:19:53.526275Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f1f1a990-3ea8-44e7-8c03-71e9d9ad9a53: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T19:19:53.526282Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f1f1a990-3ea8-44e7-8c03-71e9d9ad9a53: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:19:53.526289Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f1f1a990-3ea8-44e7-8c03-71e9d9ad9a53: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:19:53.528807Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f1f1a990-3ea8-44e7-8c03-71e9d9ad9a53: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T19:38:45.101678Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:45.101734Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:45.101750Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T19:38:45.103790Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T19:38:45.970476Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:45.970537Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T19:38:45.972097Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T19:38:46.485682Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:46.485770Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mfae5cdce-ef46-44c1-aea5-b6099ddfd7af
[2m2025-10-08T19:38:46.485780Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fae5cdce-ef46-44c1-aea5-b6099ddfd7af: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T19:38:46.485801Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fae5cdce-ef46-44c1-aea5-b6099ddfd7af: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:38:46.490223Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fae5cdce-ef46-44c1-aea5-b6099ddfd7af: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-08T19:38:46.836243Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:46.836330Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mcabaf53f-b5c6-4daf-b248-d099f42f79ef
[2m2025-10-08T19:38:46.836340Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cabaf53f-b5c6-4daf-b248-d099f42f79ef: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T19:38:46.836350Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cabaf53f-b5c6-4daf-b248-d099f42f79ef: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:38:46.840267Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cabaf53f-b5c6-4daf-b248-d099f42f79ef: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T19:38:46.842323Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:46.842376Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m4f448821-2c46-4909-9cd2-d743742f6063
[2m2025-10-08T19:38:46.842384Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4f448821-2c46-4909-9cd2-d743742f6063: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T19:38:46.842403Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4f448821-2c46-4909-9cd2-d743742f6063: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:38:46.845912Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4f448821-2c46-4909-9cd2-d743742f6063: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T19:38:47.038517Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:47.038600Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf369fdeb-97bf-483f-b251-e0c42670af69
[2m2025-10-08T19:38:47.038614Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f369fdeb-97bf-483f-b251-e0c42670af69: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T19:38:47.038624Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f369fdeb-97bf-483f-b251-e0c42670af69: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:38:47.038635Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f369fdeb-97bf-483f-b251-e0c42670af69: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:38:47.041953Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f369fdeb-97bf-483f-b251-e0c42670af69: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-08T19:38:47.043127Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:47.043184Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5f50ad6d-a42e-4dac-ae8a-ad72ebddb994
[2m2025-10-08T19:38:47.043193Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f50ad6d-a42e-4dac-ae8a-ad72ebddb994: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T19:38:47.043200Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f50ad6d-a42e-4dac-ae8a-ad72ebddb994: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:38:47.043215Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f50ad6d-a42e-4dac-ae8a-ad72ebddb994: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:38:47.047466Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f50ad6d-a42e-4dac-ae8a-ad72ebddb994: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-08T19:38:47.049677Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:38:47.049716Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mea9381d0-9f7c-418e-a238-f42a4b733491
[2m2025-10-08T19:38:47.049724Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ea9381d0-9f7c-418e-a238-f42a4b733491: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T19:38:47.049730Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ea9381d0-9f7c-418e-a238-f42a4b733491: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:38:47.049736Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ea9381d0-9f7c-418e-a238-f42a4b733491: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:38:47.051998Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ea9381d0-9f7c-418e-a238-f42a4b733491: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T19:41:22.586551Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:22.586614Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:22.586632Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T19:41:22.588601Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T19:41:23.296028Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:23.296098Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T19:41:23.297927Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T19:41:23.789692Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:23.789783Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m12b02514-c5c5-482d-8665-1dbeb2dc0db2
[2m2025-10-08T19:41:23.789807Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 12b02514-c5c5-482d-8665-1dbeb2dc0db2: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T19:41:23.789817Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 12b02514-c5c5-482d-8665-1dbeb2dc0db2: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:41:23.792643Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 12b02514-c5c5-482d-8665-1dbeb2dc0db2: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-08T19:41:24.094534Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:24.094625Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3ff2e25f-04da-4d83-8d9f-4570d9e30676
[2m2025-10-08T19:41:24.094641Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3ff2e25f-04da-4d83-8d9f-4570d9e30676: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T19:41:24.094651Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3ff2e25f-04da-4d83-8d9f-4570d9e30676: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:41:24.097101Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3ff2e25f-04da-4d83-8d9f-4570d9e30676: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-08T19:41:24.104099Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:24.104168Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m82f70938-4613-40cf-ac9a-4896dabf393a
[2m2025-10-08T19:41:24.104179Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82f70938-4613-40cf-ac9a-4896dabf393a: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T19:41:24.104187Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82f70938-4613-40cf-ac9a-4896dabf393a: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:41:24.106127Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82f70938-4613-40cf-ac9a-4896dabf393a: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T19:41:24.275862Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:24.275947Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m612d1c9a-3390-43ed-a0f0-26ac2a41509b
[2m2025-10-08T19:41:24.275958Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 612d1c9a-3390-43ed-a0f0-26ac2a41509b: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T19:41:24.275967Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 612d1c9a-3390-43ed-a0f0-26ac2a41509b: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:41:24.275976Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 612d1c9a-3390-43ed-a0f0-26ac2a41509b: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:41:24.278182Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 612d1c9a-3390-43ed-a0f0-26ac2a41509b: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T19:41:24.280512Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:24.280609Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mab4103e2-f5da-47b6-951d-4e6ab2ca9444
[2m2025-10-08T19:41:24.280663Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ab4103e2-f5da-47b6-951d-4e6ab2ca9444: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T19:41:24.280700Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ab4103e2-f5da-47b6-951d-4e6ab2ca9444: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:41:24.280711Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ab4103e2-f5da-47b6-951d-4e6ab2ca9444: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:41:24.283188Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ab4103e2-f5da-47b6-951d-4e6ab2ca9444: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T19:41:24.287351Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:41:24.287411Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me9e984fd-9e74-4452-ab02-3f81b3cf16ef
[2m2025-10-08T19:41:24.287420Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e9e984fd-9e74-4452-ab02-3f81b3cf16ef: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T19:41:24.287427Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e9e984fd-9e74-4452-ab02-3f81b3cf16ef: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:41:24.287434Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e9e984fd-9e74-4452-ab02-3f81b3cf16ef: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:41:24.289316Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e9e984fd-9e74-4452-ab02-3f81b3cf16ef: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T19:56:31.762719Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:31.762776Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:31.762798Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T19:56:31.764936Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T19:56:32.563488Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:32.563564Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T19:56:32.565033Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T19:56:33.032611Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:33.032715Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6460e375-814e-4a17-9bf6-e42d156f4662
[2m2025-10-08T19:56:33.032727Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6460e375-814e-4a17-9bf6-e42d156f4662: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T19:56:33.032740Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6460e375-814e-4a17-9bf6-e42d156f4662: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:56:33.038486Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6460e375-814e-4a17-9bf6-e42d156f4662: Retrieved 0 invoice headers (total: 0) in 5ms with enhanced filtering
[2m2025-10-08T19:56:33.385608Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:33.385689Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m5f92fba7-6cb4-47b0-ba09-c1c9aea34b53
[2m2025-10-08T19:56:33.385697Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f92fba7-6cb4-47b0-ba09-c1c9aea34b53: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T19:56:33.385708Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f92fba7-6cb4-47b0-ba09-c1c9aea34b53: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:56:33.389432Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f92fba7-6cb4-47b0-ba09-c1c9aea34b53: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T19:56:33.390762Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:33.390810Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m705658db-3aad-4b02-a462-a2bccfb00da1
[2m2025-10-08T19:56:33.390817Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 705658db-3aad-4b02-a462-a2bccfb00da1: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T19:56:33.390827Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 705658db-3aad-4b02-a462-a2bccfb00da1: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:56:33.394862Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 705658db-3aad-4b02-a462-a2bccfb00da1: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-08T19:56:33.608714Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:33.608815Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5f45ea45-7fdf-4070-8b9c-f7b5434b7fa1
[2m2025-10-08T19:56:33.608825Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f45ea45-7fdf-4070-8b9c-f7b5434b7fa1: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T19:56:33.608833Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f45ea45-7fdf-4070-8b9c-f7b5434b7fa1: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:56:33.608841Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f45ea45-7fdf-4070-8b9c-f7b5434b7fa1: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:56:33.612089Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:33.612183Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb2366590-92fe-4f02-b186-d51077c17afe
[2m2025-10-08T19:56:33.612199Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b2366590-92fe-4f02-b186-d51077c17afe: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T19:56:33.612207Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b2366590-92fe-4f02-b186-d51077c17afe: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:56:33.612217Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b2366590-92fe-4f02-b186-d51077c17afe: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:56:33.613442Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5f45ea45-7fdf-4070-8b9c-f7b5434b7fa1: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-08T19:56:33.617550Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b2366590-92fe-4f02-b186-d51077c17afe: Retrieved 0 invoice details (total: 0) in 5ms with enhanced pagination
[2m2025-10-08T19:56:33.618763Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T19:56:33.618807Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m9fa18b37-43e1-4754-b18e-40950257bb31
[2m2025-10-08T19:56:33.618813Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9fa18b37-43e1-4754-b18e-40950257bb31: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T19:56:33.618819Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9fa18b37-43e1-4754-b18e-40950257bb31: Querying details for user 1 with enhanced filters
[2m2025-10-08T19:56:33.618825Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9fa18b37-43e1-4754-b18e-40950257bb31: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T19:56:33.621445Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9fa18b37-43e1-4754-b18e-40950257bb31: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T20:48:56.132538Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 3cd87368-ef59-4f92-8bbb-0a2622ca4f09: Root endpoint accessed
[2m2025-10-08T20:49:11.332760Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request dba8b00d-2f85-40a9-aa50-1ead199ffd1a: Root endpoint accessed
[2m2025-10-08T20:49:12.330433Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-08T20:49:23.166728Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request fb120573-9431-4c1b-8a8e-25922c5acebd: Root endpoint accessed
[2m2025-10-08T21:04:30.539545Z[0m [32m INFO[0m [2mlum_rust_ws::api::root_v4[0m[2m:[0m Request 162a9860-0d15-4dc8-adff-d316647d2f70: Root endpoint accessed
[2m2025-10-08T21:04:30.893051Z[0m [33m WARN[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m Missing Authorization header
[2m2025-10-08T21:44:58.538771Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:44:58.538834Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:44:58.538851Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T21:44:58.541080Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T21:44:59.555740Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:44:59.555810Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T21:44:59.557709Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T21:45:00.067772Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:45:00.067846Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0me238eabd-2358-4880-b92a-f4d53f5e683b
[2m2025-10-08T21:45:00.067856Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e238eabd-2358-4880-b92a-f4d53f5e683b: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T21:45:00.067868Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e238eabd-2358-4880-b92a-f4d53f5e683b: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:45:00.072064Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e238eabd-2358-4880-b92a-f4d53f5e683b: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-08T21:45:00.418684Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:45:00.418806Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m5a1f13b0-83ff-45fd-bcd4-def773ea241f
[2m2025-10-08T21:45:00.418815Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5a1f13b0-83ff-45fd-bcd4-def773ea241f: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T21:45:00.418825Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5a1f13b0-83ff-45fd-bcd4-def773ea241f: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:45:00.424977Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5a1f13b0-83ff-45fd-bcd4-def773ea241f: Retrieved 0 invoice headers (total: 0) in 6ms with enhanced filtering
[2m2025-10-08T21:45:00.437143Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:45:00.437205Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc8770f56-481b-4806-ae4a-6405ecf38491
[2m2025-10-08T21:45:00.437213Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c8770f56-481b-4806-ae4a-6405ecf38491: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T21:45:00.437222Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c8770f56-481b-4806-ae4a-6405ecf38491: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:45:00.442095Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c8770f56-481b-4806-ae4a-6405ecf38491: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-08T21:45:00.608235Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:45:00.608357Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m3d9d79c5-f9de-4083-b641-43779a87ed1c
[2m2025-10-08T21:45:00.608367Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3d9d79c5-f9de-4083-b641-43779a87ed1c: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T21:45:00.608375Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3d9d79c5-f9de-4083-b641-43779a87ed1c: Querying details for user 1 with enhanced filters
[2m2025-10-08T21:45:00.608382Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3d9d79c5-f9de-4083-b641-43779a87ed1c: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:45:00.612776Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3d9d79c5-f9de-4083-b641-43779a87ed1c: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-08T21:45:00.619807Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:45:00.619875Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf5486d0c-c515-4a2f-9df2-e28d3ec8b6d0
[2m2025-10-08T21:45:00.619883Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f5486d0c-c515-4a2f-9df2-e28d3ec8b6d0: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T21:45:00.619890Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f5486d0c-c515-4a2f-9df2-e28d3ec8b6d0: Querying details for user 1 with enhanced filters
[2m2025-10-08T21:45:00.619898Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f5486d0c-c515-4a2f-9df2-e28d3ec8b6d0: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:45:00.621293Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:45:00.621336Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m2262e4f5-37d2-43db-b14b-58defdb40aac
[2m2025-10-08T21:45:00.621342Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2262e4f5-37d2-43db-b14b-58defdb40aac: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T21:45:00.621347Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2262e4f5-37d2-43db-b14b-58defdb40aac: Querying details for user 1 with enhanced filters
[2m2025-10-08T21:45:00.621364Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2262e4f5-37d2-43db-b14b-58defdb40aac: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:45:00.622851Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f5486d0c-c515-4a2f-9df2-e28d3ec8b6d0: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T21:45:00.625674Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2262e4f5-37d2-43db-b14b-58defdb40aac: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-08T21:53:41.632413Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:41.632474Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:41.632490Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T21:53:41.634546Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T21:53:42.451042Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:42.451113Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T21:53:42.452759Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T21:53:42.959982Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:42.960053Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m118402cb-dcf2-4712-8862-a730bf8a15aa
[2m2025-10-08T21:53:42.960062Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 118402cb-dcf2-4712-8862-a730bf8a15aa: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T21:53:42.960072Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 118402cb-dcf2-4712-8862-a730bf8a15aa: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:53:42.964261Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 118402cb-dcf2-4712-8862-a730bf8a15aa: Retrieved 0 invoice headers (total: 0) in 4ms with enhanced filtering
[2m2025-10-08T21:53:43.210459Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:43.210544Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m5a0649b4-7c97-49af-9629-768d443e0bae
[2m2025-10-08T21:53:43.210552Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5a0649b4-7c97-49af-9629-768d443e0bae: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T21:53:43.210568Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5a0649b4-7c97-49af-9629-768d443e0bae: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:53:43.215678Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5a0649b4-7c97-49af-9629-768d443e0bae: Retrieved 0 invoice headers (total: 0) in 5ms with enhanced filtering
[2m2025-10-08T21:53:43.227144Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:43.227227Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0meb1ad5ec-ad77-423f-95a1-f8a1731ae86e
[2m2025-10-08T21:53:43.227235Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eb1ad5ec-ad77-423f-95a1-f8a1731ae86e: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T21:53:43.227245Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eb1ad5ec-ad77-423f-95a1-f8a1731ae86e: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:53:43.230534Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request eb1ad5ec-ad77-423f-95a1-f8a1731ae86e: Retrieved 0 invoice headers (total: 0) in 3ms with enhanced filtering
[2m2025-10-08T21:53:43.389869Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:43.389956Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mc64d913f-bb94-4412-9f5a-759482910af1
[2m2025-10-08T21:53:43.389964Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c64d913f-bb94-4412-9f5a-759482910af1: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T21:53:43.389972Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c64d913f-bb94-4412-9f5a-759482910af1: Querying details for user 1 with enhanced filters
[2m2025-10-08T21:53:43.389979Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c64d913f-bb94-4412-9f5a-759482910af1: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:53:43.390087Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:43.390125Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mae13ed4a-8c67-4462-a7bb-525799f768f5
[2m2025-10-08T21:53:43.390132Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae13ed4a-8c67-4462-a7bb-525799f768f5: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T21:53:43.390138Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae13ed4a-8c67-4462-a7bb-525799f768f5: Querying details for user 1 with enhanced filters
[2m2025-10-08T21:53:43.390145Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae13ed4a-8c67-4462-a7bb-525799f768f5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:53:43.393962Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:43.394025Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m7bb94d80-ab6a-4d9a-9c2d-045a85b3a772
[2m2025-10-08T21:53:43.394039Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7bb94d80-ab6a-4d9a-9c2d-045a85b3a772: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T21:53:43.394062Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7bb94d80-ab6a-4d9a-9c2d-045a85b3a772: Querying details for user 1 with enhanced filters
[2m2025-10-08T21:53:43.394071Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7bb94d80-ab6a-4d9a-9c2d-045a85b3a772: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T21:53:43.394194Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c64d913f-bb94-4412-9f5a-759482910af1: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-08T21:53:43.396606Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ae13ed4a-8c67-4462-a7bb-525799f768f5: Retrieved 0 invoice details (total: 0) in 6ms with enhanced pagination
[2m2025-10-08T21:53:43.397191Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7bb94d80-ab6a-4d9a-9c2d-045a85b3a772: Retrieved 0 invoice details (total: 0) in 3ms with enhanced pagination
[2m2025-10-08T21:53:44.874540Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:44.874600Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T21:53:44.875798Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T21:53:47.852405Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:47.852452Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:53:47.852470Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T21:53:47.854049Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T21:54:19.381495Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:19.381559Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:19.381577Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T21:54:19.383279Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T21:54:23.194097Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:23.194173Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T21:54:23.195230Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T21:54:27.357819Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:27.357886Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T21:54:27.359085Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T21:54:30.027496Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:30.027567Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:30.027584Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T21:54:30.029112Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T21:54:38.269121Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:38.269204Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:54:38.269224Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T21:54:38.270582Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T21:56:50.693807Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:56:50.693882Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:56:50.693911Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-08T21:56:50.701941Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 8ms for user_id: 1 - 20 items
[2m2025-10-08T21:56:50.717485Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:56:50.717523Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T21:56:50.717878Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 296 L√ºmis
[2m2025-10-08T21:56:50.736765Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:56:50.736801Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:56:50.736833Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-08T21:56:50.741744Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 4ms for user_id: 1 - 20 items
[2m2025-10-08T21:56:50.747687Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:56:50.747787Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T21:56:50.747810Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-08T21:56:50.752969Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 5ms for user_id: 1 - 20 items
[2m2025-10-08T22:03:42.138910Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:03:42.138987Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m85e12314-1926-4df0-b3f2-25db7f93dce6 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:03:42.139004Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:03:42.144009Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m85e12314-1926-4df0-b3f2-25db7f93dce6 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:03:42.144220Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m0ea60387-f6bf-4242-b830-515ffe494992
[2m2025-10-08T22:03:42.144849Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m0ea60387-f6bf-4242-b830-515ffe494992 [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:03:42.159513Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:03:42.159500481 UTC
[2m2025-10-08T22:03:42.163964Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m85e12314-1926-4df0-b3f2-25db7f93dce6 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:03:42.164052Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m85e12314-1926-4df0-b3f2-25db7f93dce6 [3mexecution_time_ms[0m[2m=[0m25
[2m2025-10-08T22:03:59.875255Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c38083c4-7530-409c-9c6f-35d81fec4521: Checking email existence: andrescarriela@gmail.com
[2m2025-10-08T22:03:59.875579Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c38083c4-7530-409c-9c6f-35d81fec4521: Querying database for email: andrescarriela@gmail.com
[2m2025-10-08T22:03:59.877251Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c38083c4-7530-409c-9c6f-35d81fec4521: Found existing user with ID: 2
[2m2025-10-08T22:03:59.877298Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request c38083c4-7530-409c-9c6f-35d81fec4521: Email andrescarriela@gmail.com exists with password: true
[2m2025-10-08T22:04:07.985360Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:04:07.985411Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m3e132a18-993c-4a1e-8125-94717ce31165 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123.", name: None }
[2m2025-10-08T22:04:07.985424Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:04:07.990559Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m3e132a18-993c-4a1e-8125-94717ce31165 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:04:08.273370Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m3e132a18-993c-4a1e-8125-94717ce31165 [3mevent_type[0m[2m=[0mlogin_failure [3msuccess[0m[2m=[0mfalse
[2m2025-10-08T22:04:08.273420Z[0m [31mERROR[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚ùå Authentication failed [3mrequest_id[0m[2m=[0m3e132a18-993c-4a1e-8125-94717ce31165 [3mexecution_time_ms[0m[2m=[0m288 [3merror[0m[2m=[0mInvalid credentials
[2m2025-10-08T22:04:08.273432Z[0m [31mERROR[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m Authentication failed: Invalid credentials
[2m2025-10-08T22:05:19.423847Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:05:19.423908Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m1019565e-4cc1-4135-b079-24fa4127d536 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA2MDYzOTM2NDI0NDM3NjIxMDgwIiwiZW1haWwiOiJhbmRyZXNmZWxpcGV2YWxlbmNpYWdAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJBbmRyZXMgVmFsZW5jaWEiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSk9Xd083eUdDWVA1OHB4ZFZCd2R6MGJudWtITHdwcjk0RklVbGNEckxHYnVrYUFBPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6IkFuZHJlcyIsImZhbWlseV9uYW1lIjoiVmFsZW5jaWEiLCJpYXQiOjE3NTk5NjExMTMsImV4cCI6MTc1OTk2NDcxM30.D-KEeH66kQi977BmY2g5Q7ndWNNAOu3MogcNXvn9iTMhu1F6llpilj98ipMoRKL31C4B2Fvruc7iXPUcosc91kFT9rgjnzhHCjQcXvj-S4P8fug-gjMQy1GA5Ykg6Y0KE3i5z6SqlgTHHXIsiZR2syTjyZkg9RymqSqWEGXSULgPMUkqEhoGgIWkAv3Wi-FH8AzPz9QXMNfBXs81_Jd1c2MuiF8ppXmkdEB0hSzM2iCiko8TkBao1wW3gsb_JMmtJf4rD-4GHcXNiCd9PY456D0O3Z1ZTgbdraPXxQBXKpr9RCeIwaN_8tNIIuH-1Rs-q2Lbzc2SpwiV0dCrwk7j6Q", access_token: None }
[2m2025-10-08T22:05:19.423929Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:05:19.428446Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m1019565e-4cc1-4135-b079-24fa4127d536 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:05:19.428501Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m86b209f6-992d-4f74-85e0-fc943e0bea04
[2m2025-10-08T22:05:19.429074Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m86b209f6-992d-4f74-85e0-fc943e0bea04 [3muser_id[0m[2m=[0m106063936424437621080 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mname[0m[2m=[0mSome("Andres Valencia") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:05:19.432998Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:05:19.432986065 UTC
[2m2025-10-08T22:05:19.437120Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m1019565e-4cc1-4135-b079-24fa4127d536 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:05:19.437160Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m1019565e-4cc1-4135-b079-24fa4127d536 [3mexecution_time_ms[0m[2m=[0m13
[2m2025-10-08T22:05:19.862046Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:19.862172Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:19.862201Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T22:05:19.863063Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T22:05:19.894632Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:19.894707Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T22:05:19.895226Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 296 L√ºmis
[2m2025-10-08T22:05:39.059888Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.059956Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.059993Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üìã Fetching user issuers for user_id: 1 [eba31549-6b8c-4c9d-abe4-433fb58d2419]
[2m2025-10-08T22:05:39.060002Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üîç Cache key: user_issuers_list_1_100_0_no_date_filter [eba31549-6b8c-4c9d-abe4-433fb58d2419]
[2m2025-10-08T22:05:39.060184Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.060247Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.060265Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üìã Fetching user issuers for user_id: 1 [adfc9264-94d9-45ae-974f-af9c057706e0]
[2m2025-10-08T22:05:39.060271Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üîç Cache key: user_issuers_list_1_100_0_no_date_filter [adfc9264-94d9-45ae-974f-af9c057706e0]
[2m2025-10-08T22:05:39.064978Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ‚úÖ Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 4ms [eba31549-6b8c-4c9d-abe4-433fb58d2419]
[2m2025-10-08T22:05:39.066044Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ‚úÖ Successfully fetched 100 issuers for user 1 (total: 97, date_filter: none) in 5ms [adfc9264-94d9-45ae-974f-af9c057706e0]
[2m2025-10-08T22:05:39.421638Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.421700Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.421721Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üõí Fetching user products for user_id: 1 [2c34d0b4-b23d-4d2d-9fb2-08339d9ace27]
[2m2025-10-08T22:05:39.421730Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üîç Cache key: user_products_list_1_20_0_no_date_filter [2c34d0b4-b23d-4d2d-9fb2-08339d9ace27]
[2m2025-10-08T22:05:39.435280Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ‚úÖ Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 13ms [2c34d0b4-b23d-4d2d-9fb2-08339d9ace27]
[2m2025-10-08T22:05:39.441526Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.441567Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.441583Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üõí Fetching user products for user_id: 1 [6dbcc8fa-0d9d-4eae-969e-d2fc3b8077d9]
[2m2025-10-08T22:05:39.441591Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üîç Cache key: user_products_list_1_20_0_no_date_filter [6dbcc8fa-0d9d-4eae-969e-d2fc3b8077d9]
[2m2025-10-08T22:05:39.454396Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ‚úÖ Successfully fetched 20 products for user 1 (total: 1543, date_filter: none) in 12ms [6dbcc8fa-0d9d-4eae-969e-d2fc3b8077d9]
[2m2025-10-08T22:05:39.686407Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.686485Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m130852f2-697b-40ba-a3e6-25b54204a3e1
[2m2025-10-08T22:05:39.686494Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 130852f2-697b-40ba-a3e6-25b54204a3e1: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T22:05:39.686505Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 130852f2-697b-40ba-a3e6-25b54204a3e1: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:39.686531Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.686603Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m7c5ff830-d52f-4c5b-8787-9c0401cb5b7c
[2m2025-10-08T22:05:39.686612Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7c5ff830-d52f-4c5b-8787-9c0401cb5b7c: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T22:05:39.686883Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7c5ff830-d52f-4c5b-8787-9c0401cb5b7c: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:39.710356Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 130852f2-697b-40ba-a3e6-25b54204a3e1: Retrieved 50 invoice headers (total: 341) in 23ms with enhanced filtering
[2m2025-10-08T22:05:39.715750Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7c5ff830-d52f-4c5b-8787-9c0401cb5b7c: Retrieved 50 invoice headers (total: 341) in 29ms with enhanced filtering
[2m2025-10-08T22:05:39.994545Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:39.994612Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mb6cc9775-1fd2-4e84-a56d-dfb4daab8569
[2m2025-10-08T22:05:39.994632Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b6cc9775-1fd2-4e84-a56d-dfb4daab8569: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T22:05:39.994642Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b6cc9775-1fd2-4e84-a56d-dfb4daab8569: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:40.000075Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b6cc9775-1fd2-4e84-a56d-dfb4daab8569: Retrieved 50 invoice headers (total: 341) in 5ms with enhanced filtering
[2m2025-10-08T22:05:40.748060Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:40.748060Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:40.748138Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0ma314d21e-00f1-4c3f-9fc8-efab019c47e9
[2m2025-10-08T22:05:40.748184Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a314d21e-00f1-4c3f-9fc8-efab019c47e9: Processing headers for user 1 with limit 50 offset 150
[2m2025-10-08T22:05:40.748213Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m9caeae3f-bdc0-4940-b22c-c7bd685b65b0
[2m2025-10-08T22:05:40.748214Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a314d21e-00f1-4c3f-9fc8-efab019c47e9: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:40.748224Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9caeae3f-bdc0-4940-b22c-c7bd685b65b0: Processing headers for user 1 with limit 50 offset 200
[2m2025-10-08T22:05:40.748260Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9caeae3f-bdc0-4940-b22c-c7bd685b65b0: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:40.753484Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a314d21e-00f1-4c3f-9fc8-efab019c47e9: Retrieved 50 invoice headers (total: 341) in 5ms with enhanced filtering
[2m2025-10-08T22:05:40.754136Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9caeae3f-bdc0-4940-b22c-c7bd685b65b0: Retrieved 50 invoice headers (total: 341) in 5ms with enhanced filtering
[2m2025-10-08T22:05:40.754677Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:40.754789Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3d94b486-33e2-4d4e-a103-caf7d1dceaec
[2m2025-10-08T22:05:40.754817Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3d94b486-33e2-4d4e-a103-caf7d1dceaec: Processing headers for user 1 with limit 50 offset 250
[2m2025-10-08T22:05:40.754831Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3d94b486-33e2-4d4e-a103-caf7d1dceaec: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:40.759906Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3d94b486-33e2-4d4e-a103-caf7d1dceaec: Retrieved 50 invoice headers (total: 341) in 5ms with enhanced filtering
[2m2025-10-08T22:05:41.015914Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.015981Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m7d7d847c-6d9c-48fe-82e6-54f418c0d392
[2m2025-10-08T22:05:41.015989Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7d7d847c-6d9c-48fe-82e6-54f418c0d392: Processing headers for user 1 with limit 50 offset 350
[2m2025-10-08T22:05:41.015998Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7d7d847c-6d9c-48fe-82e6-54f418c0d392: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.016145Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.016212Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m10b51a88-c1bf-42d7-a9d4-f9f07502eb37
[2m2025-10-08T22:05:41.016218Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10b51a88-c1bf-42d7-a9d4-f9f07502eb37: Processing headers for user 1 with limit 50 offset 300
[2m2025-10-08T22:05:41.016224Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10b51a88-c1bf-42d7-a9d4-f9f07502eb37: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.022223Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7d7d847c-6d9c-48fe-82e6-54f418c0d392: Retrieved 0 invoice headers (total: 341) in 6ms with enhanced filtering
[2m2025-10-08T22:05:41.022508Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.022797Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m9d283621-e6a0-456b-8f39-8aa93fde6724
[2m2025-10-08T22:05:41.022877Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9d283621-e6a0-456b-8f39-8aa93fde6724: Processing headers for user 1 with limit 50 offset 400
[2m2025-10-08T22:05:41.022914Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9d283621-e6a0-456b-8f39-8aa93fde6724: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.023726Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 10b51a88-c1bf-42d7-a9d4-f9f07502eb37: Retrieved 41 invoice headers (total: 341) in 7ms with enhanced filtering
[2m2025-10-08T22:05:41.029441Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9d283621-e6a0-456b-8f39-8aa93fde6724: Retrieved 0 invoice headers (total: 341) in 6ms with enhanced filtering
[2m2025-10-08T22:05:41.262793Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.262869Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m6cd99a29-1f52-4a83-8d7a-8eeb20b20826
[2m2025-10-08T22:05:41.262876Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6cd99a29-1f52-4a83-8d7a-8eeb20b20826: Processing headers for user 1 with limit 50 offset 450
[2m2025-10-08T22:05:41.262885Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6cd99a29-1f52-4a83-8d7a-8eeb20b20826: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.267227Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6cd99a29-1f52-4a83-8d7a-8eeb20b20826: Retrieved 0 invoice headers (total: 341) in 4ms with enhanced filtering
[2m2025-10-08T22:05:41.269920Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.269966Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m74746670-3c1d-49c1-be8e-279715b6ac45
[2m2025-10-08T22:05:41.269973Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 74746670-3c1d-49c1-be8e-279715b6ac45: Processing headers for user 1 with limit 50 offset 500
[2m2025-10-08T22:05:41.269982Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 74746670-3c1d-49c1-be8e-279715b6ac45: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.274951Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 74746670-3c1d-49c1-be8e-279715b6ac45: Retrieved 0 invoice headers (total: 341) in 4ms with enhanced filtering
[2m2025-10-08T22:05:41.276681Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.276720Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mf3d10da1-dcca-456b-82a9-c854719852dc
[2m2025-10-08T22:05:41.276728Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3d10da1-dcca-456b-82a9-c854719852dc: Processing headers for user 1 with limit 50 offset 550
[2m2025-10-08T22:05:41.276735Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3d10da1-dcca-456b-82a9-c854719852dc: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.280417Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f3d10da1-dcca-456b-82a9-c854719852dc: Retrieved 0 invoice headers (total: 341) in 3ms with enhanced filtering
[2m2025-10-08T22:05:41.400050Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.400126Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m17deddaa-3506-4cca-ba5a-118610ac642f
[2m2025-10-08T22:05:41.400134Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 17deddaa-3506-4cca-ba5a-118610ac642f: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:05:41.400142Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 17deddaa-3506-4cca-ba5a-118610ac642f: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:41.400173Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 17deddaa-3506-4cca-ba5a-118610ac642f: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.400282Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.400361Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m2baaf2de-9540-425a-8fe1-2d75fd275ba5
[2m2025-10-08T22:05:41.400385Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2baaf2de-9540-425a-8fe1-2d75fd275ba5: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:05:41.400395Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2baaf2de-9540-425a-8fe1-2d75fd275ba5: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:41.400406Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2baaf2de-9540-425a-8fe1-2d75fd275ba5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.404649Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 2baaf2de-9540-425a-8fe1-2d75fd275ba5: Retrieved 100 invoice details (total: 2535) in 4ms with enhanced pagination
[2m2025-10-08T22:05:41.405881Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 17deddaa-3506-4cca-ba5a-118610ac642f: Retrieved 100 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:05:41.407085Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.407134Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m88a25b7f-9bd1-4e1c-8c46-d854b470fdbc
[2m2025-10-08T22:05:41.407141Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88a25b7f-9bd1-4e1c-8c46-d854b470fdbc: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:05:41.407147Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88a25b7f-9bd1-4e1c-8c46-d854b470fdbc: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:41.407155Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88a25b7f-9bd1-4e1c-8c46-d854b470fdbc: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.411334Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88a25b7f-9bd1-4e1c-8c46-d854b470fdbc: Retrieved 100 invoice details (total: 2535) in 4ms with enhanced pagination
[2m2025-10-08T22:05:41.696905Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.696981Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5619e1f5-858c-448d-8938-f3d997dfc2c7
[2m2025-10-08T22:05:41.696990Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5619e1f5-858c-448d-8938-f3d997dfc2c7: Processing for user 1 with limit 100 offset 300 order_by date direction DESC
[2m2025-10-08T22:05:41.696997Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5619e1f5-858c-448d-8938-f3d997dfc2c7: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:41.697006Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5619e1f5-858c-448d-8938-f3d997dfc2c7: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.697379Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.697417Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m968fa90b-a503-4d32-a50d-9bfa3c4555d5
[2m2025-10-08T22:05:41.697424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 968fa90b-a503-4d32-a50d-9bfa3c4555d5: Processing for user 1 with limit 100 offset 400 order_by date direction DESC
[2m2025-10-08T22:05:41.697440Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 968fa90b-a503-4d32-a50d-9bfa3c4555d5: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:41.697447Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 968fa90b-a503-4d32-a50d-9bfa3c4555d5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.705117Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5619e1f5-858c-448d-8938-f3d997dfc2c7: Retrieved 100 invoice details (total: 2535) in 8ms with enhanced pagination
[2m2025-10-08T22:05:41.706048Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 968fa90b-a503-4d32-a50d-9bfa3c4555d5: Retrieved 100 invoice details (total: 2535) in 8ms with enhanced pagination
[2m2025-10-08T22:05:41.707552Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:41.707680Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf7d0f67a-e8e7-4ec0-bbeb-4f10b7838ddb
[2m2025-10-08T22:05:41.707760Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f7d0f67a-e8e7-4ec0-bbeb-4f10b7838ddb: Processing for user 1 with limit 100 offset 500 order_by date direction DESC
[2m2025-10-08T22:05:41.707816Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f7d0f67a-e8e7-4ec0-bbeb-4f10b7838ddb: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:41.707922Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f7d0f67a-e8e7-4ec0-bbeb-4f10b7838ddb: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:41.713424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f7d0f67a-e8e7-4ec0-bbeb-4f10b7838ddb: Retrieved 100 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:05:42.009596Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.009666Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mdc41a139-89c1-4160-b65c-6f3e411acb30
[2m2025-10-08T22:05:42.009675Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dc41a139-89c1-4160-b65c-6f3e411acb30: Processing for user 1 with limit 100 offset 600 order_by date direction DESC
[2m2025-10-08T22:05:42.009681Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dc41a139-89c1-4160-b65c-6f3e411acb30: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.009690Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dc41a139-89c1-4160-b65c-6f3e411acb30: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.014230Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dc41a139-89c1-4160-b65c-6f3e411acb30: Retrieved 100 invoice details (total: 2535) in 4ms with enhanced pagination
[2m2025-10-08T22:05:42.015637Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.015687Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb35f5788-ddee-44ef-a2ad-834a321e858a
[2m2025-10-08T22:05:42.015694Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b35f5788-ddee-44ef-a2ad-834a321e858a: Processing for user 1 with limit 100 offset 700 order_by date direction DESC
[2m2025-10-08T22:05:42.015700Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b35f5788-ddee-44ef-a2ad-834a321e858a: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.015706Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b35f5788-ddee-44ef-a2ad-834a321e858a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.021454Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.021494Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m358859e5-c1f0-44a1-b2a4-a3e1ccbef06b
[2m2025-10-08T22:05:42.021502Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 358859e5-c1f0-44a1-b2a4-a3e1ccbef06b: Processing for user 1 with limit 100 offset 800 order_by date direction DESC
[2m2025-10-08T22:05:42.021508Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 358859e5-c1f0-44a1-b2a4-a3e1ccbef06b: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.021515Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 358859e5-c1f0-44a1-b2a4-a3e1ccbef06b: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.024632Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b35f5788-ddee-44ef-a2ad-834a321e858a: Retrieved 100 invoice details (total: 2535) in 8ms with enhanced pagination
[2m2025-10-08T22:05:42.030288Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 358859e5-c1f0-44a1-b2a4-a3e1ccbef06b: Retrieved 100 invoice details (total: 2535) in 8ms with enhanced pagination
[2m2025-10-08T22:05:42.331795Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.331887Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mbe135665-ee3b-402b-93b8-401ceb7995e2
[2m2025-10-08T22:05:42.331911Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request be135665-ee3b-402b-93b8-401ceb7995e2: Processing for user 1 with limit 100 offset 900 order_by date direction DESC
[2m2025-10-08T22:05:42.331918Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request be135665-ee3b-402b-93b8-401ceb7995e2: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.331927Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request be135665-ee3b-402b-93b8-401ceb7995e2: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.331971Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.332036Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma16ce00d-9b37-4620-9036-a246cbd16390
[2m2025-10-08T22:05:42.332048Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a16ce00d-9b37-4620-9036-a246cbd16390: Processing for user 1 with limit 100 offset 1000 order_by date direction DESC
[2m2025-10-08T22:05:42.332056Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a16ce00d-9b37-4620-9036-a246cbd16390: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.332065Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a16ce00d-9b37-4620-9036-a246cbd16390: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.337617Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a16ce00d-9b37-4620-9036-a246cbd16390: Retrieved 100 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:05:42.337905Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.337969Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m64913743-0505-4e9a-b9de-1662ac2023a7
[2m2025-10-08T22:05:42.337976Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64913743-0505-4e9a-b9de-1662ac2023a7: Processing for user 1 with limit 100 offset 1100 order_by date direction DESC
[2m2025-10-08T22:05:42.337982Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64913743-0505-4e9a-b9de-1662ac2023a7: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.337989Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64913743-0505-4e9a-b9de-1662ac2023a7: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.339666Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request be135665-ee3b-402b-93b8-401ceb7995e2: Retrieved 100 invoice details (total: 2535) in 7ms with enhanced pagination
[2m2025-10-08T22:05:42.345502Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 64913743-0505-4e9a-b9de-1662ac2023a7: Retrieved 100 invoice details (total: 2535) in 7ms with enhanced pagination
[2m2025-10-08T22:05:42.696737Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.696831Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m230618ca-cead-446b-8ed3-3d875f411113
[2m2025-10-08T22:05:42.696854Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 230618ca-cead-446b-8ed3-3d875f411113: Processing for user 1 with limit 100 offset 1200 order_by date direction DESC
[2m2025-10-08T22:05:42.696863Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 230618ca-cead-446b-8ed3-3d875f411113: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.696873Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 230618ca-cead-446b-8ed3-3d875f411113: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.696826Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.700302Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me8037539-b829-4796-b460-483440a6419a
[2m2025-10-08T22:05:42.700314Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e8037539-b829-4796-b460-483440a6419a: Processing for user 1 with limit 100 offset 1300 order_by date direction DESC
[2m2025-10-08T22:05:42.700321Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e8037539-b829-4796-b460-483440a6419a: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.700328Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e8037539-b829-4796-b460-483440a6419a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.703695Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:42.703735Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m577ae451-79d4-408e-8cbc-9b0d2619f3e0
[2m2025-10-08T22:05:42.703741Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 577ae451-79d4-408e-8cbc-9b0d2619f3e0: Processing for user 1 with limit 100 offset 1400 order_by date direction DESC
[2m2025-10-08T22:05:42.703757Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 577ae451-79d4-408e-8cbc-9b0d2619f3e0: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:42.703764Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 577ae451-79d4-408e-8cbc-9b0d2619f3e0: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:42.705923Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 230618ca-cead-446b-8ed3-3d875f411113: Retrieved 100 invoice details (total: 2535) in 9ms with enhanced pagination
[2m2025-10-08T22:05:42.708049Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e8037539-b829-4796-b460-483440a6419a: Retrieved 100 invoice details (total: 2535) in 7ms with enhanced pagination
[2m2025-10-08T22:05:42.710082Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 577ae451-79d4-408e-8cbc-9b0d2619f3e0: Retrieved 100 invoice details (total: 2535) in 6ms with enhanced pagination
[2m2025-10-08T22:05:43.092790Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.092884Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m94dc3939-626d-4da1-ae6f-b903f5d3f22f
[2m2025-10-08T22:05:43.092898Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 94dc3939-626d-4da1-ae6f-b903f5d3f22f: Processing for user 1 with limit 100 offset 1500 order_by date direction DESC
[2m2025-10-08T22:05:43.092908Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 94dc3939-626d-4da1-ae6f-b903f5d3f22f: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.092920Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 94dc3939-626d-4da1-ae6f-b903f5d3f22f: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.092921Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.092979Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5cb24478-14a5-4709-924d-b10bad76c570
[2m2025-10-08T22:05:43.092994Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5cb24478-14a5-4709-924d-b10bad76c570: Processing for user 1 with limit 100 offset 1600 order_by date direction DESC
[2m2025-10-08T22:05:43.093002Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5cb24478-14a5-4709-924d-b10bad76c570: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.093011Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5cb24478-14a5-4709-924d-b10bad76c570: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.098941Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 94dc3939-626d-4da1-ae6f-b903f5d3f22f: Retrieved 100 invoice details (total: 2535) in 6ms with enhanced pagination
[2m2025-10-08T22:05:43.099289Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.099331Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mbb63bf19-476c-4568-bfb5-b366f15d6922
[2m2025-10-08T22:05:43.099341Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bb63bf19-476c-4568-bfb5-b366f15d6922: Processing for user 1 with limit 100 offset 1700 order_by date direction DESC
[2m2025-10-08T22:05:43.099350Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bb63bf19-476c-4568-bfb5-b366f15d6922: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.099363Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bb63bf19-476c-4568-bfb5-b366f15d6922: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.101107Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5cb24478-14a5-4709-924d-b10bad76c570: Retrieved 100 invoice details (total: 2535) in 8ms with enhanced pagination
[2m2025-10-08T22:05:43.104937Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bb63bf19-476c-4568-bfb5-b366f15d6922: Retrieved 100 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:05:43.522729Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.522811Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb3d8ce7e-3f7b-40a0-b33e-17a1b5f20ce2
[2m2025-10-08T22:05:43.522819Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b3d8ce7e-3f7b-40a0-b33e-17a1b5f20ce2: Processing for user 1 with limit 100 offset 1900 order_by date direction DESC
[2m2025-10-08T22:05:43.522827Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b3d8ce7e-3f7b-40a0-b33e-17a1b5f20ce2: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.522835Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b3d8ce7e-3f7b-40a0-b33e-17a1b5f20ce2: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.522729Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.523108Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m197736fa-38a5-4291-b99c-13ec20f90be4
[2m2025-10-08T22:05:43.523132Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 197736fa-38a5-4291-b99c-13ec20f90be4: Processing for user 1 with limit 100 offset 1800 order_by date direction DESC
[2m2025-10-08T22:05:43.523138Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 197736fa-38a5-4291-b99c-13ec20f90be4: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.523144Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 197736fa-38a5-4291-b99c-13ec20f90be4: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.528551Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 197736fa-38a5-4291-b99c-13ec20f90be4: Retrieved 100 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:05:43.530331Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.530416Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m26dda1b2-b57c-42a3-a02f-6d3ab1ad5fcf
[2m2025-10-08T22:05:43.530426Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 26dda1b2-b57c-42a3-a02f-6d3ab1ad5fcf: Processing for user 1 with limit 100 offset 2000 order_by date direction DESC
[2m2025-10-08T22:05:43.530432Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 26dda1b2-b57c-42a3-a02f-6d3ab1ad5fcf: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.530438Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 26dda1b2-b57c-42a3-a02f-6d3ab1ad5fcf: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.532704Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b3d8ce7e-3f7b-40a0-b33e-17a1b5f20ce2: Retrieved 100 invoice details (total: 2535) in 9ms with enhanced pagination
[2m2025-10-08T22:05:43.538302Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 26dda1b2-b57c-42a3-a02f-6d3ab1ad5fcf: Retrieved 100 invoice details (total: 2535) in 7ms with enhanced pagination
[2m2025-10-08T22:05:43.933760Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.933838Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m77783482-2693-4f07-8f40-751f89b8b66e
[2m2025-10-08T22:05:43.933846Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 77783482-2693-4f07-8f40-751f89b8b66e: Processing for user 1 with limit 100 offset 2100 order_by date direction DESC
[2m2025-10-08T22:05:43.933854Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 77783482-2693-4f07-8f40-751f89b8b66e: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.933863Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 77783482-2693-4f07-8f40-751f89b8b66e: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.939662Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.939739Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0c763f51-e654-4965-ae66-f835d5c3dd46
[2m2025-10-08T22:05:43.939748Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0c763f51-e654-4965-ae66-f835d5c3dd46: Processing for user 1 with limit 100 offset 2200 order_by date direction DESC
[2m2025-10-08T22:05:43.939755Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0c763f51-e654-4965-ae66-f835d5c3dd46: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.939762Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0c763f51-e654-4965-ae66-f835d5c3dd46: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.942392Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 77783482-2693-4f07-8f40-751f89b8b66e: Retrieved 100 invoice details (total: 2535) in 8ms with enhanced pagination
[2m2025-10-08T22:05:43.946125Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:43.946222Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mfd97ec67-9beb-429a-9afa-679510cc5e73
[2m2025-10-08T22:05:43.946233Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd97ec67-9beb-429a-9afa-679510cc5e73: Processing for user 1 with limit 100 offset 2300 order_by date direction DESC
[2m2025-10-08T22:05:43.946239Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd97ec67-9beb-429a-9afa-679510cc5e73: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:43.946246Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd97ec67-9beb-429a-9afa-679510cc5e73: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:43.951894Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd97ec67-9beb-429a-9afa-679510cc5e73: Retrieved 100 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:05:43.952679Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0c763f51-e654-4965-ae66-f835d5c3dd46: Retrieved 100 invoice details (total: 2535) in 12ms with enhanced pagination
[2m2025-10-08T22:05:44.342301Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:44.342400Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m063a36d1-a5a9-42ba-b8ad-9234afb348cc
[2m2025-10-08T22:05:44.342409Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 063a36d1-a5a9-42ba-b8ad-9234afb348cc: Processing for user 1 with limit 100 offset 2400 order_by date direction DESC
[2m2025-10-08T22:05:44.342417Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 063a36d1-a5a9-42ba-b8ad-9234afb348cc: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:44.342424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 063a36d1-a5a9-42ba-b8ad-9234afb348cc: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:44.342887Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:44.342926Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m14091930-5b8e-47eb-a186-17787506439b
[2m2025-10-08T22:05:44.342933Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 14091930-5b8e-47eb-a186-17787506439b: Processing for user 1 with limit 100 offset 2500 order_by date direction DESC
[2m2025-10-08T22:05:44.342939Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 14091930-5b8e-47eb-a186-17787506439b: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:44.342945Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 14091930-5b8e-47eb-a186-17787506439b: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:44.351477Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:44.351554Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf18487ea-e228-4cc0-a771-1408f06a71f9
[2m2025-10-08T22:05:44.351563Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f18487ea-e228-4cc0-a771-1408f06a71f9: Processing for user 1 with limit 100 offset 2600 order_by date direction DESC
[2m2025-10-08T22:05:44.351570Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f18487ea-e228-4cc0-a771-1408f06a71f9: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:44.351577Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f18487ea-e228-4cc0-a771-1408f06a71f9: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:44.352705Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 063a36d1-a5a9-42ba-b8ad-9234afb348cc: Retrieved 100 invoice details (total: 2535) in 10ms with enhanced pagination
[2m2025-10-08T22:05:44.352933Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 14091930-5b8e-47eb-a186-17787506439b: Retrieved 35 invoice details (total: 2535) in 10ms with enhanced pagination
[2m2025-10-08T22:05:44.357172Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f18487ea-e228-4cc0-a771-1408f06a71f9: Retrieved 0 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:05:44.666169Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:44.666265Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m7b22a4af-18fa-448c-a172-78c81863266b
[2m2025-10-08T22:05:44.666275Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7b22a4af-18fa-448c-a172-78c81863266b: Processing for user 1 with limit 100 offset 2700 order_by date direction DESC
[2m2025-10-08T22:05:44.666284Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7b22a4af-18fa-448c-a172-78c81863266b: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:44.666293Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7b22a4af-18fa-448c-a172-78c81863266b: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:44.666501Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:44.666538Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mc36477bd-9892-4265-b7be-81ac7b2d30e5
[2m2025-10-08T22:05:44.666547Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c36477bd-9892-4265-b7be-81ac7b2d30e5: Processing for user 1 with limit 100 offset 2800 order_by date direction DESC
[2m2025-10-08T22:05:44.666554Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c36477bd-9892-4265-b7be-81ac7b2d30e5: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:44.666562Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c36477bd-9892-4265-b7be-81ac7b2d30e5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:44.672606Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:05:44.672651Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mfdad48cc-e2dd-474d-94b3-33360bf43520
[2m2025-10-08T22:05:44.672660Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fdad48cc-e2dd-474d-94b3-33360bf43520: Processing for user 1 with limit 100 offset 2900 order_by date direction DESC
[2m2025-10-08T22:05:44.672677Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fdad48cc-e2dd-474d-94b3-33360bf43520: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:05:44.672682Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fdad48cc-e2dd-474d-94b3-33360bf43520: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:05:44.672856Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c36477bd-9892-4265-b7be-81ac7b2d30e5: Retrieved 0 invoice details (total: 2535) in 6ms with enhanced pagination
[2m2025-10-08T22:05:44.673867Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7b22a4af-18fa-448c-a172-78c81863266b: Retrieved 0 invoice details (total: 2535) in 7ms with enhanced pagination
[2m2025-10-08T22:05:44.677743Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fdad48cc-e2dd-474d-94b3-33360bf43520: Retrieved 0 invoice details (total: 2535) in 5ms with enhanced pagination
[2m2025-10-08T22:06:02.188039Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:06:02.188097Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m9dfcfd52-2cb1-47e8-b461-c3915a350cf4 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:06:02.188107Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:06:02.191190Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m9dfcfd52-2cb1-47e8-b461-c3915a350cf4 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:06:02.191253Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m2a68142f-53f0-45ff-b2a0-2b466336ac33
[2m2025-10-08T22:06:02.191691Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m2a68142f-53f0-45ff-b2a0-2b466336ac33 [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:06:02.195304Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:06:02.195292106 UTC
[2m2025-10-08T22:06:02.197265Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m9dfcfd52-2cb1-47e8-b461-c3915a350cf4 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:06:02.197291Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m9dfcfd52-2cb1-47e8-b461-c3915a350cf4 [3mexecution_time_ms[0m[2m=[0m9
[2m2025-10-08T22:06:17.488769Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request b57af42b-7233-4956-a353-1f6dbee6187c: Checking email existence: andrescarriela@gmail.com
[2m2025-10-08T22:06:17.488977Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request b57af42b-7233-4956-a353-1f6dbee6187c: Querying database for email: andrescarriela@gmail.com
[2m2025-10-08T22:06:17.490388Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request b57af42b-7233-4956-a353-1f6dbee6187c: Found existing user with ID: 2
[2m2025-10-08T22:06:17.490412Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request b57af42b-7233-4956-a353-1f6dbee6187c: Email andrescarriela@gmail.com exists with password: true
[2m2025-10-08T22:06:28.363220Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:06:28.363274Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m5422eff9-ea7f-4a7c-95d2-5c7361b07885 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123.", name: None }
[2m2025-10-08T22:06:28.363287Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:06:28.368385Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m5422eff9-ea7f-4a7c-95d2-5c7361b07885 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:06:28.645672Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m5422eff9-ea7f-4a7c-95d2-5c7361b07885 [3mevent_type[0m[2m=[0mlogin_failure [3msuccess[0m[2m=[0mfalse
[2m2025-10-08T22:06:28.645725Z[0m [31mERROR[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚ùå Authentication failed [3mrequest_id[0m[2m=[0m5422eff9-ea7f-4a7c-95d2-5c7361b07885 [3mexecution_time_ms[0m[2m=[0m282 [3merror[0m[2m=[0mInvalid credentials
[2m2025-10-08T22:06:28.645736Z[0m [31mERROR[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m Authentication failed: Invalid credentials
[2m2025-10-08T22:08:51.583847Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:08:51.583908Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m031b0d91-91b5-408b-bd56-ff31d08a69df [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:08:51.583942Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:08:51.586929Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m031b0d91-91b5-408b-bd56-ff31d08a69df [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:08:51.586958Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0mc9abcd44-25de-41e9-88d6-4f0bb8558314
[2m2025-10-08T22:08:51.587434Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0mc9abcd44-25de-41e9-88d6-4f0bb8558314 [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:08:51.590506Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:08:51.590494836 UTC
[2m2025-10-08T22:08:51.594380Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m031b0d91-91b5-408b-bd56-ff31d08a69df [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:08:51.594411Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m031b0d91-91b5-408b-bd56-ff31d08a69df [3mexecution_time_ms[0m[2m=[0m10
[2m2025-10-08T22:09:36.419581Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request 794817a9-b38e-4da5-a190-97d995f55d46: Checking email existence: andrescarriela@gmail.com
[2m2025-10-08T22:09:36.419773Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request 794817a9-b38e-4da5-a190-97d995f55d46: Querying database for email: andrescarriela@gmail.com
[2m2025-10-08T22:09:36.420889Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request 794817a9-b38e-4da5-a190-97d995f55d46: Found existing user with ID: 2
[2m2025-10-08T22:09:36.420913Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request 794817a9-b38e-4da5-a190-97d995f55d46: Email andrescarriela@gmail.com exists with password: true
[2m2025-10-08T22:09:49.947100Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:09:49.947207Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0meec0ba8d-9760-4902-8c7c-dc4eaead444d [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:09:49.947246Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:09:49.949911Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0meec0ba8d-9760-4902-8c7c-dc4eaead444d [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:09:50.228040Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:09:50.228016882 UTC
[2m2025-10-08T22:09:50.231763Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0meec0ba8d-9760-4902-8c7c-dc4eaead444d [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:09:50.231797Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0meec0ba8d-9760-4902-8c7c-dc4eaead444d [3mexecution_time_ms[0m[2m=[0m284
[2m2025-10-08T22:09:55.263937Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:09:55.263982Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m814cfce4-60cf-4073-b6cb-3b88919f62a1 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:09:55.263992Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:09:55.267970Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m814cfce4-60cf-4073-b6cb-3b88919f62a1 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:09:55.548247Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:09:55.548226844 UTC
[2m2025-10-08T22:09:55.551250Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m814cfce4-60cf-4073-b6cb-3b88919f62a1 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:09:55.551284Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m814cfce4-60cf-4073-b6cb-3b88919f62a1 [3mexecution_time_ms[0m[2m=[0m287
[2m2025-10-08T22:10:06.320699Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:10:06.320747Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0mb2edeed6-cb6e-4471-8e2b-27a8dfc7139c [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:10:06.320757Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:10:06.325380Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mb2edeed6-cb6e-4471-8e2b-27a8dfc7139c [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:10:06.600512Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:10:06.600477902 UTC
[2m2025-10-08T22:10:06.603602Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mb2edeed6-cb6e-4471-8e2b-27a8dfc7139c [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:10:06.603634Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0mb2edeed6-cb6e-4471-8e2b-27a8dfc7139c [3mexecution_time_ms[0m[2m=[0m282
[2m2025-10-08T22:10:09.416333Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:10:09.416399Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T22:10:09.417362Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 296 L√ºmis
[2m2025-10-08T22:10:19.328129Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:10:19.328229Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0md260ac83-c050-4f97-b08f-b3c93b6e4d6c [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:10:19.328242Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:10:19.331073Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0md260ac83-c050-4f97-b08f-b3c93b6e4d6c [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:10:19.609017Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:10:19.608993278 UTC
[2m2025-10-08T22:10:19.612047Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0md260ac83-c050-4f97-b08f-b3c93b6e4d6c [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:10:19.612082Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0md260ac83-c050-4f97-b08f-b3c93b6e4d6c [3mexecution_time_ms[0m[2m=[0m283
[2m2025-10-08T22:10:25.056724Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:10:25.056780Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m8017e157-f62a-4c35-8b79-0a0b9b98c095 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA5NjkzNjUyNjM1MDUwNTI1Nzk2IiwiZW1haWwiOiJhbnZhbGVuY2lhZ0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBWIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxMWxLWWZnckotc3VHTHdKNjk2R0p4WllXQ0twaUFIV3pjU3VxRmFjbkVnaFRxNkE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJWIiwiaWF0IjoxNzU5OTYxNDI0LCJleHAiOjE3NTk5NjUwMjR9.NumVKZkueEyOfdKzeoT4YnLuk1sDx9DQYB9mNqKSV2S1A7YDGN_Qw5DJvkxY3lwJoi9sLEX3r2cZQ7QEZ9E29NLflRYxFzRiEjnKiNl4n6juXXkKONJAfYVjQ5RCqC8bEVH6BipWCcZmAa0R0quUFpYvyZRM5ehzCc-hz4eza9HKHlkydGwMEiRXGkHp0i-H31JF8BPA5MpvhCoqs92opUecrpRabuW0A0ScEDGm0gQctMPph2dLaSaf5C9YPWELmmfk-qJbnhbn-evtKVl2aVT2mqKWCmQfcixXMxAN_0N9QzAnsHgPhIAJfxODh899KqVQPU47gJttRXymK8Xc5A", access_token: None }
[2m2025-10-08T22:10:25.056802Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:10:25.060047Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m8017e157-f62a-4c35-8b79-0a0b9b98c095 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:10:25.060076Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0me47b917d-be17-401b-8fae-6c6a1fa70feb
[2m2025-10-08T22:10:25.060433Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0me47b917d-be17-401b-8fae-6c6a1fa70feb [3muser_id[0m[2m=[0m109693652635050525796 [3memail[0m[2m=[0manvalenciag@gmail.com [3mname[0m[2m=[0mSome("Andres V") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:10:25.063764Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:10:25.063752951 UTC
[2m2025-10-08T22:10:25.066398Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m8017e157-f62a-4c35-8b79-0a0b9b98c095 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:10:25.066426Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m8017e157-f62a-4c35-8b79-0a0b9b98c095 [3mexecution_time_ms[0m[2m=[0m9
[2m2025-10-08T22:10:25.450308Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.450387Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m1c798be5-5f43-47d0-844b-f76835bf6ddc
[2m2025-10-08T22:10:25.450397Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1c798be5-5f43-47d0-844b-f76835bf6ddc: Processing headers for user 70 with limit 50 offset 50
[2m2025-10-08T22:10:25.450407Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1c798be5-5f43-47d0-844b-f76835bf6ddc: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:10:25.453336Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1c798be5-5f43-47d0-844b-f76835bf6ddc: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-08T22:10:25.458807Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.458844Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 70
[2m2025-10-08T22:10:25.459357Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 70 in 0ms: 0 L√ºmis
[2m2025-10-08T22:10:25.465567Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.465685Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0med88ad9f-d41c-41aa-a892-61e9600b2cc6
[2m2025-10-08T22:10:25.465759Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ed88ad9f-d41c-41aa-a892-61e9600b2cc6: Processing headers for user 70 with limit 50 offset 0
[2m2025-10-08T22:10:25.465773Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ed88ad9f-d41c-41aa-a892-61e9600b2cc6: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:10:25.467650Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ed88ad9f-d41c-41aa-a892-61e9600b2cc6: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T22:10:25.479780Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.479818Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m46eaa3cf-582f-4f1d-8e47-4e9de8c97376
[2m2025-10-08T22:10:25.479824Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 46eaa3cf-582f-4f1d-8e47-4e9de8c97376: Processing headers for user 70 with limit 50 offset 100
[2m2025-10-08T22:10:25.479847Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 46eaa3cf-582f-4f1d-8e47-4e9de8c97376: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:10:25.481055Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 46eaa3cf-582f-4f1d-8e47-4e9de8c97376: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T22:10:25.486749Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.487141Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.487317Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 70
[2m2025-10-08T22:10:25.487692Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 70 - email: Some("anvalenciag@gmail.com")
[2m2025-10-08T22:10:25.614287Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.614349Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m047210b3-edc8-42ce-80a7-b1b3908813d0
[2m2025-10-08T22:10:25.614356Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 047210b3-edc8-42ce-80a7-b1b3908813d0: Processing for user 70 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:10:25.614363Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 047210b3-edc8-42ce-80a7-b1b3908813d0: Querying details for user 70 with enhanced filters
[2m2025-10-08T22:10:25.614377Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 047210b3-edc8-42ce-80a7-b1b3908813d0: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:10:25.614523Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.614544Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m09636336-e2df-4933-bd6c-ea0ea762be0b
[2m2025-10-08T22:10:25.614557Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 09636336-e2df-4933-bd6c-ea0ea762be0b: Processing for user 70 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:10:25.614562Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 09636336-e2df-4933-bd6c-ea0ea762be0b: Querying details for user 70 with enhanced filters
[2m2025-10-08T22:10:25.614567Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 09636336-e2df-4933-bd6c-ea0ea762be0b: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:10:25.619938Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 047210b3-edc8-42ce-80a7-b1b3908813d0: Retrieved 0 invoice details (total: 0) in 5ms with enhanced pagination
[2m2025-10-08T22:10:25.621336Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:25.621370Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m5143bb63-e9b8-462c-83c5-689a60194d85
[2m2025-10-08T22:10:25.621376Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5143bb63-e9b8-462c-83c5-689a60194d85: Processing for user 70 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:10:25.621382Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5143bb63-e9b8-462c-83c5-689a60194d85: Querying details for user 70 with enhanced filters
[2m2025-10-08T22:10:25.621388Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5143bb63-e9b8-462c-83c5-689a60194d85: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:10:25.623646Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 09636336-e2df-4933-bd6c-ea0ea762be0b: Retrieved 0 invoice details (total: 0) in 9ms with enhanced pagination
[2m2025-10-08T22:10:25.625534Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5143bb63-e9b8-462c-83c5-689a60194d85: Retrieved 0 invoice details (total: 0) in 4ms with enhanced pagination
[2m2025-10-08T22:10:37.662583Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m70 [3memail[0m[2m=[0manvalenciag@gmail.com
[2m2025-10-08T22:10:37.662680Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 70
[2m2025-10-08T22:10:37.663924Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 70 in 1ms: 0 L√ºmis
[2m2025-10-08T22:11:00.006755Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:11:00.006822Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m2038507a-25c5-4de1-b5be-fdf3e0936f85 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA3MTkwNzE2NjAyOTQyMjAxNDUzIiwiZW1haWwiOiJsdW1hcHAyNUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6Imx1bSIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NMczBYRzFFOEc5bWxqNUZlRWxuOTJEeVdEdUtjQWNZcFJOVmFrX2hjeFBLN1JiWlE9czk2LWMiLCJnaXZlbl9uYW1lIjoibHVtIiwiaWF0IjoxNzU5OTYxNDU5LCJleHAiOjE3NTk5NjUwNTl9.DcPEs24LmBX070q9y45iiN2_Tx3HEVZ5q9Q6xUFHLu5ybZItEC0niGCirNIP-JwL0fRSGPva1Re41QdY6jhaABXYBz2T05cOcsir7maQXeowPaQusMbHoYtKB77lO6R0y2RiaafRydluzZOcVPthc8osh9RTPAiD5IXd27LiXi3vTvMAyeRn5YLH3WNlWE50xiqF7KLRIQ2ptYYEH5_m2THLl6PRGF2XsrVofsH9RM-QRDUvhP3g_D1gpElnLh8_kUCYrgr2NvQn_lUjfo-jSz9PmT0D3HCX1Mowh3GLJfX22Ik14dkDIk5f66HasNiHEI8RcrRppfuaAqLR4Rn1Mw", access_token: None }
[2m2025-10-08T22:11:00.006847Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:11:00.010449Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m2038507a-25c5-4de1-b5be-fdf3e0936f85 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:11:00.010482Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m52945d35-4e02-4beb-b7ed-18b57c96fc07
[2m2025-10-08T22:11:00.011096Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m52945d35-4e02-4beb-b7ed-18b57c96fc07 [3muser_id[0m[2m=[0m107190716602942201453 [3memail[0m[2m=[0mlumapp25@gmail.com [3mname[0m[2m=[0mSome("lum") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:11:00.014739Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:11:00.014724318 UTC
[2m2025-10-08T22:11:00.017291Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m2038507a-25c5-4de1-b5be-fdf3e0936f85 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:11:00.017327Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m2038507a-25c5-4de1-b5be-fdf3e0936f85 [3mexecution_time_ms[0m[2m=[0m10
[2m2025-10-08T22:11:00.488398Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.488476Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m5cc36e42-aba2-4c15-8785-f8705188bd57
[2m2025-10-08T22:11:00.488485Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5cc36e42-aba2-4c15-8785-f8705188bd57: Processing headers for user 72 with limit 50 offset 0
[2m2025-10-08T22:11:00.488494Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5cc36e42-aba2-4c15-8785-f8705188bd57: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:11:00.488572Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.488623Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 72
[2m2025-10-08T22:11:00.489233Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 72 in 0ms: 0 L√ºmis
[2m2025-10-08T22:11:00.489726Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 5cc36e42-aba2-4c15-8785-f8705188bd57: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T22:11:00.490965Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.491012Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.491025Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 72
[2m2025-10-08T22:11:00.491697Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 72 - email: Some("lumapp25@gmail.com")
[2m2025-10-08T22:11:00.495683Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.495752Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc1c9d2a3-1ab1-4dd4-9792-3939b95da0c8
[2m2025-10-08T22:11:00.495761Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c1c9d2a3-1ab1-4dd4-9792-3939b95da0c8: Processing headers for user 72 with limit 50 offset 50
[2m2025-10-08T22:11:00.495771Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c1c9d2a3-1ab1-4dd4-9792-3939b95da0c8: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:11:00.496726Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c1c9d2a3-1ab1-4dd4-9792-3939b95da0c8: Retrieved 0 invoice headers (total: 0) in 0ms with enhanced filtering
[2m2025-10-08T22:11:00.497097Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.497177Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3e5709e9-2aa4-4e55-b040-45c4154f8fcc
[2m2025-10-08T22:11:00.497193Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3e5709e9-2aa4-4e55-b040-45c4154f8fcc: Processing headers for user 72 with limit 50 offset 100
[2m2025-10-08T22:11:00.497202Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3e5709e9-2aa4-4e55-b040-45c4154f8fcc: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:11:00.497989Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3e5709e9-2aa4-4e55-b040-45c4154f8fcc: Retrieved 0 invoice headers (total: 0) in 0ms with enhanced filtering
[2m2025-10-08T22:11:00.678068Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.678181Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m392695d9-fe98-4b23-9e58-0e20cf926226
[2m2025-10-08T22:11:00.678193Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 392695d9-fe98-4b23-9e58-0e20cf926226: Processing for user 72 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:11:00.678201Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 392695d9-fe98-4b23-9e58-0e20cf926226: Querying details for user 72 with enhanced filters
[2m2025-10-08T22:11:00.678210Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 392695d9-fe98-4b23-9e58-0e20cf926226: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:11:00.679443Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 392695d9-fe98-4b23-9e58-0e20cf926226: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T22:11:00.685007Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.685057Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m88221075-72d5-41bf-8b5a-e2a6c0b83cb1
[2m2025-10-08T22:11:00.685065Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88221075-72d5-41bf-8b5a-e2a6c0b83cb1: Processing for user 72 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:11:00.685071Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88221075-72d5-41bf-8b5a-e2a6c0b83cb1: Querying details for user 72 with enhanced filters
[2m2025-10-08T22:11:00.685079Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88221075-72d5-41bf-8b5a-e2a6c0b83cb1: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:11:00.686343Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:00.686402Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0md0a8bb51-9352-4be8-a80f-1c8351bf50d3
[2m2025-10-08T22:11:00.686410Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d0a8bb51-9352-4be8-a80f-1c8351bf50d3: Processing for user 72 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:11:00.686417Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d0a8bb51-9352-4be8-a80f-1c8351bf50d3: Querying details for user 72 with enhanced filters
[2m2025-10-08T22:11:00.686424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d0a8bb51-9352-4be8-a80f-1c8351bf50d3: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:11:00.687125Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 88221075-72d5-41bf-8b5a-e2a6c0b83cb1: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T22:11:00.688096Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d0a8bb51-9352-4be8-a80f-1c8351bf50d3: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T22:11:14.138307Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m72 [3memail[0m[2m=[0mlumapp25@gmail.com
[2m2025-10-08T22:11:14.138370Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 72
[2m2025-10-08T22:11:14.139017Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 72 in 0ms: 0 L√ºmis
[2m2025-10-08T22:12:30.150428Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:12:30.150500Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m382b9588-cb07-4d1a-b456-a390d2c4b179 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA2MDYzOTM2NDI0NDM3NjIxMDgwIiwiZW1haWwiOiJhbmRyZXNmZWxpcGV2YWxlbmNpYWdAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJBbmRyZXMgVmFsZW5jaWEiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSk9Xd083eUdDWVA1OHB4ZFZCd2R6MGJudWtITHdwcjk0RklVbGNEckxHYnVrYUFBPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6IkFuZHJlcyIsImZhbWlseV9uYW1lIjoiVmFsZW5jaWEiLCJpYXQiOjE3NTk5NjExMTMsImV4cCI6MTc1OTk2NDcxM30.D-KEeH66kQi977BmY2g5Q7ndWNNAOu3MogcNXvn9iTMhu1F6llpilj98ipMoRKL31C4B2Fvruc7iXPUcosc91kFT9rgjnzhHCjQcXvj-S4P8fug-gjMQy1GA5Ykg6Y0KE3i5z6SqlgTHHXIsiZR2syTjyZkg9RymqSqWEGXSULgPMUkqEhoGgIWkAv3Wi-FH8AzPz9QXMNfBXs81_Jd1c2MuiF8ppXmkdEB0hSzM2iCiko8TkBao1wW3gsb_JMmtJf4rD-4GHcXNiCd9PY456D0O3Z1ZTgbdraPXxQBXKpr9RCeIwaN_8tNIIuH-1Rs-q2Lbzc2SpwiV0dCrwk7j6Q", access_token: None }
[2m2025-10-08T22:12:30.150512Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:12:30.152850Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m382b9588-cb07-4d1a-b456-a390d2c4b179 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:12:30.152881Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0md4b68f10-e244-4178-86a3-20636b9bee70
[2m2025-10-08T22:12:30.153271Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0md4b68f10-e244-4178-86a3-20636b9bee70 [3muser_id[0m[2m=[0m106063936424437621080 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mname[0m[2m=[0mSome("Andres Valencia") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:12:30.155882Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:12:30.155872118 UTC
[2m2025-10-08T22:12:30.158014Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m382b9588-cb07-4d1a-b456-a390d2c4b179 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:12:30.158043Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m382b9588-cb07-4d1a-b456-a390d2c4b179 [3mexecution_time_ms[0m[2m=[0m7
[2m2025-10-08T22:12:30.684312Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:12:30.684367Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:12:30.684383Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T22:12:30.685027Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T22:12:30.686059Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:12:30.686131Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T22:12:30.687178Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T22:12:35.532735Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:12:35.532812Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T22:12:35.533845Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T22:13:02.636336Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:13:02.636406Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m960a18ef-e7f1-4562-bcf2-c1a010872aaa [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:13:02.636429Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:13:02.641323Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m960a18ef-e7f1-4562-bcf2-c1a010872aaa [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:13:02.641361Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m457f9802-4238-4b5b-a4d4-1af1707493b5
[2m2025-10-08T22:13:02.641835Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m457f9802-4238-4b5b-a4d4-1af1707493b5 [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:13:02.644989Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:13:02.644969526 UTC
[2m2025-10-08T22:13:02.647018Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m960a18ef-e7f1-4562-bcf2-c1a010872aaa [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:13:02.647126Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m960a18ef-e7f1-4562-bcf2-c1a010872aaa [3mexecution_time_ms[0m[2m=[0m10
[2m2025-10-08T22:13:22.113496Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request cde97cb0-fea9-4f7c-ba6e-067cdb2b5da1: Checking email existence: andrescarriela@gmail.com
[2m2025-10-08T22:13:22.113751Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request cde97cb0-fea9-4f7c-ba6e-067cdb2b5da1: Querying database for email: andrescarriela@gmail.com
[2m2025-10-08T22:13:22.115648Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request cde97cb0-fea9-4f7c-ba6e-067cdb2b5da1: Found existing user with ID: 2
[2m2025-10-08T22:13:22.115674Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request cde97cb0-fea9-4f7c-ba6e-067cdb2b5da1: Email andrescarriela@gmail.com exists with password: true
[2m2025-10-08T22:13:34.921016Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:13:34.921115Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m55aa8042-7e61-4218-948c-bb07a7af3f07 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:13:34.921132Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:13:34.924642Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m55aa8042-7e61-4218-948c-bb07a7af3f07 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:13:35.198355Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:13:35.198314988 UTC
[2m2025-10-08T22:13:35.201746Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m55aa8042-7e61-4218-948c-bb07a7af3f07 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:13:35.201781Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m55aa8042-7e61-4218-948c-bb07a7af3f07 [3mexecution_time_ms[0m[2m=[0m280
[2m2025-10-08T22:13:50.420611Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:13:50.420657Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m9c5bed89-5c1b-4d52-ad36-2049f644a1d3 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:13:50.420669Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:13:50.423187Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m9c5bed89-5c1b-4d52-ad36-2049f644a1d3 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:13:50.698954Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:13:50.698926704 UTC
[2m2025-10-08T22:13:50.702024Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m9c5bed89-5c1b-4d52-ad36-2049f644a1d3 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:13:50.702070Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m9c5bed89-5c1b-4d52-ad36-2049f644a1d3 [3mexecution_time_ms[0m[2m=[0m281
[2m2025-10-08T22:16:46.887748Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:16:46.887811Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0mf3563ba3-0b27-417d-b413-829a8937b212 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:16:46.887829Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:16:46.891650Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mf3563ba3-0b27-417d-b413-829a8937b212 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:16:46.891684Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m822fa20c-d925-423b-8c60-7fd4e7649cb0
[2m2025-10-08T22:16:46.892224Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m822fa20c-d925-423b-8c60-7fd4e7649cb0 [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:16:46.895074Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:16:46.895062706 UTC
[2m2025-10-08T22:16:46.896980Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mf3563ba3-0b27-417d-b413-829a8937b212 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:16:46.897068Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0mf3563ba3-0b27-417d-b413-829a8937b212 [3mexecution_time_ms[0m[2m=[0m9
[2m2025-10-08T22:17:02.167872Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:17:02.167921Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m37e213f7-b66f-45ec-9543-36474b323a36 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:17:02.167933Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:17:02.171130Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m37e213f7-b66f-45ec-9543-36474b323a36 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:17:02.171193Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m64362cae-1373-45de-8269-8a634b68fba9
[2m2025-10-08T22:17:02.171593Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m64362cae-1373-45de-8269-8a634b68fba9 [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:17:02.174177Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:17:02.174162441 UTC
[2m2025-10-08T22:17:02.177360Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m37e213f7-b66f-45ec-9543-36474b323a36 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:17:02.177394Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m37e213f7-b66f-45ec-9543-36474b323a36 [3mexecution_time_ms[0m[2m=[0m9
[2m2025-10-08T22:17:33.252537Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:17:33.252591Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0mdbb455c8-747a-4eb9-83e7-ba29e1dc6062 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:17:33.252614Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:17:33.255035Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mdbb455c8-747a-4eb9-83e7-ba29e1dc6062 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:17:33.255067Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0m621d58cd-f91d-4138-8963-7afe0e610aee
[2m2025-10-08T22:17:33.255586Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0m621d58cd-f91d-4138-8963-7afe0e610aee [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:17:33.258482Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:17:33.258470053 UTC
[2m2025-10-08T22:17:33.262359Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mdbb455c8-747a-4eb9-83e7-ba29e1dc6062 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:17:33.262387Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0mdbb455c8-747a-4eb9-83e7-ba29e1dc6062 [3mexecution_time_ms[0m[2m=[0m9
[2m2025-10-08T22:17:45.469259Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request bb1067c9-573c-462a-b421-633ba6d1d77a: Checking email existence: andrescarriela@gmail.com
[2m2025-10-08T22:17:45.469490Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request bb1067c9-573c-462a-b421-633ba6d1d77a: Querying database for email: andrescarriela@gmail.com
[2m2025-10-08T22:17:45.470237Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request bb1067c9-573c-462a-b421-633ba6d1d77a: Found existing user with ID: 2
[2m2025-10-08T22:17:45.470263Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_registration_v4[0m[2m:[0m Request bb1067c9-573c-462a-b421-633ba6d1d77a: Email andrescarriela@gmail.com exists with password: false
[2m2025-10-08T22:17:45.778543Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_password[0m[2m:[0m üîê Processing password code request [3mrequest_id[0m[2m=[0m9cb3bee6-00ff-4867-a3d9-1247c23e689e [3memail[0m[2m=[0mandrescarriela@gmail.com [3mpurpose[0m[2m=[0memail_verification
[2m2025-10-08T22:17:45.779421Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_password[0m[2m:[0m üìß Email verification code requested [3mrequest_id[0m[2m=[0m9cb3bee6-00ff-4867-a3d9-1247c23e689e [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:17:45.788683Z[0m [32m INFO[0m [2mlum_rust_ws::api::verification_v4[0m[2m:[0m üìß EMAIL CONTENT for andrescarriela@gmail.com (Request: 9cb3bee6-00ff-4867-a3d9-1247c23e689e)
üì¨ To: andrescarriela@gmail.com
üìã Subject: C√≥digo de Verificaci√≥n - L√ºm
üìù Format: HTML + Plain Text
üìù Code: 959335
[2m2025-10-08T22:17:45.788720Z[0m [32m INFO[0m [2mlum_rust_ws::api::verification_v4[0m[2m:[0m üöÄ SENDING HTML EMAIL via SMTP mail.lumapp.org to: andrescarriela@gmail.com
[2m2025-10-08T22:17:47.920391Z[0m [32m INFO[0m [2mlum_rust_ws::api::verification_v4[0m[2m:[0m ‚úÖ HTML Email sent successfully via SMTP to: andrescarriela@gmail.com (Request: 9cb3bee6-00ff-4867-a3d9-1247c23e689e) - Response: Response { code: Code { severity: PositiveCompletion, category: MailSystem, detail: Zero }, message: ["OK id=1v6cTj-00000007Xl5-3c7n"] }
[2m2025-10-08T22:17:47.920444Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_password[0m[2m:[0m ‚úÖ Verification email sent successfully [3mrequest_id[0m[2m=[0m9cb3bee6-00ff-4867-a3d9-1247c23e689e [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:17:47.924678Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_password[0m[2m:[0m ‚úÖ Password code request processed successfully [3mrequest_id[0m[2m=[0m9cb3bee6-00ff-4867-a3d9-1247c23e689e [3mprocessing_time_ms[0m[2m=[0m2146
[2m2025-10-08T22:18:39.566701Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_password[0m[2m:[0m üîê Processing set password with email code request [3mrequest_id[0m[2m=[0m00b477ac-4856-42c8-b0e0-e1b405b941b6 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:18:39.849304Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_password[0m[2m:[0m ‚úÖ Password set successfully with email verification code [3mrequest_id[0m[2m=[0m00b477ac-4856-42c8-b0e0-e1b405b941b6 [3muser_id[0m[2m=[0m2 [3mprocessing_time_ms[0m[2m=[0m282
[2m2025-10-08T22:18:40.342300Z[0m [32m INFO[0m [2mlum_rust_ws::api::auth_v4[0m[2m:[0m üîê Processing user login request [3mrequest_id[0m[2m=[0md19e0624-586e-4298-a1af-17d6e5a1e835 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mremember_me[0m[2m=[0mfalse
[2m2025-10-08T22:18:40.620234Z[0m [32m INFO[0m [2mlum_rust_ws::api::auth_v4[0m[2m:[0m üéâ User login successful - JWT token generated for frontend compatibility [3mrequest_id[0m[2m=[0md19e0624-586e-4298-a1af-17d6e5a1e835 [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexecution_time_ms[0m[2m=[0m277 [3mremember_me[0m[2m=[0mfalse
[2m2025-10-08T22:18:44.262506Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:18:44.262562Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:18:44.262578Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 2
[2m2025-10-08T22:18:44.263266Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 2 - email: Some("andrescarriela@gmail.com")
[2m2025-10-08T22:18:44.307855Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:18:44.308037Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:18:44.308552Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 0ms: 92 L√ºmis
[2m2025-10-08T22:18:54.290944Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:18:54.291003Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:18:54.291021Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 2
[2m2025-10-08T22:18:54.291569Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 2 - email: Some("andrescarriela@gmail.com")
[2m2025-10-08T22:19:48.607771Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:19:48.607864Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:19:48.607891Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 2
[2m2025-10-08T22:19:48.608634Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 2 - email: Some("andrescarriela@gmail.com")
[2m2025-10-08T22:19:54.743556Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:19:54.743608Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:19:54.743633Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 2
[2m2025-10-08T22:19:54.744576Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 2 - email: Some("andrescarriela@gmail.com")
[2m2025-10-08T22:20:07.896077Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:07.896143Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:07.896200Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üìã Fetching user issuers for user_id: 2 [16ea14e8-8e02-4bd0-ab08-a3cd92935fad]
[2m2025-10-08T22:20:07.896210Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üîç Cache key: user_issuers_list_2_100_0_no_date_filter [16ea14e8-8e02-4bd0-ab08-a3cd92935fad]
[2m2025-10-08T22:20:07.896091Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:07.896383Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:07.896402Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üìã Fetching user issuers for user_id: 2 [5b51e1bc-c62e-43e0-a0d0-ec2174adf2f3]
[2m2025-10-08T22:20:07.896415Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m üîç Cache key: user_issuers_list_2_100_0_no_date_filter [5b51e1bc-c62e-43e0-a0d0-ec2174adf2f3]
[2m2025-10-08T22:20:07.899697Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ‚úÖ Successfully fetched 70 issuers for user 2 (total: 62, date_filter: none) in 3ms [16ea14e8-8e02-4bd0-ab08-a3cd92935fad]
[2m2025-10-08T22:20:07.899718Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_issuers_v4[0m[2m:[0m ‚úÖ Successfully fetched 70 issuers for user 2 (total: 62, date_filter: none) in 3ms [5b51e1bc-c62e-43e0-a0d0-ec2174adf2f3]
[2m2025-10-08T22:20:08.176271Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:08.176322Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:08.176341Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üõí Fetching user products for user_id: 2 [bb7e8334-0f1c-43ca-87bd-7d6e7f2e1841]
[2m2025-10-08T22:20:08.176349Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üîç Cache key: user_products_list_2_20_0_no_date_filter [bb7e8334-0f1c-43ca-87bd-7d6e7f2e1841]
[2m2025-10-08T22:20:08.186998Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ‚úÖ Successfully fetched 20 products for user 2 (total: 797, date_filter: none) in 10ms [bb7e8334-0f1c-43ca-87bd-7d6e7f2e1841]
[2m2025-10-08T22:20:08.327415Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:08.327467Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:08.327487Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üõí Fetching user products for user_id: 2 [089ab95c-3bcc-47d0-8e94-2e534aa8ab46]
[2m2025-10-08T22:20:08.327494Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m üîç Cache key: user_products_list_2_20_0_no_date_filter [089ab95c-3bcc-47d0-8e94-2e534aa8ab46]
[2m2025-10-08T22:20:08.335754Z[0m [32m INFO[0m [2mlum_rust_ws::api::user_products_v4[0m[2m:[0m ‚úÖ Successfully fetched 20 products for user 2 (total: 797, date_filter: none) in 8ms [089ab95c-3bcc-47d0-8e94-2e534aa8ab46]
[2m2025-10-08T22:20:08.414116Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:08.414232Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mef317732-08d2-4b99-b91d-f025f6076363
[2m2025-10-08T22:20:08.414247Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ef317732-08d2-4b99-b91d-f025f6076363: Processing headers for user 2 with limit 50 offset 0
[2m2025-10-08T22:20:08.414258Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ef317732-08d2-4b99-b91d-f025f6076363: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:08.426708Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request ef317732-08d2-4b99-b91d-f025f6076363: Retrieved 50 invoice headers (total: 157) in 12ms with enhanced filtering
[2m2025-10-08T22:20:08.706688Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:08.706757Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mfc13ae34-0598-4c8b-8a99-76ff974824a2
[2m2025-10-08T22:20:08.706764Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fc13ae34-0598-4c8b-8a99-76ff974824a2: Processing headers for user 2 with limit 50 offset 50
[2m2025-10-08T22:20:08.706774Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fc13ae34-0598-4c8b-8a99-76ff974824a2: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:08.711239Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:08.711714Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mbd94f4ff-f022-404b-9f9a-3872f9bd2df0
[2m2025-10-08T22:20:08.711803Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd94f4ff-f022-404b-9f9a-3872f9bd2df0: Processing headers for user 2 with limit 50 offset 100
[2m2025-10-08T22:20:08.711869Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd94f4ff-f022-404b-9f9a-3872f9bd2df0: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:08.712363Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fc13ae34-0598-4c8b-8a99-76ff974824a2: Retrieved 50 invoice headers (total: 157) in 5ms with enhanced filtering
[2m2025-10-08T22:20:08.717961Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd94f4ff-f022-404b-9f9a-3872f9bd2df0: Retrieved 50 invoice headers (total: 157) in 6ms with enhanced filtering
[2m2025-10-08T22:20:13.996466Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:13.996546Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m599d128c-656b-472d-bc71-e0f8b47751c5
[2m2025-10-08T22:20:13.996556Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 599d128c-656b-472d-bc71-e0f8b47751c5: Processing headers for user 2 with limit 50 offset 150
[2m2025-10-08T22:20:13.996567Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 599d128c-656b-472d-bc71-e0f8b47751c5: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.000597Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 599d128c-656b-472d-bc71-e0f8b47751c5: Retrieved 7 invoice headers (total: 157) in 4ms with enhanced filtering
[2m2025-10-08T22:20:14.279567Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.279644Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m419427eb-551c-4a9a-a705-4660440c39cb
[2m2025-10-08T22:20:14.279652Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 419427eb-551c-4a9a-a705-4660440c39cb: Processing headers for user 2 with limit 50 offset 200
[2m2025-10-08T22:20:14.279662Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 419427eb-551c-4a9a-a705-4660440c39cb: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.283495Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 419427eb-551c-4a9a-a705-4660440c39cb: Retrieved 0 invoice headers (total: 157) in 3ms with enhanced filtering
[2m2025-10-08T22:20:14.418407Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.418476Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mcd2ad617-3f85-4be0-bce8-41bb40925438
[2m2025-10-08T22:20:14.418485Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd2ad617-3f85-4be0-bce8-41bb40925438: Processing headers for user 2 with limit 50 offset 250
[2m2025-10-08T22:20:14.418494Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd2ad617-3f85-4be0-bce8-41bb40925438: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.422640Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request cd2ad617-3f85-4be0-bce8-41bb40925438: Retrieved 0 invoice headers (total: 157) in 4ms with enhanced filtering
[2m2025-10-08T22:20:14.686140Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.686233Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m82c75a6a-ae60-4cc4-9aca-e9e0fad61207
[2m2025-10-08T22:20:14.686244Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82c75a6a-ae60-4cc4-9aca-e9e0fad61207: Processing headers for user 2 with limit 50 offset 400
[2m2025-10-08T22:20:14.686255Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82c75a6a-ae60-4cc4-9aca-e9e0fad61207: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.690295Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.690356Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m09f0fe9d-0d0e-4f49-9a48-b2931a87384b
[2m2025-10-08T22:20:14.690363Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 09f0fe9d-0d0e-4f49-9a48-b2931a87384b: Processing headers for user 2 with limit 50 offset 350
[2m2025-10-08T22:20:14.690372Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 09f0fe9d-0d0e-4f49-9a48-b2931a87384b: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.690303Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 82c75a6a-ae60-4cc4-9aca-e9e0fad61207: Retrieved 0 invoice headers (total: 157) in 4ms with enhanced filtering
[2m2025-10-08T22:20:14.692010Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.692084Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m257e66a1-7e15-4843-98ed-21583b1aa50d
[2m2025-10-08T22:20:14.692094Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 257e66a1-7e15-4843-98ed-21583b1aa50d: Processing headers for user 2 with limit 50 offset 300
[2m2025-10-08T22:20:14.692110Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 257e66a1-7e15-4843-98ed-21583b1aa50d: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.695585Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 257e66a1-7e15-4843-98ed-21583b1aa50d: Retrieved 0 invoice headers (total: 157) in 3ms with enhanced filtering
[2m2025-10-08T22:20:14.696319Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 09f0fe9d-0d0e-4f49-9a48-b2931a87384b: Retrieved 0 invoice headers (total: 157) in 5ms with enhanced filtering
[2m2025-10-08T22:20:14.897362Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.897440Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mf96b5b32-e2d5-4bef-a09c-57292be072e1
[2m2025-10-08T22:20:14.897450Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f96b5b32-e2d5-4bef-a09c-57292be072e1: Processing for user 2 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:20:14.897460Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f96b5b32-e2d5-4bef-a09c-57292be072e1: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:14.897475Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f96b5b32-e2d5-4bef-a09c-57292be072e1: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.900656Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.900704Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0e6b7652-334c-4e79-92b2-60b4b9666bc4
[2m2025-10-08T22:20:14.900711Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0e6b7652-334c-4e79-92b2-60b4b9666bc4: Processing for user 2 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:20:14.900717Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0e6b7652-334c-4e79-92b2-60b4b9666bc4: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:14.900734Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0e6b7652-334c-4e79-92b2-60b4b9666bc4: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.901286Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request f96b5b32-e2d5-4bef-a09c-57292be072e1: Retrieved 100 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:14.904805Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:14.904888Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m571a4b77-b300-4362-bbcf-c83bed5ba3e9
[2m2025-10-08T22:20:14.904900Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 571a4b77-b300-4362-bbcf-c83bed5ba3e9: Processing for user 2 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:20:14.904909Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 571a4b77-b300-4362-bbcf-c83bed5ba3e9: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:14.904919Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 571a4b77-b300-4362-bbcf-c83bed5ba3e9: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:14.908446Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0e6b7652-334c-4e79-92b2-60b4b9666bc4: Retrieved 100 invoice details (total: 1292) in 7ms with enhanced pagination
[2m2025-10-08T22:20:14.914358Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 571a4b77-b300-4362-bbcf-c83bed5ba3e9: Retrieved 100 invoice details (total: 1292) in 9ms with enhanced pagination
[2m2025-10-08T22:20:15.450716Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:15.450792Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m91775c21-46c9-46bb-828b-52ca2b3436c9
[2m2025-10-08T22:20:15.450800Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91775c21-46c9-46bb-828b-52ca2b3436c9: Processing for user 2 with limit 100 offset 500 order_by date direction DESC
[2m2025-10-08T22:20:15.450808Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91775c21-46c9-46bb-828b-52ca2b3436c9: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:15.450815Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91775c21-46c9-46bb-828b-52ca2b3436c9: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:15.453946Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 91775c21-46c9-46bb-828b-52ca2b3436c9: Retrieved 100 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:15.457189Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:15.457231Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me344262e-445c-4166-81c0-2d7a277b7af3
[2m2025-10-08T22:20:15.457239Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e344262e-445c-4166-81c0-2d7a277b7af3: Processing for user 2 with limit 100 offset 300 order_by date direction DESC
[2m2025-10-08T22:20:15.457245Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e344262e-445c-4166-81c0-2d7a277b7af3: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:15.457252Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e344262e-445c-4166-81c0-2d7a277b7af3: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:15.459860Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e344262e-445c-4166-81c0-2d7a277b7af3: Retrieved 100 invoice details (total: 1292) in 2ms with enhanced pagination
[2m2025-10-08T22:20:15.461802Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:15.461844Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mfd71c875-dad1-41ba-b878-6039cd1894fe
[2m2025-10-08T22:20:15.461852Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd71c875-dad1-41ba-b878-6039cd1894fe: Processing for user 2 with limit 100 offset 400 order_by date direction DESC
[2m2025-10-08T22:20:15.461857Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd71c875-dad1-41ba-b878-6039cd1894fe: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:15.461863Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd71c875-dad1-41ba-b878-6039cd1894fe: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:15.464669Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fd71c875-dad1-41ba-b878-6039cd1894fe: Retrieved 100 invoice details (total: 1292) in 2ms with enhanced pagination
[2m2025-10-08T22:20:16.001304Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:16.001379Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0ma94e19a7-1d28-4bd5-a8e4-99ffe2ca1031
[2m2025-10-08T22:20:16.001387Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a94e19a7-1d28-4bd5-a8e4-99ffe2ca1031: Processing for user 2 with limit 100 offset 800 order_by date direction DESC
[2m2025-10-08T22:20:16.001407Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a94e19a7-1d28-4bd5-a8e4-99ffe2ca1031: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:16.001415Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a94e19a7-1d28-4bd5-a8e4-99ffe2ca1031: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:16.005188Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a94e19a7-1d28-4bd5-a8e4-99ffe2ca1031: Retrieved 100 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:16.007726Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:16.007767Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m06dd327f-e333-41bd-8335-a3630ad0da2a
[2m2025-10-08T22:20:16.007774Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 06dd327f-e333-41bd-8335-a3630ad0da2a: Processing for user 2 with limit 100 offset 600 order_by date direction DESC
[2m2025-10-08T22:20:16.007780Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 06dd327f-e333-41bd-8335-a3630ad0da2a: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:16.007787Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 06dd327f-e333-41bd-8335-a3630ad0da2a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:16.011586Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 06dd327f-e333-41bd-8335-a3630ad0da2a: Retrieved 100 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:16.012821Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:16.012874Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m69f8dddb-662a-40c7-97a4-33a87095267f
[2m2025-10-08T22:20:16.012882Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69f8dddb-662a-40c7-97a4-33a87095267f: Processing for user 2 with limit 100 offset 700 order_by date direction DESC
[2m2025-10-08T22:20:16.012888Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69f8dddb-662a-40c7-97a4-33a87095267f: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:16.012896Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69f8dddb-662a-40c7-97a4-33a87095267f: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:16.015915Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 69f8dddb-662a-40c7-97a4-33a87095267f: Retrieved 100 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:16.527742Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:16.527805Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me1be8420-b1ff-45c8-b8da-0ca93e36d1df
[2m2025-10-08T22:20:16.527813Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1be8420-b1ff-45c8-b8da-0ca93e36d1df: Processing for user 2 with limit 100 offset 1100 order_by date direction DESC
[2m2025-10-08T22:20:16.527821Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1be8420-b1ff-45c8-b8da-0ca93e36d1df: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:16.527832Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1be8420-b1ff-45c8-b8da-0ca93e36d1df: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:16.533277Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e1be8420-b1ff-45c8-b8da-0ca93e36d1df: Retrieved 100 invoice details (total: 1292) in 5ms with enhanced pagination
[2m2025-10-08T22:20:16.534799Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:16.534848Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m0cc8df52-b8ef-4188-adc9-1457f8368701
[2m2025-10-08T22:20:16.534855Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0cc8df52-b8ef-4188-adc9-1457f8368701: Processing for user 2 with limit 100 offset 900 order_by date direction DESC
[2m2025-10-08T22:20:16.534861Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0cc8df52-b8ef-4188-adc9-1457f8368701: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:16.534867Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0cc8df52-b8ef-4188-adc9-1457f8368701: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:16.538180Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 0cc8df52-b8ef-4188-adc9-1457f8368701: Retrieved 100 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:16.538255Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:16.538283Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb867ebdc-338f-4da8-bae8-1577977c5738
[2m2025-10-08T22:20:16.538290Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b867ebdc-338f-4da8-bae8-1577977c5738: Processing for user 2 with limit 100 offset 1000 order_by date direction DESC
[2m2025-10-08T22:20:16.538308Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b867ebdc-338f-4da8-bae8-1577977c5738: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:16.538314Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b867ebdc-338f-4da8-bae8-1577977c5738: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:16.543033Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b867ebdc-338f-4da8-bae8-1577977c5738: Retrieved 100 invoice details (total: 1292) in 4ms with enhanced pagination
[2m2025-10-08T22:20:17.091393Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:17.091480Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m632eae3e-e282-4ef3-a7ac-86548fbd3895
[2m2025-10-08T22:20:17.091489Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 632eae3e-e282-4ef3-a7ac-86548fbd3895: Processing for user 2 with limit 100 offset 1400 order_by date direction DESC
[2m2025-10-08T22:20:17.091496Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 632eae3e-e282-4ef3-a7ac-86548fbd3895: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:17.091504Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 632eae3e-e282-4ef3-a7ac-86548fbd3895: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:17.095551Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 632eae3e-e282-4ef3-a7ac-86548fbd3895: Retrieved 0 invoice details (total: 1292) in 4ms with enhanced pagination
[2m2025-10-08T22:20:17.096730Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:17.096789Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m45d68575-0de0-4404-8773-7862df8989b3
[2m2025-10-08T22:20:17.096797Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 45d68575-0de0-4404-8773-7862df8989b3: Processing for user 2 with limit 100 offset 1300 order_by date direction DESC
[2m2025-10-08T22:20:17.096804Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 45d68575-0de0-4404-8773-7862df8989b3: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:17.096811Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 45d68575-0de0-4404-8773-7862df8989b3: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:17.097645Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:17.097707Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m772bcea1-3c84-491d-94b7-7a0dd8dcb06c
[2m2025-10-08T22:20:17.097715Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 772bcea1-3c84-491d-94b7-7a0dd8dcb06c: Processing for user 2 with limit 100 offset 1200 order_by date direction DESC
[2m2025-10-08T22:20:17.097721Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 772bcea1-3c84-491d-94b7-7a0dd8dcb06c: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:17.097728Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 772bcea1-3c84-491d-94b7-7a0dd8dcb06c: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:17.100474Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 45d68575-0de0-4404-8773-7862df8989b3: Retrieved 0 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:17.102425Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 772bcea1-3c84-491d-94b7-7a0dd8dcb06c: Retrieved 92 invoice details (total: 1292) in 4ms with enhanced pagination
[2m2025-10-08T22:20:17.507327Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:17.507405Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m4cd6757b-c3ee-46ad-9da8-d52bb9722eaa
[2m2025-10-08T22:20:17.507415Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4cd6757b-c3ee-46ad-9da8-d52bb9722eaa: Processing for user 2 with limit 100 offset 1700 order_by date direction DESC
[2m2025-10-08T22:20:17.507422Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4cd6757b-c3ee-46ad-9da8-d52bb9722eaa: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:17.507430Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4cd6757b-c3ee-46ad-9da8-d52bb9722eaa: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:17.510951Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4cd6757b-c3ee-46ad-9da8-d52bb9722eaa: Retrieved 0 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:17.512129Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:17.512187Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m6a4894a0-aacd-4b5c-bfd4-8a7576ac1b63
[2m2025-10-08T22:20:17.512198Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a4894a0-aacd-4b5c-bfd4-8a7576ac1b63: Processing for user 2 with limit 100 offset 1600 order_by date direction DESC
[2m2025-10-08T22:20:17.512214Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a4894a0-aacd-4b5c-bfd4-8a7576ac1b63: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:17.512221Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a4894a0-aacd-4b5c-bfd4-8a7576ac1b63: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:17.513588Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:20:17.513628Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m6993f52a-812d-40fe-ac15-31b39b0f5448
[2m2025-10-08T22:20:17.513635Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6993f52a-812d-40fe-ac15-31b39b0f5448: Processing for user 2 with limit 100 offset 1500 order_by date direction DESC
[2m2025-10-08T22:20:17.513640Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6993f52a-812d-40fe-ac15-31b39b0f5448: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:20:17.513646Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6993f52a-812d-40fe-ac15-31b39b0f5448: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:20:17.515282Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6a4894a0-aacd-4b5c-bfd4-8a7576ac1b63: Retrieved 0 invoice details (total: 1292) in 3ms with enhanced pagination
[2m2025-10-08T22:20:17.516455Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 6993f52a-812d-40fe-ac15-31b39b0f5448: Retrieved 0 invoice details (total: 1292) in 2ms with enhanced pagination
[2m2025-10-08T22:31:22.695014Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:31:22.695087Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:31:22.696777Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 1ms: 92 L√ºmis
[2m2025-10-08T22:32:30.907763Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:32:30.917611Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:32:31.057094Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:32:31.060646Z[0m [31mERROR[0m [2mlum_rust_ws::api::gamification_v4[0m[2m:[0m Failed to track action: Database(PgDatabaseError { severity: Error, code: "23514", message: "no partition of relation \"fact_user_activity_log\" found for row", detail: Some("Partition key of the failing row contains (created_at) = (2025-10-08 22:32:31.058573+00)."), hint: None, position: None, where: Some("SQL statement \"INSERT INTO gamification.fact_user_activity_log (\n        user_id, activity_type, activity_data, created_at\n    ) VALUES (\n        p_user_id, p_action_type, \n        jsonb_build_object(\n            'channel', p_channel,\n            'metadata', p_metadata,\n            'timestamp', NOW()\n        ),\n        NOW()\n    )\"\nPL/pgSQL function gamification.track_user_action(integer,character varying,character varying,jsonb) line 13 at SQL statement"), schema: Some("gamification"), table: Some("fact_user_activity_log"), column: None, data_type: None, constraint: None, file: Some("execPartition.c"), line: Some(328), routine: Some("ExecFindPartition") })
[2m2025-10-08T22:32:31.060735Z[0m [31mERROR[0m [2mtower_http::trace::on_failure[0m[2m:[0m response failed [3mclassification[0m[2m=[0mStatus code: 500 Internal Server Error [3mlatency[0m[2m=[0m3 ms
[2m2025-10-08T22:33:45.161559Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mtrue [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:33:45.161629Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0mcc9d00ad-5b0d-41f0-ba4a-11ba2d94b430 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA2MDYzOTM2NDI0NDM3NjIxMDgwIiwiZW1haWwiOiJhbmRyZXNmZWxpcGV2YWxlbmNpYWdAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJBbmRyZXMgVmFsZW5jaWEiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EvQUNnOG9jSk9Xd083eUdDWVA1OHB4ZFZCd2R6MGJudWtITHdwcjk0RklVbGNEckxHYnVrYUFBPXM5Ni1jIiwiZ2l2ZW5fbmFtZSI6IkFuZHJlcyIsImZhbWlseV9uYW1lIjoiVmFsZW5jaWEiLCJpYXQiOjE3NTk5NjExMTMsImV4cCI6MTc1OTk2NDcxM30.D-KEeH66kQi977BmY2g5Q7ndWNNAOu3MogcNXvn9iTMhu1F6llpilj98ipMoRKL31C4B2Fvruc7iXPUcosc91kFT9rgjnzhHCjQcXvj-S4P8fug-gjMQy1GA5Ykg6Y0KE3i5z6SqlgTHHXIsiZR2syTjyZkg9RymqSqWEGXSULgPMUkqEhoGgIWkAv3Wi-FH8AzPz9QXMNfBXs81_Jd1c2MuiF8ppXmkdEB0hSzM2iCiko8TkBao1wW3gsb_JMmtJf4rD-4GHcXNiCd9PY456D0O3Z1ZTgbdraPXxQBXKpr9RCeIwaN_8tNIIuH-1Rs-q2Lbzc2SpwiV0dCrwk7j6Q", access_token: None }
[2m2025-10-08T22:33:45.161642Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:33:45.167308Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mcc9d00ad-5b0d-41f0-ba4a-11ba2d94b430 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:33:45.167380Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0mc733c5f3-53d8-469c-865d-0601fe431100
[2m2025-10-08T22:33:45.167836Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0mc733c5f3-53d8-469c-865d-0601fe431100 [3muser_id[0m[2m=[0m106063936424437621080 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mname[0m[2m=[0mSome("Andres Valencia") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:33:45.173999Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:33:45.173981089 UTC
[2m2025-10-08T22:33:45.178973Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mcc9d00ad-5b0d-41f0-ba4a-11ba2d94b430 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:33:45.179018Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0mcc9d00ad-5b0d-41f0-ba4a-11ba2d94b430 [3mexecution_time_ms[0m[2m=[0m17
[2m2025-10-08T22:33:45.670921Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:33:45.670984Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:33:45.671004Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T22:33:45.672384Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:33:45.672433Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T22:33:45.673443Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 2ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T22:33:45.674098Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 1ms: 296 L√ºmis
[2m2025-10-08T22:33:57.146778Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:33:57.146849Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 1: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:33:57.146858Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:33:57.146865Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:33:58.505034Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (36217 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:33:58.506759Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:33:58.509634Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:33:58.509684Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 15 potential detail rows
[2m2025-10-08T22:33:58.509748Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("37.45")
[2m2025-10-08T22:34:48.952743Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:34:48.952817Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 2: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200001025497-1-541493-3800052025100601000093770050119856583420&iAmb=1&digestValue=1r8qjxFsGYGi834MQr2h6G9ipTMpwCl93iwmfCKj2yc=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTAyNTQ5Ny0xLTU0MTQ5My0zODAwMDUyMDI1MTAwNjAxMDAwMDkzNzcwMDUwMTE5ODU2NTgzNDIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjFyOHFqeEZzR1lHaTgzNE1RcjJoNkc5aXBUTXB3Q2w5M2l3bWZDS2oyeWM9In0._lpuEdvjx8rxSq3r2OsS5iD81Fm9CEiA5pTlVDXzvEg
[2m2025-10-08T22:34:48.952845Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200001025497-1-541493-3800052025100601000093770050119856583420&iAmb=1&digestValue=1r8qjxFsGYGi834MQr2h6G9ipTMpwCl93iwmfCKj2yc=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTAyNTQ5Ny0xLTU0MTQ5My0zODAwMDUyMDI1MTAwNjAxMDAwMDkzNzcwMDUwMTE5ODU2NTgzNDIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjFyOHFqeEZzR1lHaTgzNE1RcjJoNkc5aXBUTXB3Q2w5M2l3bWZDS2oyeWM9In0._lpuEdvjx8rxSq3r2OsS5iD81Fm9CEiA5pTlVDXzvEg
[2m2025-10-08T22:34:48.952854Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200001025497-1-541493-3800052025100601000093770050119856583420&iAmb=1&digestValue=1r8qjxFsGYGi834MQr2h6G9ipTMpwCl93iwmfCKj2yc=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTAyNTQ5Ny0xLTU0MTQ5My0zODAwMDUyMDI1MTAwNjAxMDAwMDkzNzcwMDUwMTE5ODU2NTgzNDIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjFyOHFqeEZzR1lHaTgzNE1RcjJoNkc5aXBUTXB3Q2w5M2l3bWZDS2oyeWM9In0._lpuEdvjx8rxSq3r2OsS5iD81Fm9CEiA5pTlVDXzvEg
[2m2025-10-08T22:34:49.753614Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (26941 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200001025497-1-541493-3800052025100601000093770050119856583420&iAmb=1&digestValue=1r8qjxFsGYGi834MQr2h6G9ipTMpwCl93iwmfCKj2yc=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMTAyNTQ5Ny0xLTU0MTQ5My0zODAwMDUyMDI1MTAwNjAxMDAwMDkzNzcwMDUwMTE5ODU2NTgzNDIwIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjFyOHFqeEZzR1lHaTgzNE1RcjJoNkc5aXBUTXB3Q2w5M2l3bWZDS2oyeWM9In0._lpuEdvjx8rxSq3r2OsS5iD81Fm9CEiA5pTlVDXzvEg
[2m2025-10-08T22:34:49.754398Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:34:49.755672Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:34:49.755704Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 10 potential detail rows
[2m2025-10-08T22:34:49.755732Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("9.95")
[2m2025-10-08T22:34:49.757035Z[0m [32m INFO[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Saving invoice header with CUFE: FE01200001025497-1-541493-3800052025100601000093770050119856583420
[2m2025-10-08T22:34:49.761537Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Usuario 2, sin redenci√≥n previa, buscando desde: 2025-09-15
[2m2025-10-08T22:34:49.762199Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Usuario 2, contando desde semana m√°s reciente con facturas: 2025-10-06
[2m2025-10-08T22:34:49.762883Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 0 (desde 2025-10-06 hasta 2025-10-12 00:00:00): facturas = t
[2m2025-10-08T22:34:49.763273Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 1 (desde 2025-09-29 hasta 2025-10-05 00:00:00): facturas = t
[2m2025-10-08T22:34:49.763370Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 2 (desde 2025-09-22 hasta 2025-09-28 00:00:00): facturas = t
[2m2025-10-08T22:34:49.763450Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 3 (desde 2025-09-15 hasta 2025-09-21 00:00:00): facturas = t
[2m2025-10-08T22:34:49.763516Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Resultado final para usuario 2: 4 semanas consecutivas (despu√©s de redenci√≥n: <NULL>)
[2m2025-10-08T22:34:49.813141Z[0m [32m INFO[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Saving 1 invoice details
[2m2025-10-08T22:34:49.813590Z[0m [32m INFO[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Saving 1 invoice payments
[2m2025-10-08T22:35:15.395072Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.395685Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m235a5bf2-222f-4c5d-9277-948be416f3fe
[2m2025-10-08T22:35:15.395734Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 235a5bf2-222f-4c5d-9277-948be416f3fe: Processing headers for user 2 with limit 50 offset 50
[2m2025-10-08T22:35:15.395751Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 235a5bf2-222f-4c5d-9277-948be416f3fe: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.400550Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 235a5bf2-222f-4c5d-9277-948be416f3fe: Retrieved 0 invoice headers (total: 1) in 5ms with enhanced filtering
[2m2025-10-08T22:35:15.440698Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.440773Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m651912f2-aca1-4fbe-a80c-e8592329c05c
[2m2025-10-08T22:35:15.440782Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 651912f2-aca1-4fbe-a80c-e8592329c05c: Processing headers for user 2 with limit 50 offset 0
[2m2025-10-08T22:35:15.440803Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 651912f2-aca1-4fbe-a80c-e8592329c05c: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.446542Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 651912f2-aca1-4fbe-a80c-e8592329c05c: Retrieved 1 invoice headers (total: 1) in 5ms with enhanced filtering
[2m2025-10-08T22:35:15.446976Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.447019Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m7a2563aa-d09b-4310-b349-0f30197042ed
[2m2025-10-08T22:35:15.447027Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7a2563aa-d09b-4310-b349-0f30197042ed: Processing headers for user 2 with limit 50 offset 100
[2m2025-10-08T22:35:15.447036Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7a2563aa-d09b-4310-b349-0f30197042ed: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.451754Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 7a2563aa-d09b-4310-b349-0f30197042ed: Retrieved 0 invoice headers (total: 1) in 4ms with enhanced filtering
[2m2025-10-08T22:35:15.700869Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.700964Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m05b74d09-dc60-4189-83f0-b20d1d16ebb1
[2m2025-10-08T22:35:15.700972Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 05b74d09-dc60-4189-83f0-b20d1d16ebb1: Processing headers for user 2 with limit 50 offset 250
[2m2025-10-08T22:35:15.700982Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 05b74d09-dc60-4189-83f0-b20d1d16ebb1: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.706042Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 05b74d09-dc60-4189-83f0-b20d1d16ebb1: Retrieved 0 invoice headers (total: 1) in 5ms with enhanced filtering
[2m2025-10-08T22:35:15.707189Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.707269Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mbf2d04d5-90dd-4617-839f-4592b094a9cf
[2m2025-10-08T22:35:15.707278Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bf2d04d5-90dd-4617-839f-4592b094a9cf: Processing headers for user 2 with limit 50 offset 150
[2m2025-10-08T22:35:15.707289Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bf2d04d5-90dd-4617-839f-4592b094a9cf: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.707313Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.707343Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3715d334-7205-42ed-9e5c-07b57858f43f
[2m2025-10-08T22:35:15.707349Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3715d334-7205-42ed-9e5c-07b57858f43f: Processing headers for user 2 with limit 50 offset 200
[2m2025-10-08T22:35:15.707356Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3715d334-7205-42ed-9e5c-07b57858f43f: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.711908Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bf2d04d5-90dd-4617-839f-4592b094a9cf: Retrieved 0 invoice headers (total: 1) in 4ms with enhanced filtering
[2m2025-10-08T22:35:15.712704Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3715d334-7205-42ed-9e5c-07b57858f43f: Retrieved 0 invoice headers (total: 1) in 5ms with enhanced filtering
[2m2025-10-08T22:35:15.848065Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.848136Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m555f07e9-909a-4a27-8c8b-ac44d06c180e
[2m2025-10-08T22:35:15.848167Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 555f07e9-909a-4a27-8c8b-ac44d06c180e: Processing for user 2 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:35:15.848177Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 555f07e9-909a-4a27-8c8b-ac44d06c180e: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:15.848186Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 555f07e9-909a-4a27-8c8b-ac44d06c180e: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.850804Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 555f07e9-909a-4a27-8c8b-ac44d06c180e: Retrieved 0 invoice details (total: 1) in 2ms with enhanced pagination
[2m2025-10-08T22:35:15.854449Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.854493Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0maa499d51-98c8-4ec2-95b0-8debdc2f6b56
[2m2025-10-08T22:35:15.854499Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aa499d51-98c8-4ec2-95b0-8debdc2f6b56: Processing for user 2 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:35:15.854505Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aa499d51-98c8-4ec2-95b0-8debdc2f6b56: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:15.854511Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aa499d51-98c8-4ec2-95b0-8debdc2f6b56: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.854638Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:15.854664Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m1b3d58a7-e6db-4e2c-9b2f-567a4d0841a5
[2m2025-10-08T22:35:15.854669Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1b3d58a7-e6db-4e2c-9b2f-567a4d0841a5: Processing for user 2 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:35:15.854674Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1b3d58a7-e6db-4e2c-9b2f-567a4d0841a5: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:15.854679Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1b3d58a7-e6db-4e2c-9b2f-567a4d0841a5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:15.858177Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aa499d51-98c8-4ec2-95b0-8debdc2f6b56: Retrieved 1 invoice details (total: 1) in 3ms with enhanced pagination
[2m2025-10-08T22:35:15.859080Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1b3d58a7-e6db-4e2c-9b2f-567a4d0841a5: Retrieved 0 invoice details (total: 1) in 4ms with enhanced pagination
[2m2025-10-08T22:35:16.159039Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:16.159124Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb154036d-ed05-4c53-81cc-632c0ed1d596
[2m2025-10-08T22:35:16.159135Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b154036d-ed05-4c53-81cc-632c0ed1d596: Processing for user 2 with limit 100 offset 300 order_by date direction DESC
[2m2025-10-08T22:35:16.159186Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b154036d-ed05-4c53-81cc-632c0ed1d596: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:16.159212Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b154036d-ed05-4c53-81cc-632c0ed1d596: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:16.161181Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b154036d-ed05-4c53-81cc-632c0ed1d596: Retrieved 0 invoice details (total: 1) in 2ms with enhanced pagination
[2m2025-10-08T22:35:16.165002Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:16.165063Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0maac93981-5f16-4b62-bf0a-f7b51c70cae6
[2m2025-10-08T22:35:16.165100Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aac93981-5f16-4b62-bf0a-f7b51c70cae6: Processing for user 2 with limit 100 offset 400 order_by date direction DESC
[2m2025-10-08T22:35:16.165107Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aac93981-5f16-4b62-bf0a-f7b51c70cae6: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:16.165115Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aac93981-5f16-4b62-bf0a-f7b51c70cae6: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:16.167029Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request aac93981-5f16-4b62-bf0a-f7b51c70cae6: Retrieved 0 invoice details (total: 1) in 1ms with enhanced pagination
[2m2025-10-08T22:35:16.194145Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:16.194243Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m4daae835-a7a0-46a4-8908-4f713eb29068
[2m2025-10-08T22:35:16.194251Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4daae835-a7a0-46a4-8908-4f713eb29068: Processing for user 2 with limit 100 offset 500 order_by date direction DESC
[2m2025-10-08T22:35:16.194258Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4daae835-a7a0-46a4-8908-4f713eb29068: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:16.194266Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4daae835-a7a0-46a4-8908-4f713eb29068: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:16.195613Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4daae835-a7a0-46a4-8908-4f713eb29068: Retrieved 0 invoice details (total: 1) in 1ms with enhanced pagination
[2m2025-10-08T22:35:32.264178Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:32.264259Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 2: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:32.264269Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:32.264277Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:32.974926Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (29229 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:32.976216Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:35:32.978357Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:35:32.978447Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 10 potential detail rows
[2m2025-10-08T22:35:32.978524Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("21.13")
[2m2025-10-08T22:35:34.509819Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:34.509888Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 2: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:34.509899Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:34.509904Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:36.143321Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (29230 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:36.144230Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:35:36.145637Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:35:36.145680Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 10 potential detail rows
[2m2025-10-08T22:35:36.145720Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("21.13")
[2m2025-10-08T22:35:36.303505Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:36.303575Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 2: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:36.303583Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:36.303589Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:36.999242Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (29231 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000048497-27-311000-2200002025100500000031950010315223992944
[2m2025-10-08T22:35:37.000083Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:35:37.001475Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:35:37.001524Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 10 potential detail rows
[2m2025-10-08T22:35:37.001552Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("21.13")
[2m2025-10-08T22:35:54.573855Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:54.573943Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m4e54d4b7-3cba-4208-85fe-0d74da91fff6
[2m2025-10-08T22:35:54.573951Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4e54d4b7-3cba-4208-85fe-0d74da91fff6: Processing headers for user 2 with limit 50 offset 50
[2m2025-10-08T22:35:54.573961Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4e54d4b7-3cba-4208-85fe-0d74da91fff6: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:54.574007Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:54.574067Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m3c628da6-1c5b-4186-aa1e-84f71379ed16
[2m2025-10-08T22:35:54.574084Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3c628da6-1c5b-4186-aa1e-84f71379ed16: Processing headers for user 2 with limit 50 offset 100
[2m2025-10-08T22:35:54.574094Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3c628da6-1c5b-4186-aa1e-84f71379ed16: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:54.575410Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 4e54d4b7-3cba-4208-85fe-0d74da91fff6: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T22:35:54.575745Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 3c628da6-1c5b-4186-aa1e-84f71379ed16: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T22:35:54.581762Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:54.581814Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m786cdb0f-38c7-471d-88bf-f8e3049ce0b2
[2m2025-10-08T22:35:54.581822Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 786cdb0f-38c7-471d-88bf-f8e3049ce0b2: Processing headers for user 2 with limit 50 offset 0
[2m2025-10-08T22:35:54.581830Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 786cdb0f-38c7-471d-88bf-f8e3049ce0b2: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:54.582885Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 786cdb0f-38c7-471d-88bf-f8e3049ce0b2: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T22:35:54.709400Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:54.709489Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mdcb94662-1814-4127-8d7a-854b85f18dfb
[2m2025-10-08T22:35:54.709501Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dcb94662-1814-4127-8d7a-854b85f18dfb: Processing for user 2 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:35:54.709511Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dcb94662-1814-4127-8d7a-854b85f18dfb: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:54.709523Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dcb94662-1814-4127-8d7a-854b85f18dfb: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:54.709632Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:54.709692Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mc2a51201-9283-4bb3-8749-7a64fbbf4d35
[2m2025-10-08T22:35:54.709700Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2a51201-9283-4bb3-8749-7a64fbbf4d35: Processing for user 2 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:35:54.709707Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2a51201-9283-4bb3-8749-7a64fbbf4d35: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:54.709715Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2a51201-9283-4bb3-8749-7a64fbbf4d35: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:54.711273Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request dcb94662-1814-4127-8d7a-854b85f18dfb: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T22:35:54.711992Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c2a51201-9283-4bb3-8749-7a64fbbf4d35: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T22:35:54.715874Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:35:54.715922Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m40ff343b-b131-4bf2-82f1-7ef4eedd31a8
[2m2025-10-08T22:35:54.715929Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 40ff343b-b131-4bf2-82f1-7ef4eedd31a8: Processing for user 2 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:35:54.715936Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 40ff343b-b131-4bf2-82f1-7ef4eedd31a8: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:35:54.715942Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 40ff343b-b131-4bf2-82f1-7ef4eedd31a8: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:35:54.717577Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 40ff343b-b131-4bf2-82f1-7ef4eedd31a8: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T22:36:04.897930Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:04.897997Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 2: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200000637793-1-457490-0000102025100500000020150100311384147091&iAmb=1&digestValue=9W6oke2cprnPE9Gx6L6rzHHhu/mc+UTgnzB0x4plu30=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMDYzNzc5My0xLTQ1NzQ5MC0wMDAwMTAyMDI1MTAwNTAwMDAwMDIwMTUwMTAwMzExMzg0MTQ3MDkxIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjlXNm9rZTJjcHJuUEU5R3g2TDZyekhIaHUvbWMrVVRnbnpCMHg0cGx1MzA9In0.yNNvGRleV2ZAforwbcuI2QxdPyX0C5koeWQpjmF-RcI
[2m2025-10-08T22:36:04.898020Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200000637793-1-457490-0000102025100500000020150100311384147091&iAmb=1&digestValue=9W6oke2cprnPE9Gx6L6rzHHhu/mc+UTgnzB0x4plu30=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMDYzNzc5My0xLTQ1NzQ5MC0wMDAwMTAyMDI1MTAwNTAwMDAwMDIwMTUwMTAwMzExMzg0MTQ3MDkxIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjlXNm9rZTJjcHJuUEU5R3g2TDZyekhIaHUvbWMrVVRnbnpCMHg0cGx1MzA9In0.yNNvGRleV2ZAforwbcuI2QxdPyX0C5koeWQpjmF-RcI
[2m2025-10-08T22:36:04.898029Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200000637793-1-457490-0000102025100500000020150100311384147091&iAmb=1&digestValue=9W6oke2cprnPE9Gx6L6rzHHhu/mc+UTgnzB0x4plu30=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMDYzNzc5My0xLTQ1NzQ5MC0wMDAwMTAyMDI1MTAwNTAwMDAwMDIwMTUwMTAwMzExMzg0MTQ3MDkxIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjlXNm9rZTJjcHJuUEU5R3g2TDZyekhIaHUvbWMrVVRnbnpCMHg0cGx1MzA9In0.yNNvGRleV2ZAforwbcuI2QxdPyX0C5koeWQpjmF-RcI
[2m2025-10-08T22:36:05.295388Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (28469 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorQR?chFE=FE01200000637793-1-457490-0000102025100500000020150100311384147091&iAmb=1&digestValue=9W6oke2cprnPE9Gx6L6rzHHhu/mc+UTgnzB0x4plu30=&jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjaEZFIjoiRkUwMTIwMDAwMDYzNzc5My0xLTQ1NzQ5MC0wMDAwMTAyMDI1MTAwNTAwMDAwMDIwMTUwMTAwMzExMzg0MTQ3MDkxIiwiaUFtYiI6IjEiLCJkaWdlc3RWYWx1ZSI6IjlXNm9rZTJjcHJuUEU5R3g2TDZyekhIaHUvbWMrVVRnbnpCMHg0cGx1MzA9In0.yNNvGRleV2ZAforwbcuI2QxdPyX0C5koeWQpjmF-RcI
[2m2025-10-08T22:36:05.296236Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:36:05.297555Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:36:05.297598Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 11 potential detail rows
[2m2025-10-08T22:36:05.297626Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta D√©bito"), total_pagado=Some("7.60")
[2m2025-10-08T22:36:05.298901Z[0m [32m INFO[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Saving invoice header with CUFE: FE01200000637793-1-457490-0000102025100500000020150100311384147091
[2m2025-10-08T22:36:05.301784Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Usuario 2, sin redenci√≥n previa, buscando desde: 2025-09-15
[2m2025-10-08T22:36:05.302526Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Usuario 2, contando desde semana m√°s reciente con facturas: 2025-10-06
[2m2025-10-08T22:36:05.303171Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 0 (desde 2025-10-06 hasta 2025-10-12 00:00:00): facturas = t
[2m2025-10-08T22:36:05.303535Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 1 (desde 2025-09-29 hasta 2025-10-05 00:00:00): facturas = t
[2m2025-10-08T22:36:05.303625Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 2 (desde 2025-09-22 hasta 2025-09-28 00:00:00): facturas = t
[2m2025-10-08T22:36:05.303727Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Semana 3 (desde 2025-09-15 hasta 2025-09-21 00:00:00): facturas = t
[2m2025-10-08T22:36:05.303770Z[0m [32m INFO[0m [2msqlx::postgres::notice[0m[2m:[0m Resultado final para usuario 2: 4 semanas consecutivas (despu√©s de redenci√≥n: <NULL>)
[2m2025-10-08T22:36:05.360350Z[0m [32m INFO[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Saving 1 invoice details
[2m2025-10-08T22:36:05.361129Z[0m [32m INFO[0m [2mlum_rust_ws::api::database_persistence[0m[2m:[0m Saving 1 invoice payments
[2m2025-10-08T22:36:17.487475Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.487563Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mbfac2902-d221-4572-a652-018a23833bc0
[2m2025-10-08T22:36:17.487577Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bfac2902-d221-4572-a652-018a23833bc0: Processing headers for user 2 with limit 50 offset 50
[2m2025-10-08T22:36:17.487588Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bfac2902-d221-4572-a652-018a23833bc0: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.493646Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bfac2902-d221-4572-a652-018a23833bc0: Retrieved 0 invoice headers (total: 1) in 6ms with enhanced filtering
[2m2025-10-08T22:36:17.520346Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.520399Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0ma937cf7b-9d05-40fc-8a79-082cdba58867
[2m2025-10-08T22:36:17.520406Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a937cf7b-9d05-40fc-8a79-082cdba58867: Processing headers for user 2 with limit 50 offset 0
[2m2025-10-08T22:36:17.520414Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a937cf7b-9d05-40fc-8a79-082cdba58867: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.520427Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.520522Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m08a4bc09-a1b7-4beb-a4fb-d5ba8e36f69e
[2m2025-10-08T22:36:17.520535Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 08a4bc09-a1b7-4beb-a4fb-d5ba8e36f69e: Processing headers for user 2 with limit 50 offset 100
[2m2025-10-08T22:36:17.520552Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 08a4bc09-a1b7-4beb-a4fb-d5ba8e36f69e: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.526357Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 08a4bc09-a1b7-4beb-a4fb-d5ba8e36f69e: Retrieved 0 invoice headers (total: 1) in 5ms with enhanced filtering
[2m2025-10-08T22:36:17.527274Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request a937cf7b-9d05-40fc-8a79-082cdba58867: Retrieved 1 invoice headers (total: 1) in 6ms with enhanced filtering
[2m2025-10-08T22:36:17.778385Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.778479Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m296c7f74-0807-4b1e-8672-a3e8c2c7722a
[2m2025-10-08T22:36:17.778490Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 296c7f74-0807-4b1e-8672-a3e8c2c7722a: Processing headers for user 2 with limit 50 offset 150
[2m2025-10-08T22:36:17.778500Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 296c7f74-0807-4b1e-8672-a3e8c2c7722a: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.782933Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 296c7f74-0807-4b1e-8672-a3e8c2c7722a: Retrieved 0 invoice headers (total: 1) in 4ms with enhanced filtering
[2m2025-10-08T22:36:17.785002Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.785058Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0mc8945067-139e-4afe-b1b0-ff7655f0a111
[2m2025-10-08T22:36:17.785065Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c8945067-139e-4afe-b1b0-ff7655f0a111: Processing headers for user 2 with limit 50 offset 200
[2m2025-10-08T22:36:17.785078Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c8945067-139e-4afe-b1b0-ff7655f0a111: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.787820Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request c8945067-139e-4afe-b1b0-ff7655f0a111: Retrieved 0 invoice headers (total: 1) in 2ms with enhanced filtering
[2m2025-10-08T22:36:17.790902Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.790960Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m41ff076f-3070-40f6-8a37-ddc457c45df9
[2m2025-10-08T22:36:17.790971Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 41ff076f-3070-40f6-8a37-ddc457c45df9: Processing headers for user 2 with limit 50 offset 250
[2m2025-10-08T22:36:17.790982Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 41ff076f-3070-40f6-8a37-ddc457c45df9: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.793841Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 41ff076f-3070-40f6-8a37-ddc457c45df9: Retrieved 0 invoice headers (total: 1) in 2ms with enhanced filtering
[2m2025-10-08T22:36:17.912226Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.912304Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mfbd3a86a-4375-4d04-ab4e-97717b30d4fb
[2m2025-10-08T22:36:17.912312Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fbd3a86a-4375-4d04-ab4e-97717b30d4fb: Processing for user 2 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:36:17.912320Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fbd3a86a-4375-4d04-ab4e-97717b30d4fb: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:36:17.912329Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fbd3a86a-4375-4d04-ab4e-97717b30d4fb: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.913827Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request fbd3a86a-4375-4d04-ab4e-97717b30d4fb: Retrieved 1 invoice details (total: 1) in 1ms with enhanced pagination
[2m2025-10-08T22:36:17.925996Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.926047Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0me0e58596-2013-49c7-9aa2-129d2eaf9d18
[2m2025-10-08T22:36:17.926055Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0e58596-2013-49c7-9aa2-129d2eaf9d18: Processing for user 2 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:36:17.926062Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0e58596-2013-49c7-9aa2-129d2eaf9d18: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:36:17.926070Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0e58596-2013-49c7-9aa2-129d2eaf9d18: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.926327Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:17.926388Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m522fb5d7-e78a-4c27-87a9-044e19debe61
[2m2025-10-08T22:36:17.926396Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 522fb5d7-e78a-4c27-87a9-044e19debe61: Processing for user 2 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:36:17.926405Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 522fb5d7-e78a-4c27-87a9-044e19debe61: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:36:17.926413Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 522fb5d7-e78a-4c27-87a9-044e19debe61: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:17.929189Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 522fb5d7-e78a-4c27-87a9-044e19debe61: Retrieved 0 invoice details (total: 1) in 2ms with enhanced pagination
[2m2025-10-08T22:36:17.929564Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request e0e58596-2013-49c7-9aa2-129d2eaf9d18: Retrieved 0 invoice details (total: 1) in 3ms with enhanced pagination
[2m2025-10-08T22:36:18.216472Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:18.216547Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m30cd6a6a-485e-443d-a8d3-b3ef7adc16e5
[2m2025-10-08T22:36:18.216554Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30cd6a6a-485e-443d-a8d3-b3ef7adc16e5: Processing for user 2 with limit 100 offset 300 order_by date direction DESC
[2m2025-10-08T22:36:18.216562Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30cd6a6a-485e-443d-a8d3-b3ef7adc16e5: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:36:18.216570Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30cd6a6a-485e-443d-a8d3-b3ef7adc16e5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:18.218865Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 30cd6a6a-485e-443d-a8d3-b3ef7adc16e5: Retrieved 0 invoice details (total: 1) in 2ms with enhanced pagination
[2m2025-10-08T22:36:18.223428Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:18.223495Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m87948cf0-7e23-4961-ad3a-418768aa19cb
[2m2025-10-08T22:36:18.223502Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 87948cf0-7e23-4961-ad3a-418768aa19cb: Processing for user 2 with limit 100 offset 500 order_by date direction DESC
[2m2025-10-08T22:36:18.223508Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 87948cf0-7e23-4961-ad3a-418768aa19cb: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:36:18.223515Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 87948cf0-7e23-4961-ad3a-418768aa19cb: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:18.223451Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:18.223567Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mbd2629ac-5278-4b74-b964-6d097ae15e3c
[2m2025-10-08T22:36:18.223574Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd2629ac-5278-4b74-b964-6d097ae15e3c: Processing for user 2 with limit 100 offset 400 order_by date direction DESC
[2m2025-10-08T22:36:18.223580Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd2629ac-5278-4b74-b964-6d097ae15e3c: Querying details for user 2 with enhanced filters
[2m2025-10-08T22:36:18.223586Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd2629ac-5278-4b74-b964-6d097ae15e3c: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:36:18.225645Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request bd2629ac-5278-4b74-b964-6d097ae15e3c: Retrieved 0 invoice details (total: 1) in 2ms with enhanced pagination
[2m2025-10-08T22:36:18.226009Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 87948cf0-7e23-4961-ad3a-418768aa19cb: Retrieved 0 invoice details (total: 1) in 2ms with enhanced pagination
[2m2025-10-08T22:36:31.651396Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:36:31.651462Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 1: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:31.651470Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:31.651476Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:32.064014Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (36217 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:32.065046Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:36:32.066695Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:36:32.066733Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 15 potential detail rows
[2m2025-10-08T22:36:32.066763Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("37.45")
[2m2025-10-08T22:36:33.259454Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:36:33.265916Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 1: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:33.265957Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:33.265964Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:33.661021Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (36217 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:33.662020Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:36:33.663851Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:36:33.663887Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 15 potential detail rows
[2m2025-10-08T22:36:33.663915Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("37.45")
[2m2025-10-08T22:36:34.991943Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:36:34.992011Z[0m [32m INFO[0m [2mlum_rust_ws::api::url_processing_v4[0m[2m:[0m Processing URL request for user 1: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:34.992019Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Starting to scrape invoice from URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:34.992025Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Fetching HTML with final URL tracking from: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:35.384601Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Successfully fetched HTML content (36218 bytes) from final URL: https://dgi-fep.mef.gob.pa/Consultas/FacturasPorCUFE/FE0120000155706801-2-2021-0400002025100300033143200310114583313369
[2m2025-10-08T22:36:35.385640Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracting invoice header from document using ocr_extractor
[2m2025-10-08T22:36:35.387267Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Extracted data - RUC: None, Nombre: None, Total: None, ITBMS: None
[2m2025-10-08T22:36:35.387302Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Found 15 potential detail rows
[2m2025-10-08T22:36:35.387330Z[0m [32m INFO[0m [2mlum_rust_ws::api::webscraping[0m[2m:[0m Payment information extracted: forma_de_pago=Some("Tarjeta Cr√©dito"), total_pagado=Some("37.45")
[2m2025-10-08T22:36:35.507857Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:35.507946Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:35.507968Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 2
[2m2025-10-08T22:36:35.509023Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 2 - email: Some("andrescarriela@gmail.com")
[2m2025-10-08T22:36:40.440323Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:40.440385Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:40.440406Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 2
[2m2025-10-08T22:36:40.441748Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 2 - email: Some("andrescarriela@gmail.com")
[2m2025-10-08T22:36:50.446515Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.446576Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:36:50.447532Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 0ms: 92 L√ºmis
[2m2025-10-08T22:36:50.521730Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.521841Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.521898Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:36:50.527439Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 5ms for user_id: 2 - 20 items
[2m2025-10-08T22:36:50.552839Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.552872Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.552887Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:36:50.555987Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 3ms for user_id: 2 - 20 items
[2m2025-10-08T22:36:50.560707Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.560742Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.560755Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:36:50.563754Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 2ms for user_id: 2 - 20 items
[2m2025-10-08T22:36:50.706986Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:36:50.707062Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:36:50.707637Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 0ms: 92 L√ºmis
[2m2025-10-08T22:37:04.380916Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:04.380966Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:04.380984Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:37:04.383367Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 2ms for user_id: 2 - 20 items
[2m2025-10-08T22:37:04.406076Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:04.406108Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:04.406121Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:37:04.408021Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 1ms for user_id: 2 - 20 items
[2m2025-10-08T22:37:04.424080Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:04.424138Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:04.424185Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:37:04.426570Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 2ms for user_id: 2 - 20 items
[2m2025-10-08T22:37:04.439713Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:04.439755Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:37:04.440113Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 0ms: 92 L√ºmis
[2m2025-10-08T22:37:11.016691Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.016778Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:37:11.017458Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 0ms: 92 L√ºmis
[2m2025-10-08T22:37:11.029684Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.029716Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.029733Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:37:11.031619Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 1ms for user_id: 2 - 20 items
[2m2025-10-08T22:37:11.034707Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.034736Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.034748Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:37:11.037003Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 2ms for user_id: 2 - 20 items
[2m2025-10-08T22:37:11.075267Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.075313Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.075331Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:37:11.078122Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 2ms for user_id: 2 - 20 items
[2m2025-10-08T22:37:11.171938Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:11.172085Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:37:11.172987Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 0ms: 92 L√ºmis
[2m2025-10-08T22:37:16.837341Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:16.837420Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 2
[2m2025-10-08T22:37:16.838574Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 2 in 1ms: 92 L√ºmis
[2m2025-10-08T22:37:26.310500Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:26.310575Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:37:26.310602Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 2
[2m2025-10-08T22:37:26.314425Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 3ms for user_id: 2 - 20 items
[2m2025-10-08T22:38:55.865897Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:38:55.865963Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:38:55.865979Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 2
[2m2025-10-08T22:38:55.867016Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 1ms for user_id: 2 - email: Some("andrescarriela@gmail.com")
[2m2025-10-08T22:39:34.488808Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mGoogle [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:39:34.488857Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m9eb28e9a-e34c-4df0-a079-be8a3917fa57 [3mprovider[0m[2m=[0mGoogle { id_token: "eyJhbGciOiJSUzI1NiIsImtpZCI6ImM4YWI3MTUzMDk3MmJiYTIwYjQ5Zjc4YTA5Yzk4NTJjNDNmZjkxMTgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI5MTY0MjMxNTU1MS1tdmx2cXNqcWthcWpubmw5cXA2MW1haGNsdmVhZHRlMC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsImF1ZCI6IjkxNjQyMzE1NTUxLXZjcXRkYTFsY2ZvYWcwbWVqdWJsMTU3aXV2NHE4c3JpLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTAyOTQzOTEzMjU0Nzg5MzkxMjMzIiwiZW1haWwiOiJhbmRyZXNjYXJyaWVsYUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkFuZHJlcyBDYXJyaWVsIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0lxOTdFaGFyY19Ed21XUFVtbWlGSHoxVDB4OVFHWmZyejhKbjBGWlpHVzVfeWJySlp1TEE9czk2LWMiLCJnaXZlbl9uYW1lIjoiQW5kcmVzIiwiZmFtaWx5X25hbWUiOiJDYXJyaWVsIiwiaWF0IjoxNzU5OTYxMDA3LCJleHAiOjE3NTk5NjQ2MDd9.YoGEbcHYu4vi0CvwjiQUHph6qIVyYdIjdpx2YCdzCOiIMEyz0Ht88y-YeYBUkuKTbH1DGpU356iWhn77kf_onsK0ULyDMVG5Azd9w013XWBkM_QsZf-YQDNC3u5O0KMjTFLBLdp4ESwN9qpxP9Ft9nQ-Q9zSiJt_LZXSD3-PwNSLPqhr8M7nQpQj9MrS5OIu-AxEBl-ZZBBjs0lxOEFvpUUsnVMdvTazKgP5SFR7WR2Q4bBx9b-lQgrIer1D7Gv5tjsoDO7m2E2DZmQj4xfC7VwqyLDzQwEnApXSKq43UZhnFV1gHBYlIUORO35J1u7l2YMQx1dN9KV3ZIf4eQ-edA", access_token: None }
[2m2025-10-08T22:39:34.488870Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Google authentication
[2m2025-10-08T22:39:34.492596Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m9eb28e9a-e34c-4df0-a079-be8a3917fa57 [3mevent_type[0m[2m=[0mgoogle_auth [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:39:34.492626Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m üîç Starting Google ID token validation [3mrequest_id[0m[2m=[0mf873a319-6395-43db-be43-11d30d52b696
[2m2025-10-08T22:39:34.492959Z[0m [32m INFO[0m [2mlum_rust_ws::services::google_service[0m[2m:[0m ‚úÖ Google ID token validated successfully [3mrequest_id[0m[2m=[0mf873a319-6395-43db-be43-11d30d52b696 [3muser_id[0m[2m=[0m102943913254789391233 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mname[0m[2m=[0mSome("Andres Carriel") [3memail_verified[0m[2m=[0mtrue [3mexecution_time_ms[0m[2m=[0m0
[2m2025-10-08T22:39:34.496427Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:39:34.496415726 UTC
[2m2025-10-08T22:39:34.499244Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m9eb28e9a-e34c-4df0-a079-be8a3917fa57 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:39:34.499271Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m9eb28e9a-e34c-4df0-a079-be8a3917fa57 [3mexecution_time_ms[0m[2m=[0m10
[2m2025-10-08T22:39:55.131040Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:39:55.131096Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m16390dde-4e26-4612-94ef-f2dd87f94a94 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:39:55.131107Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:39:55.135630Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m16390dde-4e26-4612-94ef-f2dd87f94a94 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:39:55.408555Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:39:55.408531706 UTC
[2m2025-10-08T22:39:55.412885Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m16390dde-4e26-4612-94ef-f2dd87f94a94 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:39:55.412927Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m16390dde-4e26-4612-94ef-f2dd87f94a94 [3mexecution_time_ms[0m[2m=[0m281
[2m2025-10-08T22:39:59.364641Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:39:59.364697Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0mfb7a5bf7-050e-4164-b8e3-ded3550fe750 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:39:59.364709Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:39:59.369787Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mfb7a5bf7-050e-4164-b8e3-ded3550fe750 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:39:59.652699Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:39:59.652671562 UTC
[2m2025-10-08T22:39:59.655896Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0mfb7a5bf7-050e-4164-b8e3-ded3550fe750 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:39:59.655929Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0mfb7a5bf7-050e-4164-b8e3-ded3550fe750 [3mexecution_time_ms[0m[2m=[0m291
[2m2025-10-08T22:40:01.675623Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:40:01.675687Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0ma5148cf0-e8bc-4d56-8d65-e883841d51d4 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:40:01.675701Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:40:01.678627Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0ma5148cf0-e8bc-4d56-8d65-e883841d51d4 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:01.954081Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:40:01.954059014 UTC
[2m2025-10-08T22:40:01.958120Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0ma5148cf0-e8bc-4d56-8d65-e883841d51d4 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:01.958192Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0ma5148cf0-e8bc-4d56-8d65-e883841d51d4 [3mexecution_time_ms[0m[2m=[0m282
[2m2025-10-08T22:40:41.744430Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:40:41.744490Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m957af5f0-42bb-4838-84fa-4bb5b852f1b8 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:40:41.744504Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:40:41.747445Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m957af5f0-42bb-4838-84fa-4bb5b852f1b8 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:42.024624Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:40:42.024601955 UTC
[2m2025-10-08T22:40:42.028216Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m957af5f0-42bb-4838-84fa-4bb5b852f1b8 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:42.028266Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m957af5f0-42bb-4838-84fa-4bb5b852f1b8 [3mexecution_time_ms[0m[2m=[0m283
[2m2025-10-08T22:40:47.386759Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:40:47.386820Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0m8f5e9284-17ba-46b8-bd1e-b5aca4a25c56 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:40:47.386835Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:40:47.389535Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m8f5e9284-17ba-46b8-bd1e-b5aca4a25c56 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:47.664426Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:40:47.664401305 UTC
[2m2025-10-08T22:40:47.669161Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0m8f5e9284-17ba-46b8-bd1e-b5aca4a25c56 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:47.669202Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0m8f5e9284-17ba-46b8-bd1e-b5aca4a25c56 [3mexecution_time_ms[0m[2m=[0m282
[2m2025-10-08T22:40:55.727188Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:40:55.727258Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0ma7f2d21d-519b-4936-8e86-bf50cf4c7d97 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:40:55.727269Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:40:55.730198Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0ma7f2d21d-519b-4936-8e86-bf50cf4c7d97 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:56.004913Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:40:56.004889893 UTC
[2m2025-10-08T22:40:56.009126Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0ma7f2d21d-519b-4936-8e86-bf50cf4c7d97 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:40:56.009201Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0ma7f2d21d-519b-4936-8e86-bf50cf4c7d97 [3mexecution_time_ms[0m[2m=[0m281
[2m2025-10-08T22:41:03.280721Z[0m [32m INFO[0m [2mlum_rust_ws::api::unified_auth_v4[0m[2m:[0m üîê Unified authentication request received [3mprovider[0m[2m=[0mEmail [3mcreate_if_not_exists[0m[2m=[0mfalse [3mhas_linking_token[0m[2m=[0mfalse
[2m2025-10-08T22:41:03.280812Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üöÄ Starting unified authentication [3mrequest_id[0m[2m=[0madc0e18e-997a-4a82-b844-d78fc80fdde5 [3mprovider[0m[2m=[0mEmail { email: "andrescarriela@gmail.com", password: "Andres123+", name: None }
[2m2025-10-08T22:41:03.280826Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üîë Email authentication [3memail[0m[2m=[0mandrescarriela@gmail.com
[2m2025-10-08T22:41:03.284786Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0madc0e18e-997a-4a82-b844-d78fc80fdde5 [3mevent_type[0m[2m=[0mlogin_attempt [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:41:03.558902Z[0m [32m INFO[0m [2mlum_rust_ws::services::token_service[0m[2m:[0m üîë Generated access token successfully [3muser_id[0m[2m=[0m2 [3memail[0m[2m=[0mandrescarriela@gmail.com [3mexpires_at[0m[2m=[0m2025-10-09 22:41:03.558876120 UTC
[2m2025-10-08T22:41:03.561967Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m üìù Auth event logged to database [3mrequest_id[0m[2m=[0madc0e18e-997a-4a82-b844-d78fc80fdde5 [3mevent_type[0m[2m=[0mlogin_success [3msuccess[0m[2m=[0mtrue
[2m2025-10-08T22:41:03.562003Z[0m [32m INFO[0m [2mlum_rust_ws::services::unified_auth_simple[0m[2m:[0m ‚úÖ Authentication successful [3mrequest_id[0m[2m=[0madc0e18e-997a-4a82-b844-d78fc80fdde5 [3mexecution_time_ms[0m[2m=[0m281
[2m2025-10-08T22:45:04.721738Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:05.047444Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:05.059794Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:05.074419Z[0m [31mERROR[0m [2mlum_rust_ws::api::gamification_v4[0m[2m:[0m Failed to track action: Database(PgDatabaseError { severity: Error, code: "23514", message: "no partition of relation \"fact_user_activity_log\" found for row", detail: Some("Partition key of the failing row contains (created_at) = (2025-10-08 22:45:05.073501+00)."), hint: None, position: None, where: Some("SQL statement \"INSERT INTO gamification.fact_user_activity_log (\n        user_id, activity_type, activity_data, created_at\n    ) VALUES (\n        p_user_id, p_action_type, \n        jsonb_build_object(\n            'channel', p_channel,\n            'metadata', p_metadata,\n            'timestamp', NOW()\n        ),\n        NOW()\n    )\"\nPL/pgSQL function gamification.track_user_action(integer,character varying,character varying,jsonb) line 13 at SQL statement"), schema: Some("gamification"), table: Some("fact_user_activity_log"), column: None, data_type: None, constraint: None, file: Some("execPartition.c"), line: Some(328), routine: Some("ExecFindPartition") })
[2m2025-10-08T22:45:05.074513Z[0m [31mERROR[0m [2mtower_http::trace::on_failure[0m[2m:[0m response failed [3mclassification[0m[2m=[0mStatus code: 500 Internal Server Error [3mlatency[0m[2m=[0m14 ms
[2m2025-10-08T22:45:06.913139Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.571531Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.571588Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.571622Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-08T22:45:12.574760Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 3ms for user_id: 1 - 20 items
[2m2025-10-08T22:45:12.586860Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.586905Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T22:45:12.587758Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 296 L√ºmis
[2m2025-10-08T22:45:12.596244Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.596400Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.596371Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.596670Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:12.596469Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-08T22:45:12.596975Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Fetching rewards history for user_id: 1
[2m2025-10-08T22:45:12.600952Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 4ms for user_id: 1 - 20 items
[2m2025-10-08T22:45:12.601567Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_history_v4[0m[2m:[0m Rewards history retrieved in 4ms for user_id: 1 - 20 items
[2m2025-10-08T22:45:46.650629Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:46.650705Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:46.650726Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m Fetching user data for user_id: 1
[2m2025-10-08T22:45:46.651610Z[0m [32m INFO[0m [2mlum_rust_ws::api::userdata_v4[0m[2m:[0m User data retrieved in 0ms for user_id: 1 - email: Some("andresfelipevalenciag@gmail.com")
[2m2025-10-08T22:45:47.844921Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:47.844978Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m Getting user balance for user_id: 1
[2m2025-10-08T22:45:47.845980Z[0m [32m INFO[0m [2mlum_rust_ws::api::rewards_v4[0m[2m:[0m User balance retrieved successfully for user 1 in 0ms: 296 L√ºmis
[2m2025-10-08T22:45:48.412625Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:48.413045Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m1e47130f-b8a4-4b3a-ad39-f9ec1e1b26c8
[2m2025-10-08T22:45:48.413089Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1e47130f-b8a4-4b3a-ad39-f9ec1e1b26c8: Processing headers for user 1 with limit 50 offset 0
[2m2025-10-08T22:45:48.413101Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1e47130f-b8a4-4b3a-ad39-f9ec1e1b26c8: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:45:48.414839Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1e47130f-b8a4-4b3a-ad39-f9ec1e1b26c8: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-08T22:45:48.686394Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:48.686475Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0md044681a-41c4-490d-aab6-53a07d1c0736
[2m2025-10-08T22:45:48.686483Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d044681a-41c4-490d-aab6-53a07d1c0736: Processing headers for user 1 with limit 50 offset 50
[2m2025-10-08T22:45:48.686493Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d044681a-41c4-490d-aab6-53a07d1c0736: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:45:48.688615Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request d044681a-41c4-490d-aab6-53a07d1c0736: Retrieved 0 invoice headers (total: 0) in 2ms with enhanced filtering
[2m2025-10-08T22:45:48.706899Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:48.706999Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice headers with enhanced filtering [3mrequest_id[0m[2m=[0m9ca2eb61-2323-473f-bab5-4dc4aa1493d0
[2m2025-10-08T22:45:48.707011Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9ca2eb61-2323-473f-bab5-4dc4aa1493d0: Processing headers for user 1 with limit 50 offset 100
[2m2025-10-08T22:45:48.707027Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9ca2eb61-2323-473f-bab5-4dc4aa1493d0: Executing header query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY h.reception_date DESC) as id,
            h.no,
            h.date,
            h.tot_itbms,
            h.cufe,
            h.issuer_name,
            h.tot_amount,
            h.url,
            h.process_date,
            h.reception_date,
            h.type,
            '' as time,
            '' as auth_date,
            h.issuer_ruc,
            h.issuer_dv,
            h.issuer_address,
            h.issuer_phone,
            '' as receptor_name,
            COALESCE(detail_counts.details_count, 0) as details_count,
            COALESCE(payment_counts.payments_count, 0) as payments_count
        FROM public.invoice_header h
        LEFT JOIN (
            SELECT cufe, COUNT(*) as details_count
            FROM public.invoice_detail
            GROUP BY cufe
        ) detail_counts ON h.cufe = detail_counts.cufe
        LEFT JOIN (
            SELECT cufe, COUNT(*) as payments_count
            FROM public.invoice_payment
            GROUP BY cufe
        ) payment_counts ON h.cufe = payment_counts.cufe
        WHERE h.user_id = $1
     AND h.reception_date >= $2 ORDER BY h.reception_date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:45:48.708424Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 9ca2eb61-2323-473f-bab5-4dc4aa1493d0: Retrieved 0 invoice headers (total: 0) in 1ms with enhanced filtering
[2m2025-10-08T22:45:48.942292Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:48.942368Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb1d7ac77-d2a9-40da-8216-22043d76c76f
[2m2025-10-08T22:45:48.942379Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b1d7ac77-d2a9-40da-8216-22043d76c76f: Processing for user 1 with limit 100 offset 100 order_by date direction DESC
[2m2025-10-08T22:45:48.942386Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b1d7ac77-d2a9-40da-8216-22043d76c76f: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:45:48.942404Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b1d7ac77-d2a9-40da-8216-22043d76c76f: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:45:48.944091Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b1d7ac77-d2a9-40da-8216-22043d76c76f: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T22:45:48.947142Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:48.947197Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0mb8c4006a-2b66-4d24-aba7-b32c976249f5
[2m2025-10-08T22:45:48.947205Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b8c4006a-2b66-4d24-aba7-b32c976249f5: Processing for user 1 with limit 100 offset 0 order_by date direction DESC
[2m2025-10-08T22:45:48.947211Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b8c4006a-2b66-4d24-aba7-b32c976249f5: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:45:48.947217Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b8c4006a-2b66-4d24-aba7-b32c976249f5: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:45:48.949399Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request b8c4006a-2b66-4d24-aba7-b32c976249f5: Retrieved 0 invoice details (total: 0) in 2ms with enhanced pagination
[2m2025-10-08T22:45:48.954628Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:45:48.954672Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request: Getting invoice details with enhanced pagination [3mrequest_id[0m[2m=[0m1c606515-6403-4159-9d5b-1d980511273a
[2m2025-10-08T22:45:48.954679Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1c606515-6403-4159-9d5b-1d980511273a: Processing for user 1 with limit 100 offset 200 order_by date direction DESC
[2m2025-10-08T22:45:48.954685Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1c606515-6403-4159-9d5b-1d980511273a: Querying details for user 1 with enhanced filters
[2m2025-10-08T22:45:48.954692Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1c606515-6403-4159-9d5b-1d980511273a: Executing optimized query: 
        SELECT 
            ROW_NUMBER() OVER (ORDER BY d.date DESC) as id,
            d.cufe, d.quantity, d.code, d.description, d.unit_price, d.amount,
            d.unit_discount, d.date, d.total, d.issuer_name, d.reception_date
        FROM public.invoice_with_details d
        WHERE d.user_id = $1
     AND d.reception_date >= $2 ORDER BY d.date DESC LIMIT $3 OFFSET $4
[2m2025-10-08T22:45:48.955851Z[0m [32m INFO[0m [2mlum_rust_ws::api::invoice_query_v4[0m[2m:[0m Request 1c606515-6403-4159-9d5b-1d980511273a: Retrieved 0 invoice details (total: 0) in 1ms with enhanced pagination
[2m2025-10-08T22:50:40.317999Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:50:40.560215Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:50:40.572553Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T22:50:40.576792Z[0m [31mERROR[0m [2mlum_rust_ws::api::gamification_v4[0m[2m:[0m Failed to track action: Database(PgDatabaseError { severity: Error, code: "23514", message: "no partition of relation \"fact_user_activity_log\" found for row", detail: Some("Partition key of the failing row contains (created_at) = (2025-10-08 22:50:40.576377+00)."), hint: None, position: None, where: Some("SQL statement \"INSERT INTO gamification.fact_user_activity_log (\n        user_id, activity_type, activity_data, created_at\n    ) VALUES (\n        p_user_id, p_action_type, \n        jsonb_build_object(\n            'channel', p_channel,\n            'metadata', p_metadata,\n            'timestamp', NOW()\n        ),\n        NOW()\n    )\"\nPL/pgSQL function gamification.track_user_action(integer,character varying,character varying,jsonb) line 13 at SQL statement"), schema: Some("gamification"), table: Some("fact_user_activity_log"), column: None, data_type: None, constraint: None, file: Some("execPartition.c"), line: Some(328), routine: Some("ExecFindPartition") })
[2m2025-10-08T22:50:40.576858Z[0m [31mERROR[0m [2mtower_http::trace::on_failure[0m[2m:[0m response failed [3mclassification[0m[2m=[0mStatus code: 500 Internal Server Error [3mlatency[0m[2m=[0m4 ms
[2m2025-10-08T22:50:43.426370Z[0m [32m INFO[0m [2mlum_rust_ws::middleware::auth[0m[2m:[0m üîê JWT authentication successful [3muser_id[0m[2m=[0m1 [3memail[0m[2m=[0mandresfelipevalenciag@gmail.com
[2m2025-10-08T23:02:02.517737Z[0m [32m INFO[0m [2mlum_rust_ws[0m[2m:[0m signal received, starting graceful shutdown
