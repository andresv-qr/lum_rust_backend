# =============================================================================
# CONFIGURACIÓN OPTIMIZADA DE VARIABLES DE ENTORNO - LÜMIS RUST SERVER
# =============================================================================
# Este archivo contiene todas las configuraciones optimizadas para máximo
# rendimiento, uso eficiente de memoria y seguridad robusta.
# =============================================================================

# -----------------------------------------------------------------------------
# WHATSAPP API CONFIGURATION
# -----------------------------------------------------------------------------
# Token de verificación para el webhook de WhatsApp
VERIFY_TOKEN="tu_token_secreto_aqui"

# Token de acceso de WhatsApp Business API
WHATSAPP_TOKEN="tu_whatsapp_token_aqui"

# ID del número de teléfono de WhatsApp Business
PHONE_NUMBER_ID="tu_phone_number_id_aqui"

# URL base de la API de WhatsApp
WHATSAPP_API_BASE_URL="https://graph.facebook.com/v18.0"

# -----------------------------------------------------------------------------
# DATABASE OPTIMIZATION SETTINGS
# -----------------------------------------------------------------------------
# URL de conexión a PostgreSQL
DATABASE_URL="postgresql://usuario:password@localhost:5432/lumis_db"

# Pool de conexiones optimizado para alta concurrencia
DATABASE_MAX_CONNECTIONS=20
DATABASE_MIN_CONNECTIONS=5
DATABASE_ACQUIRE_TIMEOUT_SECONDS=30
DATABASE_IDLE_TIMEOUT_SECONDS=600
DATABASE_MAX_LIFETIME_SECONDS=1800

# Cache de statements SQL para mejor performance
DATABASE_STATEMENT_CACHE_CAPACITY=100

# -----------------------------------------------------------------------------
# REDIS CONFIGURATION
# -----------------------------------------------------------------------------
# URL de conexión a Redis para cache y rate limiting
REDIS_URL="redis://localhost:6379"

# -----------------------------------------------------------------------------
# PERFORMANCE & MEMORY OPTIMIZATION
# -----------------------------------------------------------------------------
# Configuración de hilos de trabajo de Tokio
TOKIO_WORKER_THREADS=8

# Configuración de hilos de Rayon para tareas CPU-intensivas
RAYON_NUM_THREADS=4

# Límites de memoria para procesamiento de imágenes
MAX_IMAGE_SIZE_MB=10
MAX_PDF_SIZE_MB=25

# Tipos MIME permitidos para uploads
ALLOWED_MIME_TYPES="image/jpeg,image/png,application/pdf"

# -----------------------------------------------------------------------------
# CACHE CONFIGURATION
# -----------------------------------------------------------------------------
# TTL para diferentes tipos de cache (en segundos)
USER_CACHE_TTL_SECONDS=300
RATE_LIMIT_CACHE_TTL_SECONDS=60

# -----------------------------------------------------------------------------
# QR PROCESSING OPTIMIZATION
# -----------------------------------------------------------------------------
# Habilitar decodificadores QR paralelos
QR_PARALLEL_DECODING=true
QR_MAX_RETRIES=3
QR_TIMEOUT_SECONDS=30

# -----------------------------------------------------------------------------
# ONNX MODEL CONFIGURATION
# -----------------------------------------------------------------------------
# Pool de sesiones ONNX para mejor performance
ONNX_SESSION_POOL_SIZE=4

# Modelos disponibles en orden de prioridad
ONNX_MODEL_PRIORITY="small,large"

# Ruta a los modelos ONNX
ONNX_MODEL_PATH="/home/client_1099_1/scripts/qreader_server/models"

# -----------------------------------------------------------------------------
# SECURITY SETTINGS
# -----------------------------------------------------------------------------
# Rate limiting por usuario
MAX_REQUESTS_PER_MINUTE=60

# JWT Configuration
JWT_SECRET="tu_jwt_secret_super_seguro_aqui_min_32_chars"
JWT_ACCESS_TOKEN_TTL_SECONDS=900

# CORS Configuration
CORS_ALLOWED_ORIGINS="https://yourdomain.com,https://admin.yourdomain.com"

# -----------------------------------------------------------------------------
# OCR SERVICE CONFIGURATION
# -----------------------------------------------------------------------------
# Configuración de trust score y límites dinámicos
OCR_TRUST_SCORE_ENABLED=true
OCR_BASE_COST_LUMIS=0
OCR_MAX_COST_LUMIS=15

# -----------------------------------------------------------------------------
# LOGGING & MONITORING
# -----------------------------------------------------------------------------
# Nivel de logging (trace, debug, info, warn, error)
RUST_LOG="info,lum_rust_ws=debug"

# Puerto del servidor
SERVER_PORT=8000

# Entorno de ejecución (development, staging, production)
ENVIRONMENT="development"

# =============================================================================
# NOTAS IMPORTANTES:
# =============================================================================
# 1. Copia este archivo como .env y personaliza los valores
# 2. DATABASE_MAX_CONNECTIONS debe ajustarse según tu hardware
# 3. TOKIO_WORKER_THREADS = número de CPUs disponibles
# 4. En producción, usa JWT_SECRET de al menos 64 caracteres
# 5. Los valores de cache TTL pueden ajustarse según patrones de uso
# 6. ONNX_MODEL_PATH debe apuntar a la ubicación real de los modelos
# =============================================================================
