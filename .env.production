# ====================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION - LUM RUST WS
# ====================================================================
# ⚠️ IMPORTANTE: Este archivo es SOLO para deployment a api.lumapp.org
# ⚠️ Para desarrollo local, sigue usando el archivo .env (sin .production)
# ⚠️ NO SUBIR A GIT - Ya está en .gitignore
# ====================================================================
#
# CUÁNDO USAR ESTE ARCHIVO:
# - Solo cuando ejecutes ./deploy_production.sh
# - Se copia como .env en el servidor de producción
# - NO afecta tu desarrollo local actual
#
# TU DESARROLLO LOCAL:
# - Sigue usando: nohup cargo run --bin lum_rust_ws &
# - Sigue usando: archivo .env (sin .production)
# - Este archivo .env.production es ignorado en desarrollo
# ====================================================================

# --------------------------------------------------------------------
# DATABASE CONFIGURATION
# --------------------------------------------------------------------
# ⚠️ DEBE ser la MISMA base de datos que tu .env actual
DATABASE_URL=postgres://avalencia:Jacobo23@dbmain.lumapp.org:5432/tfactu?sslmode=require

# Connection pool settings (mismo que .env actual)
DATABASE_MAX_CONNECTIONS=20
DATABASE_MIN_CONNECTIONS=5
DATABASE_ACQUIRE_TIMEOUT_SECONDS=30
DATABASE_IDLE_TIMEOUT_SECONDS=600
DATABASE_MAX_LIFETIME_SECONDS=1800

# --------------------------------------------------------------------
# JWT CONFIGURATION
# --------------------------------------------------------------------
# ⚠️ CRÍTICO: Debe ser el MISMO secret usado por el API de login
# Si cambias este valor, todos los tokens existentes quedarán inválidos
# Este es el MISMO valor que usas en .env actual
JWT_SECRET="lumis_jwt_secret_super_seguro_production_2024_rust_server_key"
JWT_ACCESS_TOKEN_TTL_SECONDS=900
JWT_REFRESH_TOKEN_TTL_SECONDS=3888000

# --------------------------------------------------------------------
# FIREBASE CLOUD MESSAGING (Push Notifications)
# --------------------------------------------------------------------
# ⚠️ OPCIONAL: Solo necesario si quieres habilitar push notifications
# Si no lo configuras, el sistema funciona pero sin notificaciones push
# Obtener de: Firebase Console > Project Settings > Cloud Messaging > Server Key
#
# FCM_SERVER_KEY=AAAA...tu_key_de_firebase_cloud_messaging_aqui
#
# Descomenta la línea de arriba cuando tengas la key de Firebase

# --------------------------------------------------------------------
# REDIS CONFIGURATION (Rate Limiting & Caching)
# --------------------------------------------------------------------
# Mismo valor que tu .env actual
REDIS_URL=redis://127.0.0.1/
# Si Redis requiere password:
# REDIS_URL=redis://:password@localhost:6379
# Si Redis está en otro servidor:
# REDIS_URL=redis://redis.lumapp.org:6379

# --------------------------------------------------------------------
# SERVER CONFIGURATION
# --------------------------------------------------------------------
# Puerto (mismo que tu .env actual)
PORT=8000
SERVER_PORT=8000
BIND_ADDRESS=0.0.0.0
# 0.0.0.0 escucha en todas las interfaces (recomendado para producción detrás de proxy)
# 127.0.0.1 solo local (si usas proxy reverso en el mismo servidor)

# --------------------------------------------------------------------
# LOGGING & MONITORING
# --------------------------------------------------------------------
# Mismo que tu .env actual
RUST_LOG=info,lum_rust_ws=debug,sqlx=warn
ENVIRONMENT=production
# Niveles: trace, debug, info, warn, error
# Producción recomendado: info
# Debug temporal: debug

# --------------------------------------------------------------------
# RATE LIMITING
# --------------------------------------------------------------------
RATE_LIMIT_REDEMPTIONS_PER_DAY=10
RATE_LIMIT_OFFERS_PER_MINUTE=100

# --------------------------------------------------------------------
# QR CODE GENERATION
# --------------------------------------------------------------------
QR_BASE_URL=https://lumapp.org/redeem
QR_CDN_URL=https://cdn.lumapp.org/qr
# URLs públicas para acceso a QR codes generados

# --------------------------------------------------------------------
# WEBHOOKS (Opcional - actualmente deshabilitado)
# --------------------------------------------------------------------
WEBHOOK_ENABLED=false
WEBHOOK_URL=https://hooks.lumapp.org/redemptions
WEBHOOK_SECRET=your_webhook_secret_here

# --------------------------------------------------------------------
# SCHEDULED JOBS
# --------------------------------------------------------------------
EXPIRATION_CHECK_CRON=0 */1 * * * *
# Formato cron: cada hora marca redenciones expiradas
# "0 */1 * * * *" = cada hora en punto

EXPIRATION_WARNING_MINUTES=5
# Enviar notificación 5 minutos antes de expirar

# --------------------------------------------------------------------
# CORS (Cross-Origin Resource Sharing)
# --------------------------------------------------------------------
CORS_ALLOWED_ORIGINS=https://lumapp.org,https://www.lumapp.org,https://admin.lumapp.org
# Lista separada por comas de orígenes permitidos
# Para desarrollo local agregar: http://localhost:3000

# --------------------------------------------------------------------
# TLS/SSL (Si el servidor maneja SSL directamente)
# --------------------------------------------------------------------
# TLS_CERT_PATH=/etc/ssl/certs/lumapp.org.crt
# TLS_KEY_PATH=/etc/ssl/private/lumapp.org.key
# ⚠️ En producción normal, el proxy reverso (Nginx) maneja SSL

# --------------------------------------------------------------------
# ENVIRONMENT
# --------------------------------------------------------------------
RUST_ENV=production
APP_NAME=lum_rust_ws
APP_VERSION=3.0
